var __decorate=this&&this.__decorate||function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},__param=this&&this.__param||function(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}};import{windowOpenNoOpener}from"../../../base/browser/dom.js";import{Schemas}from"../../../base/common/network.js";import{AbstractCodeEditorService}from"../../browser/services/abstractCodeEditorService.js";import{ICodeEditorService}from"../../browser/services/codeEditorService.js";import{IContextKeyService}from"../../../platform/contextkey/common/contextkey.js";import{registerSingleton}from"../../../platform/instantiation/common/extensions.js";import{IThemeService}from"../../../platform/theme/common/themeService.js";let StandaloneCodeEditorService=class StandaloneCodeEditorService extends AbstractCodeEditorService{constructor(contextKeyService,themeService){super(themeService),this.onCodeEditorAdd((()=>this._checkContextKey())),this.onCodeEditorRemove((()=>this._checkContextKey())),this._editorIsOpen=contextKeyService.createKey("editorIsOpen",!1),this._activeCodeEditor=null}_checkContextKey(){let hasCodeEditor=!1;for(const editor of this.listCodeEditors())if(!editor.isSimpleWidget){hasCodeEditor=!0;break}this._editorIsOpen.set(hasCodeEditor)}setActiveCodeEditor(activeCodeEditor){this._activeCodeEditor=activeCodeEditor}getActiveCodeEditor(){return this._activeCodeEditor}openCodeEditor(input,source,sideBySide){return source?Promise.resolve(this.doOpenEditor(source,input)):Promise.resolve(null)}doOpenEditor(editor,input){if(!this.findModel(editor,input.resource)){if(input.resource){const schema=input.resource.scheme;if(schema===Schemas.http||schema===Schemas.https)return windowOpenNoOpener(input.resource.toString()),editor}return null}const selection=input.options?input.options.selection:null;if(selection)if("number"==typeof selection.endLineNumber&&"number"==typeof selection.endColumn)editor.setSelection(selection),editor.revealRangeInCenter(selection,1);else{const pos={lineNumber:selection.startLineNumber,column:selection.startColumn};editor.setPosition(pos),editor.revealPositionInCenter(pos,1)}return editor}findModel(editor,resource){const model=editor.getModel();return model&&model.uri.toString()!==resource.toString()?null:model}};StandaloneCodeEditorService=__decorate([__param(0,IContextKeyService),__param(1,IThemeService)],StandaloneCodeEditorService);export{StandaloneCodeEditorService};registerSingleton(ICodeEditorService,StandaloneCodeEditorService);