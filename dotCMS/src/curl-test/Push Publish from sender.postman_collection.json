{
	"info": {
		"_postman_id": "48dfecd1-2d23-43d3-8405-cecde42533a3",
		"name": "Push Publish from sender",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Push Publish Old Way",
			"item": [
				{
					"name": "Happy path",
					"item": [
						{
							"name": "set USE_JWT_TOKEN_IN_PUSH_PUBLISH to false",
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "PUT",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"USE_JWT_TOKEN_IN_PUSH_PUBLISH\": false\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{serverURL}}/api//v1/configuration",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"api",
										"",
										"v1",
										"configuration"
									]
								}
							},
							"response": []
						},
						{
							"name": "create environment",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "81f5348b-c745-4511-958e-bfc0f7d57efb",
										"exec": [
											"",
											"",
											"environmentName = 'environment-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"environmentName\", environmentName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "31fc87bf-5a66-489f-9081-c67607a46ca4",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"    var environmentId = pm.response.text();",
											"    pm.collectionVariables.set(\"environmentId\", environmentId);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"value": "{{origin}}",
										"type": "text"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.environment.ajax.EnvironmentAjaxAction/cmd/addEnvironment?environmentName={{environmentName}}&pushType=pushToOne&whoCanUseSelect=e7d4e34e-5127-45fc-8123-d48b62d510e3&whoCanUse=e7d4e34e-5127-45fc-8123-d48b62d510e3",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.environment.ajax.EnvironmentAjaxAction",
										"cmd",
										"addEnvironment"
									],
									"query": [
										{
											"key": "environmentName",
											"value": "{{environmentName}}"
										},
										{
											"key": "pushType",
											"value": "pushToOne"
										},
										{
											"key": "whoCanUseSelect",
											"value": "e7d4e34e-5127-45fc-8123-d48b62d510e3"
										},
										{
											"key": "whoCanUse",
											"value": "e7d4e34e-5127-45fc-8123-d48b62d510e3"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "create end point",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "6c89d4c8-4352-49b5-b7bd-1419136b6299",
										"exec": [
											"endpointName = 'endpoint-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"endpointName\", endpointName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "3ef4c02c-a6a5-4429-962b-b1394366cd1f",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction/cmd/addEndpoint?sending=false&serverName={{endpointName}}&environmentId={{environmentId}}&protocol=http&address=localhost&port=8080&authKey=123&enabled=on",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction",
										"cmd",
										"addEndpoint"
									],
									"query": [
										{
											"key": "sending",
											"value": "false"
										},
										{
											"key": "serverName",
											"value": "{{endpointName}}"
										},
										{
											"key": "environmentId",
											"value": "{{environmentId}}"
										},
										{
											"key": "protocol",
											"value": "http"
										},
										{
											"key": "address",
											"value": "localhost"
										},
										{
											"key": "port",
											"value": "8080"
										},
										{
											"key": "authKey",
											"value": "123"
										},
										{
											"key": "enabled",
											"value": "on"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "create receiver",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "7d7dbe18-bdcd-4a65-b8a6-1c016a59fae5",
										"exec": [
											"receiverName = 'receiverName-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"receiverName\", receiverName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "14872dab-03f1-4fba-b6af-e11a88ad12a6",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction/cmd/addEndpoint?sending=true&serverName={{receiverName}}&environmentId={{environmentId}}&address=localhost&authKey=123&enabled=on",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction",
										"cmd",
										"addEndpoint"
									],
									"query": [
										{
											"key": "sending",
											"value": "true"
										},
										{
											"key": "serverName",
											"value": "{{receiverName}}"
										},
										{
											"key": "environmentId",
											"value": "{{environmentId}}"
										},
										{
											"key": "address",
											"value": "localhost"
										},
										{
											"key": "authKey",
											"value": "123"
										},
										{
											"key": "enabled",
											"value": "on"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "create content type and content",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "ddae4260-9729-472d-896a-d92bfd0cbabe",
										"exec": [
											"pm.test(\"Bundle uploaded sucessfully\", function () {",
											"    pm.response.to.have.status(200);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										},
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/octet-stream"
									},
									{
										"key": "Content-Disposition",
										"type": "text",
										"value": "attachment"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": [
										{
											"key": "file",
											"contentType": "application/tar+gzip ",
											"type": "file",
											"src": "/build/src/core/dotCMS/src/curl-test/resources/Push_publish/content_type_and_content_demo.tar.gz"
										}
									],
									"options": {
										"formdata": {}
									}
								},
								"url": {
									"raw": "{{serverURL}}/api/bundle/sync",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"api",
										"bundle",
										"sync"
									]
								},
								"description": "Imports a Bundle that includes:\n*  A piece of content of type \"Rich text\" with \"test Content\" as title and body"
							},
							"response": []
						},
						{
							"name": "Add bundle",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "937b4d6a-e093-432a-8f2d-103c2a54cbfa",
										"exec": [
											"bundleName = 'bundleName-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"bundleName\", bundleName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "1542185e-c40a-4c33-96b0-c949be69d3b6",
										"exec": [
											"pm.test(\"Bundle uploaded sucessfully\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"    var jsonData = pm.response.json();",
											"    pm.collectionVariables.set(\"bundleId\", jsonData[\"bundleId\"]);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.ajax.RemotePublishAjaxAction/cmd/addToBundle?assetIdentifier=ecc9df87-02ad-4f58-afaf-f27ae4fb2c57&bundleName={{bundleName}}",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.ajax.RemotePublishAjaxAction",
										"cmd",
										"addToBundle"
									],
									"query": [
										{
											"key": "assetIdentifier",
											"value": "ecc9df87-02ad-4f58-afaf-f27ae4fb2c57"
										},
										{
											"key": "bundleName",
											"value": "{{bundleName}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Push publish",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "4cb29e27-05bc-4f6d-94e4-75540c34e551",
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "411fe5f6-18aa-4f3c-888a-2d58e966f3cf",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.ajax.RemotePublishAjaxAction/cmd/pushBundle?assetIdentifier={{bundleId}}&iWantTo=publish&whoToSend={{environmentId}}&remotePublishDate=2020-09-10&remotePublishTime=17-14",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.ajax.RemotePublishAjaxAction",
										"cmd",
										"pushBundle"
									],
									"query": [
										{
											"key": "assetIdentifier",
											"value": "{{bundleId}}"
										},
										{
											"key": "iWantTo",
											"value": "publish"
										},
										{
											"key": "whoToSend",
											"value": "{{environmentId}}"
										},
										{
											"key": "remotePublishDate",
											"value": "2020-09-10"
										},
										{
											"key": "remotePublishTime",
											"value": "17-14"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "check success status",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "ffbc72e2-1c63-44d3-865d-7a1d6179d066",
										"exec": [
											"",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "582a43af-6af5-4e0a-9c01-baf666b14195",
										"exec": [
											"pm.test(\"Bundle uploaded sucessfully\", function () {",
											"",
											"    checkBundleStatus = eval(pm.collectionVariables.get(\"checkBundleStatus\", checkBundleStatus.toString()));",
											"",
											"    pm.response.to.have.status(200);",
											"",
											"    checkBundleStatus(pm.response.text(), [\"bundleSuccess\", \"endpointSuccess\"], \"check success status\");",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/html/portlet/ext/contentlet/publishing/view_publish_audit_detail.jsp?bundle={{bundleId}}",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"html",
										"portlet",
										"ext",
										"contentlet",
										"publishing",
										"view_publish_audit_detail.jsp"
									],
									"query": [
										{
											"key": "bundle",
											"value": "{{bundleId}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "set USE_JWT_TOKEN_IN_PUSH_PUBLISH to true",
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "PUT",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"USE_JWT_TOKEN_IN_PUSH_PUBLISH\": true\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{serverURL}}/api//v1/configuration",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"api",
										"",
										"v1",
										"configuration"
									]
								}
							},
							"response": []
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				},
				{
					"name": "Invalid token",
					"item": [
						{
							"name": "set USE_JWT_TOKEN_IN_PUSH_PUBLISH to false",
							"request": {
								"method": "PUT",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"USE_JWT_TOKEN_IN_PUSH_PUBLISH\": false\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{serverURL}}/api//v1/configuration",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"api",
										"",
										"v1",
										"configuration"
									]
								}
							},
							"response": []
						},
						{
							"name": "create environment",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "2d51e33e-aef7-45cd-8675-b21ecc85400d",
										"exec": [
											"",
											"environmentName = 'environment-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"environmentName\", environmentName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "1afafe74-232d-40be-b66f-b59700749fb6",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"    var environmentId = pm.response.text();",
											"    pm.collectionVariables.set(\"environmentId\", environmentId);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"value": "{{origin}}",
										"type": "text"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.environment.ajax.EnvironmentAjaxAction/cmd/addEnvironment?environmentName={{environmentName}}&pushType=pushToOne&whoCanUseSelect=e7d4e34e-5127-45fc-8123-d48b62d510e3&whoCanUse=e7d4e34e-5127-45fc-8123-d48b62d510e3",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.environment.ajax.EnvironmentAjaxAction",
										"cmd",
										"addEnvironment"
									],
									"query": [
										{
											"key": "environmentName",
											"value": "{{environmentName}}"
										},
										{
											"key": "pushType",
											"value": "pushToOne"
										},
										{
											"key": "whoCanUseSelect",
											"value": "e7d4e34e-5127-45fc-8123-d48b62d510e3"
										},
										{
											"key": "whoCanUse",
											"value": "e7d4e34e-5127-45fc-8123-d48b62d510e3"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "create end point",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "99ac5834-863c-416d-b828-1d0aea57df64",
										"exec": [
											"endpointName = 'endpoint-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"endpointName\", endpointName);",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction/cmd/addEndpoint?sending=false&serverName={{endpointName}}&environmentId={{environmentId}}&protocol=http&address=localhost&port=8080&authKey=123&enabled=on",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction",
										"cmd",
										"addEndpoint"
									],
									"query": [
										{
											"key": "sending",
											"value": "false"
										},
										{
											"key": "serverName",
											"value": "{{endpointName}}"
										},
										{
											"key": "environmentId",
											"value": "{{environmentId}}"
										},
										{
											"key": "protocol",
											"value": "http"
										},
										{
											"key": "address",
											"value": "localhost"
										},
										{
											"key": "port",
											"value": "8080"
										},
										{
											"key": "authKey",
											"value": "123"
										},
										{
											"key": "enabled",
											"value": "on"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "create receiver",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "fec1f46b-61bc-465f-9b9b-3939da5b0460",
										"exec": [
											"receiverName = 'receiverName-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"receiverName\", receiverName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "32034d9d-33f7-4238-b989-c0e74185ea88",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction/cmd/addEndpoint?sending=true&serverName={{receiverName}}&environmentId={{environmentId}}&address=localhost&authKey=not_valid_auth_key&enabled=on",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction",
										"cmd",
										"addEndpoint"
									],
									"query": [
										{
											"key": "sending",
											"value": "true"
										},
										{
											"key": "serverName",
											"value": "{{receiverName}}"
										},
										{
											"key": "environmentId",
											"value": "{{environmentId}}"
										},
										{
											"key": "address",
											"value": "localhost"
										},
										{
											"key": "authKey",
											"value": "not_valid_auth_key"
										},
										{
											"key": "enabled",
											"value": "on"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "create content type and content",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "c25b0c77-f902-4e96-ac71-c79e1fd3e6b9",
										"exec": [
											"pm.test(\"Bundle uploaded sucessfully\", function () {",
											"    pm.response.to.have.status(200);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										},
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/octet-stream"
									},
									{
										"key": "Content-Disposition",
										"type": "text",
										"value": "attachment"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": [
										{
											"key": "file",
											"contentType": "application/tar+gzip ",
											"type": "file",
											"src": "/build/src/core/dotCMS/src/curl-test/resources/Push_publish/content_type_and_content_demo.tar.gz"
										}
									],
									"options": {
										"formdata": {}
									}
								},
								"url": {
									"raw": "{{serverURL}}/api/bundle/sync",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"api",
										"bundle",
										"sync"
									]
								},
								"description": "Imports a Bundle that includes:\n*  A piece of content of type \"Rich text\" with \"test Content\" as title and body"
							},
							"response": []
						},
						{
							"name": "Add bundle",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "2715aa6b-74ec-4a1b-a499-b47b76514a6e",
										"exec": [
											"bundleName = 'bundleName-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"bundleName\", bundleName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "6e7324ab-1348-4825-9101-6ae2e21c0797",
										"exec": [
											"pm.test(\"Bundle uploaded sucessfully\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"    var jsonData = pm.response.json();",
											"    pm.collectionVariables.set(\"bundleId\", jsonData[\"bundleId\"]);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.ajax.RemotePublishAjaxAction/cmd/addToBundle?assetIdentifier=ecc9df87-02ad-4f58-afaf-f27ae4fb2c57&bundleName={{bundleName}}",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.ajax.RemotePublishAjaxAction",
										"cmd",
										"addToBundle"
									],
									"query": [
										{
											"key": "assetIdentifier",
											"value": "ecc9df87-02ad-4f58-afaf-f27ae4fb2c57"
										},
										{
											"key": "bundleName",
											"value": "{{bundleName}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Push publish",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "8cec5a82-e600-443f-b2e6-9198a3933006",
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "c277d078-743d-45e6-b336-f332a9155106",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.ajax.RemotePublishAjaxAction/cmd/pushBundle?assetIdentifier={{bundleId}}&iWantTo=publish&whoToSend={{environmentId}}&remotePublishDate=2020-09-10&remotePublishTime=17-14",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.ajax.RemotePublishAjaxAction",
										"cmd",
										"pushBundle"
									],
									"query": [
										{
											"key": "assetIdentifier",
											"value": "{{bundleId}}"
										},
										{
											"key": "iWantTo",
											"value": "publish"
										},
										{
											"key": "whoToSend",
											"value": "{{environmentId}}"
										},
										{
											"key": "remotePublishDate",
											"value": "2020-09-10"
										},
										{
											"key": "remotePublishTime",
											"value": "17-14"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "check failed status",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "37544584-b4d9-4451-8785-7a96a3e7a3af",
										"exec": [
											"",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "1accef98-60a5-4fcc-a1fa-142f87474cff",
										"exec": [
											"pm.test(\"Bundle uploaded sucessfully\", function () {",
											"",
											"    checkBundleStatus = eval(pm.collectionVariables.get(\"checkBundleStatus\", checkBundleStatus.toString()));",
											"",
											"    pm.response.to.have.status(200);",
											"",
											"    checkBundleStatus(pm.response.text(), [\"bundleFailed\", \"endpointInvalidtoken\"], \"check failed status\");",
											"});",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/html/portlet/ext/contentlet/publishing/view_publish_audit_detail.jsp?bundle={{bundleId}}",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"html",
										"portlet",
										"ext",
										"contentlet",
										"publishing",
										"view_publish_audit_detail.jsp"
									],
									"query": [
										{
											"key": "bundle",
											"value": "{{bundleId}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "set USE_JWT_TOKEN_IN_PUSH_PUBLISH to true",
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "PUT",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"USE_JWT_TOKEN_IN_PUSH_PUBLISH\": true\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{serverURL}}/api//v1/configuration",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"api",
										"",
										"v1",
										"configuration"
									]
								}
							},
							"response": []
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				}
			],
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"id": "4b4de1e9-83a9-4ba8-8e23-763c3805cccd",
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"id": "8f42bb96-d15c-4abe-9844-dcbfffdc8817",
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				}
			],
			"protocolProfileBehavior": {}
		},
		{
			"name": "Push Publish JWT token",
			"item": [
				{
					"name": "Happy path",
					"item": [
						{
							"name": "request_token",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "b3524a25-db72-4acf-bd0b-5f08cad462c6",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"    var jsonData = pm.response.json();",
											"    pm.expect(jsonData.errors.length).to.eql(0);",
											"    pm.expect(jsonData.entity).to.not.eq(undefined);",
											"    pm.expect(jsonData.entity.jwt).to.not.eq(undefined);",
											"    pm.collectionVariables.set(\"token\", jsonData.entity.jwt);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"claims\": {\n        \"label\": \"testing\"\n    },\n    \"expirationSeconds\": 94571365,\n    \"network\": \"0.0.0.0/0\",\n    \"userId\": \"dotcms.org.1\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{serverURL}}/api/v1/apitoken",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"api",
										"v1",
										"apitoken"
									]
								}
							},
							"response": []
						},
						{
							"name": "create environment",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "2789ed42-1027-4b31-8a9d-33ac3d4251b8",
										"exec": [
											"",
											"environmentName = 'environment-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"environmentName\", environmentName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "ea91e5df-36fd-41be-b21a-95f25b3bf0ed",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"    var environmentId = pm.response.text();",
											"    pm.collectionVariables.set(\"environmentId\", environmentId);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"value": "{{origin}}",
										"type": "text"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.environment.ajax.EnvironmentAjaxAction/cmd/addEnvironment?environmentName={{environmentName}}&pushType=pushToOne&whoCanUseSelect=e7d4e34e-5127-45fc-8123-d48b62d510e3&whoCanUse=e7d4e34e-5127-45fc-8123-d48b62d510e3",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.environment.ajax.EnvironmentAjaxAction",
										"cmd",
										"addEnvironment"
									],
									"query": [
										{
											"key": "environmentName",
											"value": "{{environmentName}}"
										},
										{
											"key": "pushType",
											"value": "pushToOne"
										},
										{
											"key": "whoCanUseSelect",
											"value": "e7d4e34e-5127-45fc-8123-d48b62d510e3"
										},
										{
											"key": "whoCanUse",
											"value": "e7d4e34e-5127-45fc-8123-d48b62d510e3"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "create end point",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "011b3d1c-6546-4224-9a24-f2e3c980222c",
										"exec": [
											"endpointName = 'endpoint-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"endpointName\", endpointName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "d56c1a00-d017-4d28-94bf-071621df4b8b",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction/cmd/addEndpoint?sending=false&serverName={{endpointName}}&environmentId={{environmentId}}&protocol=http&address=localhost&port=8080&authKey={{token}}&enabled=on",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction",
										"cmd",
										"addEndpoint"
									],
									"query": [
										{
											"key": "sending",
											"value": "false"
										},
										{
											"key": "serverName",
											"value": "{{endpointName}}"
										},
										{
											"key": "environmentId",
											"value": "{{environmentId}}"
										},
										{
											"key": "protocol",
											"value": "http"
										},
										{
											"key": "address",
											"value": "localhost"
										},
										{
											"key": "port",
											"value": "8080"
										},
										{
											"key": "authKey",
											"value": "{{token}}"
										},
										{
											"key": "enabled",
											"value": "on"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "create content type and content",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "0d6f7e85-d0b6-4905-99ef-2828916f18a1",
										"exec": [
											"pm.test(\"Bundle uploaded sucessfully\", function () {",
											"    pm.response.to.have.status(200);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										},
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/octet-stream"
									},
									{
										"key": "Content-Disposition",
										"type": "text",
										"value": "attachment"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": [
										{
											"key": "file",
											"contentType": "application/tar+gzip ",
											"type": "file",
											"src": "/build/src/core/dotCMS/src/curl-test/resources/Push_publish/content_type_and_content_demo.tar.gz"
										}
									],
									"options": {
										"formdata": {}
									}
								},
								"url": {
									"raw": "{{serverURL}}/api/bundle/sync",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"api",
										"bundle",
										"sync"
									]
								},
								"description": "Imports a Bundle that includes:\n*  A piece of content of type \"Rich text\" with \"test Content\" as title and body"
							},
							"response": []
						},
						{
							"name": "Add bundle",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "7c6a7afd-0a3c-4675-ae7e-0d7447f43457",
										"exec": [
											"bundleName = 'bundleName-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"bundleName\", bundleName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "056fd168-da43-4de9-a51d-cd687b77fb52",
										"exec": [
											"pm.test(\"Bundle uploaded sucessfully\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"    var jsonData = pm.response.json();",
											"    pm.collectionVariables.set(\"bundleId\", jsonData[\"bundleId\"]);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.ajax.RemotePublishAjaxAction/cmd/addToBundle?assetIdentifier=cc8d9edc-f01e-405d-b2c0-020869391bdb&bundleName={{bundleName}}",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.ajax.RemotePublishAjaxAction",
										"cmd",
										"addToBundle"
									],
									"query": [
										{
											"key": "assetIdentifier",
											"value": "cc8d9edc-f01e-405d-b2c0-020869391bdb"
										},
										{
											"key": "bundleName",
											"value": "{{bundleName}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Push publish",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "49c013be-ed71-4594-9a06-7aeacfb07c02",
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.ajax.RemotePublishAjaxAction/cmd/pushBundle?assetIdentifier={{bundleId}}&iWantTo=publish&whoToSend={{environmentId}}&remotePublishDate=2020-09-10&remotePublishTime=17-14",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.ajax.RemotePublishAjaxAction",
										"cmd",
										"pushBundle"
									],
									"query": [
										{
											"key": "assetIdentifier",
											"value": "{{bundleId}}"
										},
										{
											"key": "iWantTo",
											"value": "publish"
										},
										{
											"key": "whoToSend",
											"value": "{{environmentId}}"
										},
										{
											"key": "remotePublishDate",
											"value": "2020-09-10"
										},
										{
											"key": "remotePublishTime",
											"value": "17-14"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "check success status",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "97c51b9f-967b-47d4-9576-4bb18828e980",
										"exec": [
											"",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "777641a3-65f8-4ba0-956e-1932863a125e",
										"exec": [
											"",
											"pm.test(\"Bundle uploaded sucessfully\", function () {",
											"",
											"    checkBundleStatus = eval(pm.collectionVariables.get(\"checkBundleStatus\", checkBundleStatus.toString()));",
											"",
											"    pm.response.to.have.status(200);",
											"",
											"    checkBundleStatus(pm.response.text(), [\"bundleSuccess\", \"endpointSuccess\"], \"check success status\");",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/html/portlet/ext/contentlet/publishing/view_publish_audit_detail.jsp?bundle={{bundleId}}",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"html",
										"portlet",
										"ext",
										"contentlet",
										"publishing",
										"view_publish_audit_detail.jsp"
									],
									"query": [
										{
											"key": "bundle",
											"value": "{{bundleId}}"
										}
									]
								}
							},
							"response": []
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				},
				{
					"name": "Expired token",
					"item": [
						{
							"name": "request_token",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "1f1d2a30-01a8-4864-ad84-4bc37ada38ae",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"    var jsonData = pm.response.json();",
											"    pm.expect(jsonData.errors.length).to.eql(0);",
											"    pm.expect(jsonData.entity).to.not.eq(undefined);",
											"    pm.expect(jsonData.entity.jwt).to.not.eq(undefined);",
											"    pm.collectionVariables.set(\"token\", jsonData.entity.jwt);",
											"",
											"    eval(pm.collectionVariables.get(\"wait\"))(2000); //wait 2 seconds",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"claims\": {\n        \"label\": \"testing\"\n    },\n    \"expirationSeconds\": 1,\n    \"network\": \"0.0.0.0/0\",\n    \"userId\": \"dotcms.org.1\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{serverURL}}/api/v1/apitoken",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"api",
										"v1",
										"apitoken"
									]
								}
							},
							"response": []
						},
						{
							"name": "create environment",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "2a0d52a2-e46f-4e0c-a998-0e076d93b564",
										"exec": [
											"",
											"environmentName = 'environment-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"environmentName\", environmentName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "5024f93f-8ae5-4eca-9977-6318ea1d0056",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"    var environmentId = pm.response.text();",
											"    pm.collectionVariables.set(\"environmentId\", environmentId);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"value": "{{origin}}",
										"type": "text"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.environment.ajax.EnvironmentAjaxAction/cmd/addEnvironment?environmentName={{environmentName}}&pushType=pushToOne&whoCanUseSelect=e7d4e34e-5127-45fc-8123-d48b62d510e3&whoCanUse=e7d4e34e-5127-45fc-8123-d48b62d510e3",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.environment.ajax.EnvironmentAjaxAction",
										"cmd",
										"addEnvironment"
									],
									"query": [
										{
											"key": "environmentName",
											"value": "{{environmentName}}"
										},
										{
											"key": "pushType",
											"value": "pushToOne"
										},
										{
											"key": "whoCanUseSelect",
											"value": "e7d4e34e-5127-45fc-8123-d48b62d510e3"
										},
										{
											"key": "whoCanUse",
											"value": "e7d4e34e-5127-45fc-8123-d48b62d510e3"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "create end point",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "1b1bd3fe-113d-4577-b941-b3494f6bc09e",
										"exec": [
											"endpointName = 'endpoint-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"endpointName\", endpointName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "e8610249-c024-4877-ab4b-23df767c666f",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction/cmd/addEndpoint?sending=false&serverName={{endpointName}}&environmentId={{environmentId}}&protocol=http&address=localhost&port=8080&authKey={{token}}&enabled=on",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction",
										"cmd",
										"addEndpoint"
									],
									"query": [
										{
											"key": "sending",
											"value": "false"
										},
										{
											"key": "serverName",
											"value": "{{endpointName}}"
										},
										{
											"key": "environmentId",
											"value": "{{environmentId}}"
										},
										{
											"key": "protocol",
											"value": "http"
										},
										{
											"key": "address",
											"value": "localhost"
										},
										{
											"key": "port",
											"value": "8080"
										},
										{
											"key": "authKey",
											"value": "{{token}}"
										},
										{
											"key": "enabled",
											"value": "on"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "create content type and content",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "d97e4714-0ad0-4df4-ae8d-26021aff71b5",
										"exec": [
											"pm.test(\"Bundle uploaded sucessfully\", function () {",
											"    pm.response.to.have.status(200);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										},
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/octet-stream"
									},
									{
										"key": "Content-Disposition",
										"type": "text",
										"value": "attachment"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": [
										{
											"key": "file",
											"contentType": "application/tar+gzip ",
											"type": "file",
											"src": "/build/src/core/dotCMS/src/curl-test/resources/Push_publish/content_type_and_content_demo.tar.gz"
										}
									],
									"options": {
										"formdata": {}
									}
								},
								"url": {
									"raw": "{{serverURL}}/api/bundle/sync",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"api",
										"bundle",
										"sync"
									]
								},
								"description": "Imports a Bundle that includes:\n*  A piece of content of type \"Rich text\" with \"test Content\" as title and body"
							},
							"response": []
						},
						{
							"name": "Add bundle",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "3873c439-487d-4522-a3b6-e45e06567b13",
										"exec": [
											"bundleName = 'bundleName-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"bundleName\", bundleName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "74f96602-cac1-44c1-93fd-8b6ef37b2776",
										"exec": [
											"pm.test(\"Bundle uploaded sucessfully\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"    var jsonData = pm.response.json();",
											"    pm.collectionVariables.set(\"bundleId\", jsonData[\"bundleId\"]);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.ajax.RemotePublishAjaxAction/cmd/addToBundle?assetIdentifier=cc8d9edc-f01e-405d-b2c0-020869391bdb&bundleName={{bundleName}}",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.ajax.RemotePublishAjaxAction",
										"cmd",
										"addToBundle"
									],
									"query": [
										{
											"key": "assetIdentifier",
											"value": "cc8d9edc-f01e-405d-b2c0-020869391bdb"
										},
										{
											"key": "bundleName",
											"value": "{{bundleName}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Push publish",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "51b13424-1550-4ab7-b4d0-6011c0dc6126",
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.ajax.RemotePublishAjaxAction/cmd/pushBundle?assetIdentifier={{bundleId}}&iWantTo=publish&whoToSend={{environmentId}}&remotePublishDate=2020-09-10&remotePublishTime=17-14",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.ajax.RemotePublishAjaxAction",
										"cmd",
										"pushBundle"
									],
									"query": [
										{
											"key": "assetIdentifier",
											"value": "{{bundleId}}"
										},
										{
											"key": "iWantTo",
											"value": "publish"
										},
										{
											"key": "whoToSend",
											"value": "{{environmentId}}"
										},
										{
											"key": "remotePublishDate",
											"value": "2020-09-10"
										},
										{
											"key": "remotePublishTime",
											"value": "17-14"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "check failed status",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "47828983-fa72-4a17-a777-b03e9d47439b",
										"exec": [
											"",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "f4317a47-be8e-4d22-a608-987f9d3ff7a0",
										"exec": [
											"pm.test(\"Bundle uploaded sucessfully\", function () {",
											"",
											"    checkBundleStatus = eval(pm.collectionVariables.get(\"checkBundleStatus\", checkBundleStatus.toString()));",
											"",
											"    pm.response.to.have.status(200);",
											"",
											"    checkBundleStatus(pm.response.text(), [\"bundleFailed\", \"endpointInvalidtoken\"], \"check failed status\");",
											"});",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/html/portlet/ext/contentlet/publishing/view_publish_audit_detail.jsp?bundle={{bundleId}}",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"html",
										"portlet",
										"ext",
										"contentlet",
										"publishing",
										"view_publish_audit_detail.jsp"
									],
									"query": [
										{
											"key": "bundle",
											"value": "{{bundleId}}"
										}
									]
								}
							},
							"response": []
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				},
				{
					"name": "Invalid token",
					"item": [
						{
							"name": "create environment",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "c9c611c1-05df-4243-887e-21264d46f7b5",
										"exec": [
											"",
											"environmentName = 'environment-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"environmentName\", environmentName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "7f869548-ecaa-4e53-874d-985a790da0c2",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"    var environmentId = pm.response.text();",
											"    pm.collectionVariables.set(\"environmentId\", environmentId);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"value": "{{origin}}",
										"type": "text"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.environment.ajax.EnvironmentAjaxAction/cmd/addEnvironment?environmentName={{environmentName}}&pushType=pushToOne&whoCanUseSelect=e7d4e34e-5127-45fc-8123-d48b62d510e3&whoCanUse=e7d4e34e-5127-45fc-8123-d48b62d510e3",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.environment.ajax.EnvironmentAjaxAction",
										"cmd",
										"addEnvironment"
									],
									"query": [
										{
											"key": "environmentName",
											"value": "{{environmentName}}"
										},
										{
											"key": "pushType",
											"value": "pushToOne"
										},
										{
											"key": "whoCanUseSelect",
											"value": "e7d4e34e-5127-45fc-8123-d48b62d510e3"
										},
										{
											"key": "whoCanUse",
											"value": "e7d4e34e-5127-45fc-8123-d48b62d510e3"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "create end point",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "149c3983-c06c-406d-be94-ff4417bfb7fe",
										"exec": [
											"endpointName = 'endpoint-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"endpointName\", endpointName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "08aa0987-b684-438e-b453-ca90750e8761",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction/cmd/addEndpoint?sending=false&serverName={{endpointName}}&environmentId={{environmentId}}&protocol=http&address=localhost&port=8080&authKey=invalid_token&enabled=on",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction",
										"cmd",
										"addEndpoint"
									],
									"query": [
										{
											"key": "sending",
											"value": "false"
										},
										{
											"key": "serverName",
											"value": "{{endpointName}}"
										},
										{
											"key": "environmentId",
											"value": "{{environmentId}}"
										},
										{
											"key": "protocol",
											"value": "http"
										},
										{
											"key": "address",
											"value": "localhost"
										},
										{
											"key": "port",
											"value": "8080"
										},
										{
											"key": "authKey",
											"value": "invalid_token"
										},
										{
											"key": "enabled",
											"value": "on"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "create content type and content",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "b44f61c3-a4d7-4574-96e8-39ff8e46e4d6",
										"exec": [
											"pm.test(\"Bundle uploaded sucessfully\", function () {",
											"    pm.response.to.have.status(200);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										},
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/octet-stream"
									},
									{
										"key": "Content-Disposition",
										"type": "text",
										"value": "attachment"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": [
										{
											"key": "file",
											"contentType": "application/tar+gzip ",
											"type": "file",
											"src": "/build/src/core/dotCMS/src/curl-test/resources/Push_publish/content_type_and_content_demo.tar.gz"
										}
									],
									"options": {
										"formdata": {}
									}
								},
								"url": {
									"raw": "{{serverURL}}/api/bundle/sync",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"api",
										"bundle",
										"sync"
									]
								},
								"description": "Imports a Bundle that includes:\n*  A piece of content of type \"Rich text\" with \"test Content\" as title and body"
							},
							"response": []
						},
						{
							"name": "Add bundle",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "cd3833d8-4eeb-4d69-8a51-11d63449841f",
										"exec": [
											"bundleName = 'bundleName-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"bundleName\", bundleName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "7cee621c-7e60-4bfb-9898-d897f9ad14e0",
										"exec": [
											"pm.test(\"Bundle uploaded sucessfully\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"    var jsonData = pm.response.json();",
											"    pm.collectionVariables.set(\"bundleId\", jsonData[\"bundleId\"]);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.ajax.RemotePublishAjaxAction/cmd/addToBundle?assetIdentifier=cc8d9edc-f01e-405d-b2c0-020869391bdb&bundleName={{bundleName}}",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.ajax.RemotePublishAjaxAction",
										"cmd",
										"addToBundle"
									],
									"query": [
										{
											"key": "assetIdentifier",
											"value": "cc8d9edc-f01e-405d-b2c0-020869391bdb"
										},
										{
											"key": "bundleName",
											"value": "{{bundleName}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Push publish",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "814aed3b-c54d-46c3-a783-026e76317fa2",
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.ajax.RemotePublishAjaxAction/cmd/pushBundle?assetIdentifier={{bundleId}}&iWantTo=publish&whoToSend={{environmentId}}&remotePublishDate=2020-09-10&remotePublishTime=17-14",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.ajax.RemotePublishAjaxAction",
										"cmd",
										"pushBundle"
									],
									"query": [
										{
											"key": "assetIdentifier",
											"value": "{{bundleId}}"
										},
										{
											"key": "iWantTo",
											"value": "publish"
										},
										{
											"key": "whoToSend",
											"value": "{{environmentId}}"
										},
										{
											"key": "remotePublishDate",
											"value": "2020-09-10"
										},
										{
											"key": "remotePublishTime",
											"value": "17-14"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "check failed status",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "4125a0de-0951-46bc-a3cc-27889b84254b",
										"exec": [
											"",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "8950c732-c73a-4585-87f2-361904ed3f4b",
										"exec": [
											"pm.test(\"Bundle uploaded sucessfully\", function () {",
											"",
											"    checkBundleStatus = eval(pm.collectionVariables.get(\"checkBundleStatus\", checkBundleStatus.toString()));",
											"",
											"    pm.response.to.have.status(200);",
											"",
											"    checkBundleStatus(pm.response.text(), [\"bundleFailed\", \"endpointInvalidtoken\"], \"check failed status\");",
											"});",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/html/portlet/ext/contentlet/publishing/view_publish_audit_detail.jsp?bundle={{bundleId}}",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"html",
										"portlet",
										"ext",
										"contentlet",
										"publishing",
										"view_publish_audit_detail.jsp"
									],
									"query": [
										{
											"key": "bundle",
											"value": "{{bundleId}}"
										}
									]
								}
							},
							"response": []
						}
					],
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "0c5d81fa-cb1f-48be-a9ec-30359edf25a2",
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "0eb8cdaa-2b4c-4ae1-abbd-8271859a6abf",
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				},
				{
					"name": "When JWT fail should use old way",
					"item": [
						{
							"name": "create environment",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "55eb7aa9-b417-4a89-b505-ac86116941db",
										"exec": [
											"",
											"environmentName = 'environment-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"environmentName\", environmentName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "97c04d4b-4996-424f-bcf6-152865435e78",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"    var environmentId = pm.response.text();",
											"    pm.collectionVariables.set(\"environmentId\", environmentId);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"value": "{{origin}}",
										"type": "text"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.environment.ajax.EnvironmentAjaxAction/cmd/addEnvironment?environmentName={{environmentName}}&pushType=pushToOne&whoCanUseSelect=e7d4e34e-5127-45fc-8123-d48b62d510e3&whoCanUse=e7d4e34e-5127-45fc-8123-d48b62d510e3",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.environment.ajax.EnvironmentAjaxAction",
										"cmd",
										"addEnvironment"
									],
									"query": [
										{
											"key": "environmentName",
											"value": "{{environmentName}}"
										},
										{
											"key": "pushType",
											"value": "pushToOne"
										},
										{
											"key": "whoCanUseSelect",
											"value": "e7d4e34e-5127-45fc-8123-d48b62d510e3"
										},
										{
											"key": "whoCanUse",
											"value": "e7d4e34e-5127-45fc-8123-d48b62d510e3"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "create end point",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "3b10952a-6a71-452b-b0ab-4ab3cdc7d2c9",
										"exec": [
											"endpointName = 'endpoint-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"endpointName\", endpointName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "5d1a3245-7263-42f4-a08f-c9e68816fe7d",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction/cmd/addEndpoint?sending=false&serverName={{endpointName}}&environmentId={{environmentId}}&protocol=http&address=localhost&port=8080&authKey=123&enabled=on",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction",
										"cmd",
										"addEndpoint"
									],
									"query": [
										{
											"key": "sending",
											"value": "false"
										},
										{
											"key": "serverName",
											"value": "{{endpointName}}"
										},
										{
											"key": "environmentId",
											"value": "{{environmentId}}"
										},
										{
											"key": "protocol",
											"value": "http"
										},
										{
											"key": "address",
											"value": "localhost"
										},
										{
											"key": "port",
											"value": "8080"
										},
										{
											"key": "authKey",
											"value": "123"
										},
										{
											"key": "enabled",
											"value": "on"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "create receiver",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "9dc19d5b-4f77-45f4-af7c-a708ed964025",
										"exec": [
											"receiverName = 'receiverName-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"receiverName\", receiverName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "6665ad9e-7629-420b-8447-4426245823e2",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction/cmd/addEndpoint?sending=true&serverName={{receiverName}}&environmentId={{environmentId}}&address=localhost&authKey=123&enabled=on",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction",
										"cmd",
										"addEndpoint"
									],
									"query": [
										{
											"key": "sending",
											"value": "true"
										},
										{
											"key": "serverName",
											"value": "{{receiverName}}"
										},
										{
											"key": "environmentId",
											"value": "{{environmentId}}"
										},
										{
											"key": "address",
											"value": "localhost"
										},
										{
											"key": "authKey",
											"value": "123"
										},
										{
											"key": "enabled",
											"value": "on"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "create content type and content",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "1cca69b0-d454-4d37-a05b-668ebd5d4bf7",
										"exec": [
											"pm.test(\"Bundle uploaded sucessfully\", function () {",
											"    pm.response.to.have.status(200);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										},
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/octet-stream"
									},
									{
										"key": "Content-Disposition",
										"type": "text",
										"value": "attachment"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": [
										{
											"key": "file",
											"contentType": "application/tar+gzip ",
											"type": "file",
											"src": "/Users/freddyrodriguez/DOTCMS/core/dotCMS/src/curl-test/resources/Push_publish/content_type_and_content_demo.tar.gz"
										}
									],
									"options": {
										"formdata": {}
									}
								},
								"url": {
									"raw": "{{serverURL}}/api/bundle/sync",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"api",
										"bundle",
										"sync"
									]
								},
								"description": "Imports a Bundle that includes:\n*  A piece of content of type \"Rich text\" with \"test Content\" as title and body"
							},
							"response": []
						},
						{
							"name": "Add bundle",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "5ad524e2-14cd-4fb4-a847-f00cd078b613",
										"exec": [
											"bundleName = 'bundleName-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"bundleName\", bundleName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "cd297c80-b6e5-40ee-b989-b1cd972e366e",
										"exec": [
											"pm.test(\"Bundle uploaded sucessfully\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"    var jsonData = pm.response.json();",
											"    pm.collectionVariables.set(\"bundleId\", jsonData[\"bundleId\"]);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.ajax.RemotePublishAjaxAction/cmd/addToBundle?assetIdentifier=ecc9df87-02ad-4f58-afaf-f27ae4fb2c57&bundleName={{bundleName}}",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.ajax.RemotePublishAjaxAction",
										"cmd",
										"addToBundle"
									],
									"query": [
										{
											"key": "assetIdentifier",
											"value": "ecc9df87-02ad-4f58-afaf-f27ae4fb2c57"
										},
										{
											"key": "bundleName",
											"value": "{{bundleName}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Push publish",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "7fd149e9-8cda-46ff-bdee-53f71ad43ba0",
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "691809d6-2663-42bf-bc8d-b6377fbe244a",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.ajax.RemotePublishAjaxAction/cmd/pushBundle?assetIdentifier={{bundleId}}&iWantTo=publish&whoToSend={{environmentId}}&remotePublishDate=2020-09-10&remotePublishTime=17-14",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.ajax.RemotePublishAjaxAction",
										"cmd",
										"pushBundle"
									],
									"query": [
										{
											"key": "assetIdentifier",
											"value": "{{bundleId}}"
										},
										{
											"key": "iWantTo",
											"value": "publish"
										},
										{
											"key": "whoToSend",
											"value": "{{environmentId}}"
										},
										{
											"key": "remotePublishDate",
											"value": "2020-09-10"
										},
										{
											"key": "remotePublishTime",
											"value": "17-14"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "check success status",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "0668d10e-884d-448f-899f-d007f0a00752",
										"exec": [
											"",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "ea98f131-2c55-4d12-bdef-af4f152f33dc",
										"exec": [
											"pm.test(\"Bundle uploaded sucessfully\", function () {",
											"",
											"    checkBundleStatus = eval(pm.collectionVariables.get(\"checkBundleStatus\", checkBundleStatus.toString()));",
											"",
											"    pm.response.to.have.status(200);",
											"",
											"    checkBundleStatus(pm.response.text(), [\"endpointSuccess\"], \"check success status\");",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/html/portlet/ext/contentlet/publishing/view_publish_audit_detail.jsp?bundle={{bundleId}}",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"html",
										"portlet",
										"ext",
										"contentlet",
										"publishing",
										"view_publish_audit_detail.jsp"
									],
									"query": [
										{
											"key": "bundle",
											"value": "{{bundleId}}"
										}
									]
								}
							},
							"response": []
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				}
			],
			"protocolProfileBehavior": {}
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"id": "9bcd6703-f5da-4071-8710-f64240ad13b0",
				"type": "text/javascript",
				"exec": [
					"checkBundleStatus = (responseBody, casesToTest, requestToRepeat) => {",
					"    console.log(responseBody.trim().length, responseBody.trim().length === 0);",
					"    if (responseBody.trim().length === 0){",
					"        console.log('AGAIN 1');",
					"        postman.setNextRequest(requestToRepeat);",
					"    } else {",
					"",
					"        const $ = cheerio.load(responseBody);",
					"",
					"        bundleWaitingPublish = pm.collectionVariables.get(\"bundleWaitingPublish\");",
					"        pendingStatus = pm.collectionVariables.get(\"pendingStatus\");",
					"        bundlingStatus = pm.collectionVariables.get(\"bundlingStatus\");",
					"        noResultFound = pm.collectionVariables.get(\"noResultFound\");",
					"        publishingBundle = pm.collectionVariables.get(\"publishingBundle\");",
					"        bundleReceived = pm.collectionVariables.get(\"bundleReceived\");",
					"",
					"        htmlWithoutSpace = $.html().replace(/(\\r\\n|\\n|\\r)/gm, \"\");",
					"",
					"        if (htmlWithoutSpace.includes(bundleWaitingPublish) || htmlWithoutSpace.includes(pendingStatus) || htmlWithoutSpace.includes(bundlingStatus) || htmlWithoutSpace.includes(noResultFound) || htmlWithoutSpace.includes(publishingBundle) || htmlWithoutSpace.includes(bundleReceived)) {",
					"            console.log('AGAIN');",
					"            postman.setNextRequest(\"check success status\");",
					"        } else {",
					"            casesToTest.forEach((caseToTest) => {",
					"                expectedInclude = pm.collectionVariables.get(caseToTest);",
					"                pm.expect(htmlWithoutSpace).to.contain(expectedInclude);",
					"            });",
					"",
					"        }",
					"    }",
					"};",
					"",
					"serverURL = pm.environment.get(\"serverURL\");",
					"",
					"console.log('hostName', serverURL);",
					"pm.collectionVariables.set(\"origin\", serverURL);",
					"",
					"pm.collectionVariables.set(\"checkBundleStatus\", checkBundleStatus.toString());",
					"",
					"wait = (ms) => {",
					"   var start = new Date().getTime();",
					"   var end = start;",
					"   while(end < start + ms) {",
					"     end = new Date().getTime();",
					"  }",
					"};",
					"",
					"pm.collectionVariables.set(\"wait\", wait.toString());",
					"",
					"bundleSuccess = \"<th>Status:</th>        <td> Success</td>    </tr>\";",
					"pm.collectionVariables.set(\"bundleSuccess\", bundleSuccess);",
					"",
					"endpointSuccess = 'Everything ok';",
					"pm.collectionVariables.set(\"endpointSuccess\", endpointSuccess);",
					"",
					"bundleFailed = \" <th>Status:</th>        <td> Failed to send to all environments</td>\";",
					"pm.collectionVariables.set(\"bundleFailed\", bundleFailed);",
					"",
					"endpointInvalidtoken = '<td valign=\"top\">Authentication error</td>\t\t\t\t        <td valign=\"top\">Invalid token</td>\t';",
					"pm.collectionVariables.set(\"endpointInvalidtoken\", endpointInvalidtoken);",
					"",
					"bundleWaitingPublish = \"<th>Status:</th>        <td> Waiting for Publishing</td>    </tr>\";",
					"pm.collectionVariables.set(\"bundleWaitingPublish\", bundleWaitingPublish);",
					"",
					"pendingStatus = \"th>Status:</th>        <td> Pending</td\";",
					"pm.collectionVariables.set(\"pendingStatus\", pendingStatus);",
					"",
					"",
					"bundlingStatus = \"th>Status:</th>        <td> Bundling</td\";",
					"pm.collectionVariables.set(\"bundlingStatus\", bundlingStatus);",
					"",
					"noResultFound = \"No results found\";",
					"",
					"pm.collectionVariables.set(\"noResultFound\", noResultFound);",
					"",
					"publishingBundle = \"Publishing bundle\";",
					"pm.collectionVariables.set(\"publishingBundle\", publishingBundle);",
					"",
					"bundleReceived = \"Bundle Received\";",
					"pm.collectionVariables.set(\"bundleReceived\", bundleReceived);",
					"",
					"",
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"id": "cdbab2b8-9cd2-4453-9867-4203fb359737",
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"id": "911a500b-b210-451a-9805-26597e35ab75",
			"key": "origin",
			"value": "http://localhost:8080"
		},
		{
			"id": "f71a28c5-22cd-4e88-8663-0502898564f0",
			"key": "environmentName",
			"value": "environment-353"
		},
		{
			"id": "90fb0915-0e61-41a5-8d94-73c7ab5147e4",
			"key": "endpointName",
			"value": "endpoint-496"
		},
		{
			"id": "c56799ea-4b11-48a7-a477-ed99f6184094",
			"key": "environmentId",
			"value": "a4d2cc7a-1566-4b0d-9c31-b22d84814506"
		},
		{
			"id": "6e55f1a7-6932-4993-a2b7-e79cee3b2b7c",
			"key": "receiverName",
			"value": "receiverName-976"
		},
		{
			"id": "df7e4a53-662a-4a3c-b937-0ba32f600074",
			"key": "bundleName",
			"value": "bundleName-461"
		},
		{
			"id": "71bfc8d8-5269-4a1d-a164-b7ca4fa37f7f",
			"key": "bundleID",
			"value": null
		},
		{
			"id": "bd4ab460-c243-4327-95fe-182917635cc1",
			"key": "bundleId",
			"value": "01EK0WTHC89J1KJKSD1SY418QQ"
		},
		{
			"id": "bb3cb2f4-dff9-48e1-a2ec-92c88425dbdf",
			"key": "token",
			"value": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhcGk5MGY5MzgwZS03MGE0LTRlYmMtOGQ1Yy1hYjY2ZTc2NjI2NjkiLCJ4bW9kIjoxNjAwODk1ODY1MDAwLCJuYmYiOjE2MDA4OTU4NjUsImlzcyI6Ijc1MzI4OGMwODYiLCJsYWJlbCI6InRlc3RpbmciLCJleHAiOjE2OTU0NjcyMzAsImlhdCI6MTYwMDg5NTg2NSwianRpIjoiNmNjOTUxYzctMTIyNi00NzkxLTk4NzMtNDA1OTdjMWNhM2VmIn0.DNcI9_MIorM1HVWN3dERS5TAfjY72DfxQlhZ7s6lcik"
		},
		{
			"id": "3ffa053a-a968-4260-ad99-a2b5f9dc6504",
			"key": "bundleSuccessExpected",
			"value": "<tr>        <th>Title</th>        <td>                            <b><span>ecc9df87-02ad-4f58-afaf-f27ae4fb2c57</span></b> (contentlet)                                </td>    </tr>    <tr>        <th>Status:</th>        <td> Success</td>    </tr>"
		},
		{
			"id": "8e4d8952-e713-443e-9a78-6feb4f5c94d2",
			"key": "bundleFailedExpected",
			"value": " <th>Status:</th>        <td> Failed to send to all environments</td>"
		},
		{
			"id": "16c86aae-e9c7-40eb-af17-74f252d66cbb",
			"key": "endpointInvalidtoken",
			"value": "<td valign=\"top\">Authentication error</td>\t\t\t\t        <td valign=\"top\">Invalid token</td>\t"
		},
		{
			"id": "a423ef3b-a657-4df7-8e55-5a3d2625d3e0",
			"key": "endpointSuccess",
			"value": "<td valign=\"top\">Success</td>\t\t\t\t        <td valign=\"top\">Everything ok</td>"
		},
		{
			"id": "7e156e73-18f1-4607-80e0-e2eecf6c1cab",
			"key": "bundleFailed",
			"value": " <th>Status:</th>        <td> Failed to send to all environments</td>"
		},
		{
			"id": "04f2c0a9-24f2-462d-a969-803eb42364a9",
			"key": "bundleSuccess",
			"value": "<th>Status:</th>        <td> Success</td>    </tr>"
		},
		{
			"id": "4ed694b5-9c16-4acb-857f-9a9a9f40ecbb",
			"key": "bundleWaitingPublish",
			"value": "<th>Status:</th>        <td> Waiting for Publishing</td>    </tr>"
		},
		{
			"id": "8d8115fb-4b56-4f3d-9a76-2ecaaf71ca45",
			"key": "checkBundleStatus",
			"value": "(responseBody, casesToTest, requestToRepeat) => {\n    console.log(responseBody.trim().length, responseBody.trim().length === 0);\n    if (responseBody.trim().length === 0){\n        console.log('AGAIN 1');\n        postman.setNextRequest(requestToRepeat);\n    } else {\n\n        const $ = cheerio.load(responseBody);\n\n        bundleWaitingPublish = pm.collectionVariables.get(\"bundleWaitingPublish\");\n        htmlWithoutSpace = $.html().replace(/(\\r\\n|\\n|\\r)/gm, \"\");\n\n        if (htmlWithoutSpace.includes(bundleWaitingPublish)) {\n            console.log('AGAIN');\n            postman.setNextRequest(\"check success status\");\n        } else {\n            casesToTest.forEach((caseToTest) => {\n                expectedInclude = pm.collectionVariables.get(caseToTest);\n                pm.expect(htmlWithoutSpace).to.contain(expectedInclude);\n            });\n\n        }\n    }\n}"
		},
		{
			"id": "dd817701-4989-45b9-b9a1-194c4daa9abf",
			"key": "wait",
			"value": "(ms) => {\n   var start = new Date().getTime();\n   var end = start;\n   while(end < start + ms) {\n     end = new Date().getTime();\n  }\n}"
		}
	],
	"protocolProfileBehavior": {}
}