{
	"info": {
		"_postman_id": "4026b86b-7de7-4a82-93f1-48c9b9f265ba",
		"name": "Push Publish from sender",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Push Publish Old Way",
			"item": [
				{
					"name": "Happy path",
					"item": [
						{
							"name": "set USE_JWT_TOKEN_IN_PUSH_PUBLISH to false",
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "PUT",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"USE_JWT_TOKEN_IN_PUSH_PUBLISH\": false\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{serverURL}}/api//v1/configuration",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"api",
										"",
										"v1",
										"configuration"
									]
								}
							},
							"response": []
						},
						{
							"name": "create environment",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "909a38ca-a3aa-4993-951c-8a0f522f0463",
										"exec": [
											"",
											"",
											"environmentName = 'environment-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"environmentName\", environmentName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "6a8a2cd5-5043-4a10-ae91-2bfad204e283",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"    var environmentId = pm.response.text();",
											"    pm.collectionVariables.set(\"environmentId\", environmentId);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"value": "{{origin}}",
										"type": "text"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.environment.ajax.EnvironmentAjaxAction/cmd/addEnvironment?environmentName={{environmentName}}&pushType=pushToOne&whoCanUseSelect=e7d4e34e-5127-45fc-8123-d48b62d510e3&whoCanUse=e7d4e34e-5127-45fc-8123-d48b62d510e3",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.environment.ajax.EnvironmentAjaxAction",
										"cmd",
										"addEnvironment"
									],
									"query": [
										{
											"key": "environmentName",
											"value": "{{environmentName}}"
										},
										{
											"key": "pushType",
											"value": "pushToOne"
										},
										{
											"key": "whoCanUseSelect",
											"value": "e7d4e34e-5127-45fc-8123-d48b62d510e3"
										},
										{
											"key": "whoCanUse",
											"value": "e7d4e34e-5127-45fc-8123-d48b62d510e3"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "create end point",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "079ce1ea-86a0-44c4-ac1d-228ea2b9a016",
										"exec": [
											"endpointName = 'endpoint-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"endpointName\", endpointName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "1deca11d-b221-4020-b4da-530e2c0036f0",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction/cmd/addEndpoint?sending=false&serverName={{endpointName}}&environmentId={{environmentId}}&protocol=http&address=localhost&port=8080&authKey=123&enabled=on",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction",
										"cmd",
										"addEndpoint"
									],
									"query": [
										{
											"key": "sending",
											"value": "false"
										},
										{
											"key": "serverName",
											"value": "{{endpointName}}"
										},
										{
											"key": "environmentId",
											"value": "{{environmentId}}"
										},
										{
											"key": "protocol",
											"value": "http"
										},
										{
											"key": "address",
											"value": "localhost"
										},
										{
											"key": "port",
											"value": "8080"
										},
										{
											"key": "authKey",
											"value": "123"
										},
										{
											"key": "enabled",
											"value": "on"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "create content type and content",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "65eb296a-4fc4-4c94-8004-36d1c1f88cad",
										"exec": [
											"pm.test(\"Bundle uploaded sucessfully\", function () {",
											"    pm.response.to.have.status(200);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										},
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/octet-stream"
									},
									{
										"key": "Content-Disposition",
										"type": "text",
										"value": "attachment"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": [
										{
											"key": "file",
											"contentType": "application/tar+gzip ",
											"type": "file",
											"src": "resources/Push_publish/content_type_and_content_demo.tar.gz"
										}
									],
									"options": {
										"formdata": {}
									}
								},
								"url": {
									"raw": "{{serverURL}}/api/bundle/sync",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"api",
										"bundle",
										"sync"
									]
								},
								"description": "Imports a Bundle that includes:\n*  A piece of content of type \"Rich text\" with \"test Content\" as title and body"
							},
							"response": []
						},
						{
							"name": "Add bundle",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "b4bf4f6e-a149-4b8e-b529-abc4c01d091f",
										"exec": [
											"bundleName = 'bundleName-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"bundleName\", bundleName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "a769d0e8-ed38-4426-877a-88cafe3a2fea",
										"exec": [
											"pm.test(\"Bundle uploaded sucessfully\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"    var jsonData = pm.response.json();",
											"    pm.collectionVariables.set(\"bundleId\", jsonData[\"bundleId\"]);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.ajax.RemotePublishAjaxAction/cmd/addToBundle?assetIdentifier=ea533f67-4883-42bb-9701-83293e7313e5&bundleName={{bundleName}}",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.ajax.RemotePublishAjaxAction",
										"cmd",
										"addToBundle"
									],
									"query": [
										{
											"key": "assetIdentifier",
											"value": "ea533f67-4883-42bb-9701-83293e7313e5"
										},
										{
											"key": "bundleName",
											"value": "{{bundleName}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Push publish",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "bfd9650d-7060-4d16-a5eb-4324d8c4d133",
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "7ee3dc8e-4a3c-4d17-b5f2-98c0d9c73e57",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.ajax.RemotePublishAjaxAction/cmd/pushBundle?assetIdentifier={{bundleId}}&iWantTo=publish&whoToSend={{environmentId}}&remotePublishDate=2020-09-10&remotePublishTime=17-14",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.ajax.RemotePublishAjaxAction",
										"cmd",
										"pushBundle"
									],
									"query": [
										{
											"key": "assetIdentifier",
											"value": "{{bundleId}}"
										},
										{
											"key": "iWantTo",
											"value": "publish"
										},
										{
											"key": "whoToSend",
											"value": "{{environmentId}}"
										},
										{
											"key": "remotePublishDate",
											"value": "2020-09-10"
										},
										{
											"key": "remotePublishTime",
											"value": "17-14"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "check success status",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "fd67897f-360f-4a29-8246-b095fd6e8239",
										"exec": [
											"",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "9a070817-34fb-4382-9bdf-0d4464435af9",
										"exec": [
											"pm.test(\"Bundle uploaded sucessfully\", function () {",
											"",
											"    checkBundleStatus = eval(pm.collectionVariables.get(\"checkBundleStatus\", checkBundleStatus.toString()));",
											"",
											"    pm.response.to.have.status(200);",
											"",
											"    checkBundleStatus(pm.response.text(), [\"bundleSuccess\", \"endpointSuccess\"], \"check success status\");",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/html/portlet/ext/contentlet/publishing/view_publish_audit_detail.jsp?bundle={{bundleId}}",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"html",
										"portlet",
										"ext",
										"contentlet",
										"publishing",
										"view_publish_audit_detail.jsp"
									],
									"query": [
										{
											"key": "bundle",
											"value": "{{bundleId}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "set USE_JWT_TOKEN_IN_PUSH_PUBLISH to true",
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "PUT",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"USE_JWT_TOKEN_IN_PUSH_PUBLISH\": true\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{serverURL}}/api//v1/configuration",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"api",
										"",
										"v1",
										"configuration"
									]
								}
							},
							"response": []
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				},
				{
					"name": "Invalid token",
					"item": [
						{
							"name": "set USE_JWT_TOKEN_IN_PUSH_PUBLISH to false",
							"request": {
								"method": "PUT",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"USE_JWT_TOKEN_IN_PUSH_PUBLISH\": false\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{serverURL}}/api//v1/configuration",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"api",
										"",
										"v1",
										"configuration"
									]
								}
							},
							"response": []
						},
						{
							"name": "create environment",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "1614a4d5-a3e0-497d-8a2a-9476b957fc74",
										"exec": [
											"",
											"environmentName = 'environment-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"environmentName\", environmentName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "b1251507-9abd-4d73-9e72-ddab256379ea",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"    var environmentId = pm.response.text();",
											"    pm.collectionVariables.set(\"environmentId\", environmentId);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"value": "{{origin}}",
										"type": "text"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.environment.ajax.EnvironmentAjaxAction/cmd/addEnvironment?environmentName={{environmentName}}&pushType=pushToOne&whoCanUseSelect=e7d4e34e-5127-45fc-8123-d48b62d510e3&whoCanUse=e7d4e34e-5127-45fc-8123-d48b62d510e3",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.environment.ajax.EnvironmentAjaxAction",
										"cmd",
										"addEnvironment"
									],
									"query": [
										{
											"key": "environmentName",
											"value": "{{environmentName}}"
										},
										{
											"key": "pushType",
											"value": "pushToOne"
										},
										{
											"key": "whoCanUseSelect",
											"value": "e7d4e34e-5127-45fc-8123-d48b62d510e3"
										},
										{
											"key": "whoCanUse",
											"value": "e7d4e34e-5127-45fc-8123-d48b62d510e3"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "create end point",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "938611ff-fa47-4e14-a301-114ea266d588",
										"exec": [
											"endpointName = 'endpoint-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"endpointName\", endpointName);",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction/cmd/addEndpoint?sending=false&serverName={{endpointName}}&environmentId={{environmentId}}&protocol=http&address=localhost&port=8080&authKey=invalid&enabled=on",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction",
										"cmd",
										"addEndpoint"
									],
									"query": [
										{
											"key": "sending",
											"value": "false"
										},
										{
											"key": "serverName",
											"value": "{{endpointName}}"
										},
										{
											"key": "environmentId",
											"value": "{{environmentId}}"
										},
										{
											"key": "protocol",
											"value": "http"
										},
										{
											"key": "address",
											"value": "localhost"
										},
										{
											"key": "port",
											"value": "8080"
										},
										{
											"key": "authKey",
											"value": "invalid"
										},
										{
											"key": "enabled",
											"value": "on"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "create content type and content",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "0cb82b80-2149-4b21-af7b-401a7d2c2b13",
										"exec": [
											"pm.test(\"Bundle uploaded sucessfully\", function () {",
											"    pm.response.to.have.status(200);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										},
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/octet-stream"
									},
									{
										"key": "Content-Disposition",
										"type": "text",
										"value": "attachment"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": [
										{
											"key": "file",
											"contentType": "application/tar+gzip ",
											"type": "file",
											"src": "resources/Push_publish/content_type_and_content_demo.tar.gz"
										}
									],
									"options": {
										"formdata": {}
									}
								},
								"url": {
									"raw": "{{serverURL}}/api/bundle/sync",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"api",
										"bundle",
										"sync"
									]
								},
								"description": "Imports a Bundle that includes:\n*  A piece of content of type \"Rich text\" with \"test Content\" as title and body"
							},
							"response": []
						},
						{
							"name": "Add bundle",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "e511452d-c412-4c99-8c24-4af13af0c182",
										"exec": [
											"bundleName = 'bundleName-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"bundleName\", bundleName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "ced11670-164c-4e6c-802f-6732662a3e2f",
										"exec": [
											"pm.test(\"Bundle uploaded sucessfully\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"    var jsonData = pm.response.json();",
											"    pm.collectionVariables.set(\"bundleId\", jsonData[\"bundleId\"]);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.ajax.RemotePublishAjaxAction/cmd/addToBundle?assetIdentifier=ea533f67-4883-42bb-9701-83293e7313e5&bundleName={{bundleName}}",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.ajax.RemotePublishAjaxAction",
										"cmd",
										"addToBundle"
									],
									"query": [
										{
											"key": "assetIdentifier",
											"value": "ea533f67-4883-42bb-9701-83293e7313e5"
										},
										{
											"key": "bundleName",
											"value": "{{bundleName}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Push publish",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "9f0aa61a-4e1f-4814-89c4-b582f0e74c99",
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "15522605-e81a-4ecc-9cbc-d970bc8d3bde",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.ajax.RemotePublishAjaxAction/cmd/pushBundle?assetIdentifier={{bundleId}}&iWantTo=publish&whoToSend={{environmentId}}&remotePublishDate=2020-09-10&remotePublishTime=17-14",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.ajax.RemotePublishAjaxAction",
										"cmd",
										"pushBundle"
									],
									"query": [
										{
											"key": "assetIdentifier",
											"value": "{{bundleId}}"
										},
										{
											"key": "iWantTo",
											"value": "publish"
										},
										{
											"key": "whoToSend",
											"value": "{{environmentId}}"
										},
										{
											"key": "remotePublishDate",
											"value": "2020-09-10"
										},
										{
											"key": "remotePublishTime",
											"value": "17-14"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "check failed status",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "670ecb0c-199b-4603-8c9a-52059917282d",
										"exec": [
											"",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "2dce1bb7-9d56-4058-91a1-23c3c32917bf",
										"exec": [
											"pm.test(\"Bundle uploaded sucessfully\", function () {",
											"",
											"    checkBundleStatus = eval(pm.collectionVariables.get(\"checkBundleStatus\", checkBundleStatus.toString()));",
											"",
											"    pm.response.to.have.status(200);",
											"",
											"    checkBundleStatus(pm.response.text(), [\"bundleFailed\", \"endpointInvalidtoken\"], \"check failed status\");",
											"});",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/html/portlet/ext/contentlet/publishing/view_publish_audit_detail.jsp?bundle={{bundleId}}",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"html",
										"portlet",
										"ext",
										"contentlet",
										"publishing",
										"view_publish_audit_detail.jsp"
									],
									"query": [
										{
											"key": "bundle",
											"value": "{{bundleId}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "set USE_JWT_TOKEN_IN_PUSH_PUBLISH to true",
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "PUT",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"USE_JWT_TOKEN_IN_PUSH_PUBLISH\": true\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{serverURL}}/api//v1/configuration",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"api",
										"",
										"v1",
										"configuration"
									]
								}
							},
							"response": []
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				}
			],
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"id": "fc384e85-227b-4eff-b8db-047c4265636a",
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"id": "bbed5b33-b2c2-4555-bf34-92f2e71dff75",
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				}
			],
			"protocolProfileBehavior": {}
		},
		{
			"name": "Push Publish JWT token",
			"item": [
				{
					"name": "Happy path",
					"item": [
						{
							"name": "request_token",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "11b11bff-9d77-4d39-8710-d0de1bbbf5a6",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"    var jsonData = pm.response.json();",
											"    pm.expect(jsonData.errors.length).to.eql(0);",
											"    pm.expect(jsonData.entity).to.not.eq(undefined);",
											"    pm.expect(jsonData.entity.jwt).to.not.eq(undefined);",
											"    pm.collectionVariables.set(\"token\", jsonData.entity.jwt);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"claims\": {\n        \"label\": \"testing\"\n    },\n    \"expirationSeconds\": 94571365,\n    \"network\": \"0.0.0.0/0\",\n    \"userId\": \"dotcms.org.1\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{serverURL}}/api/v1/apitoken",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"api",
										"v1",
										"apitoken"
									]
								}
							},
							"response": []
						},
						{
							"name": "create environment",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "9e0b7b2a-fb31-43d4-b814-f9846affd184",
										"exec": [
											"",
											"environmentName = 'environment-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"environmentName\", environmentName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "13bc3de6-ce59-44a8-91b9-8484764cc8a8",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"    var environmentId = pm.response.text();",
											"    pm.collectionVariables.set(\"environmentId\", environmentId);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"value": "{{origin}}",
										"type": "text"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.environment.ajax.EnvironmentAjaxAction/cmd/addEnvironment?environmentName={{environmentName}}&pushType=pushToOne&whoCanUseSelect=e7d4e34e-5127-45fc-8123-d48b62d510e3&whoCanUse=e7d4e34e-5127-45fc-8123-d48b62d510e3",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.environment.ajax.EnvironmentAjaxAction",
										"cmd",
										"addEnvironment"
									],
									"query": [
										{
											"key": "environmentName",
											"value": "{{environmentName}}"
										},
										{
											"key": "pushType",
											"value": "pushToOne"
										},
										{
											"key": "whoCanUseSelect",
											"value": "e7d4e34e-5127-45fc-8123-d48b62d510e3"
										},
										{
											"key": "whoCanUse",
											"value": "e7d4e34e-5127-45fc-8123-d48b62d510e3"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "create end point",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "83dd9c02-0fd2-4fd1-bfa9-61d915441651",
										"exec": [
											"endpointName = 'endpoint-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"endpointName\", endpointName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "125693ae-7c9f-46dd-a6bb-2ae45a8c307b",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction/cmd/addEndpoint?sending=false&serverName={{endpointName}}&environmentId={{environmentId}}&protocol=http&address=localhost&port=8080&authKey={{token}}&enabled=on",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction",
										"cmd",
										"addEndpoint"
									],
									"query": [
										{
											"key": "sending",
											"value": "false"
										},
										{
											"key": "serverName",
											"value": "{{endpointName}}"
										},
										{
											"key": "environmentId",
											"value": "{{environmentId}}"
										},
										{
											"key": "protocol",
											"value": "http"
										},
										{
											"key": "address",
											"value": "localhost"
										},
										{
											"key": "port",
											"value": "8080"
										},
										{
											"key": "authKey",
											"value": "{{token}}"
										},
										{
											"key": "enabled",
											"value": "on"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "create content type and content",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "2fd1a70f-5dca-4f31-b136-20d85e36fc0a",
										"exec": [
											"pm.test(\"Bundle uploaded sucessfully\", function () {",
											"    pm.response.to.have.status(200);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										},
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/octet-stream"
									},
									{
										"key": "Content-Disposition",
										"type": "text",
										"value": "attachment"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": [
										{
											"key": "file",
											"contentType": "application/tar+gzip ",
											"type": "file",
											"src": "resources/Push_publish/content_type_and_content_demo.tar.gz"
										}
									],
									"options": {
										"formdata": {}
									}
								},
								"url": {
									"raw": "{{serverURL}}/api/bundle/sync",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"api",
										"bundle",
										"sync"
									]
								},
								"description": "Imports a Bundle that includes:\n*  A piece of content of type \"Rich text\" with \"test Content\" as title and body"
							},
							"response": []
						},
						{
							"name": "Add bundle",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "eda5916a-468f-4af3-8ca8-d54c92e559f5",
										"exec": [
											"bundleName = 'bundleName-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"bundleName\", bundleName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "006a440a-e3ab-4a84-9b46-b757d26e119b",
										"exec": [
											"pm.test(\"Bundle uploaded sucessfully\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"    var jsonData = pm.response.json();",
											"    pm.collectionVariables.set(\"bundleId\", jsonData[\"bundleId\"]);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.ajax.RemotePublishAjaxAction/cmd/addToBundle?assetIdentifier=cc8d9edc-f01e-405d-b2c0-020869391bdb&bundleName={{bundleName}}",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.ajax.RemotePublishAjaxAction",
										"cmd",
										"addToBundle"
									],
									"query": [
										{
											"key": "assetIdentifier",
											"value": "cc8d9edc-f01e-405d-b2c0-020869391bdb"
										},
										{
											"key": "bundleName",
											"value": "{{bundleName}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Push publish",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "521f87a0-6c49-43f8-b7f1-4ee70a13afd1",
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.ajax.RemotePublishAjaxAction/cmd/pushBundle?assetIdentifier={{bundleId}}&iWantTo=publish&whoToSend={{environmentId}}&remotePublishDate=2020-09-10&remotePublishTime=17-14",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.ajax.RemotePublishAjaxAction",
										"cmd",
										"pushBundle"
									],
									"query": [
										{
											"key": "assetIdentifier",
											"value": "{{bundleId}}"
										},
										{
											"key": "iWantTo",
											"value": "publish"
										},
										{
											"key": "whoToSend",
											"value": "{{environmentId}}"
										},
										{
											"key": "remotePublishDate",
											"value": "2020-09-10"
										},
										{
											"key": "remotePublishTime",
											"value": "17-14"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "check success status",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "4d851b79-a122-4fef-b0d0-017e10e214ad",
										"exec": [
											"",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "1c10be4d-d044-48f4-b44e-e2bcf383b8c3",
										"exec": [
											"",
											"pm.test(\"Bundle uploaded sucessfully\", function () {",
											"",
											"    checkBundleStatus = eval(pm.collectionVariables.get(\"checkBundleStatus\", checkBundleStatus.toString()));",
											"",
											"    pm.response.to.have.status(200);",
											"",
											"    checkBundleStatus(pm.response.text(), [\"bundleSuccess\", \"endpointSuccess\"], \"check success status\");",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/html/portlet/ext/contentlet/publishing/view_publish_audit_detail.jsp?bundle={{bundleId}}",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"html",
										"portlet",
										"ext",
										"contentlet",
										"publishing",
										"view_publish_audit_detail.jsp"
									],
									"query": [
										{
											"key": "bundle",
											"value": "{{bundleId}}"
										}
									]
								}
							},
							"response": []
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				},
				{
					"name": "Expired token",
					"item": [
						{
							"name": "request_token",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "531dd557-9ef6-480c-ae53-b45e33d59369",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"    var jsonData = pm.response.json();",
											"    pm.expect(jsonData.errors.length).to.eql(0);",
											"    pm.expect(jsonData.entity).to.not.eq(undefined);",
											"    pm.expect(jsonData.entity.jwt).to.not.eq(undefined);",
											"    pm.collectionVariables.set(\"token\", jsonData.entity.jwt);",
											"",
											"    eval(pm.collectionVariables.get(\"wait\"))(2000); //wait 2 seconds",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"claims\": {\n        \"label\": \"testing\"\n    },\n    \"expirationSeconds\": 1,\n    \"network\": \"0.0.0.0/0\",\n    \"userId\": \"dotcms.org.1\"\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{serverURL}}/api/v1/apitoken",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"api",
										"v1",
										"apitoken"
									]
								}
							},
							"response": []
						},
						{
							"name": "create environment",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "c18b8236-4f10-4652-ba66-cafe4a4970cd",
										"exec": [
											"",
											"environmentName = 'environment-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"environmentName\", environmentName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "5f674e23-3541-45c1-8ad5-f5382a847e1f",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"    var environmentId = pm.response.text();",
											"    pm.collectionVariables.set(\"environmentId\", environmentId);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"value": "{{origin}}",
										"type": "text"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.environment.ajax.EnvironmentAjaxAction/cmd/addEnvironment?environmentName={{environmentName}}&pushType=pushToOne&whoCanUseSelect=e7d4e34e-5127-45fc-8123-d48b62d510e3&whoCanUse=e7d4e34e-5127-45fc-8123-d48b62d510e3",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.environment.ajax.EnvironmentAjaxAction",
										"cmd",
										"addEnvironment"
									],
									"query": [
										{
											"key": "environmentName",
											"value": "{{environmentName}}"
										},
										{
											"key": "pushType",
											"value": "pushToOne"
										},
										{
											"key": "whoCanUseSelect",
											"value": "e7d4e34e-5127-45fc-8123-d48b62d510e3"
										},
										{
											"key": "whoCanUse",
											"value": "e7d4e34e-5127-45fc-8123-d48b62d510e3"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "create end point",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "2d622022-c721-46ce-bbab-4b8888a9a1e2",
										"exec": [
											"endpointName = 'endpoint-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"endpointName\", endpointName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "263c5c62-a656-48ad-b6db-846db3ee5607",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction/cmd/addEndpoint?sending=false&serverName={{endpointName}}&environmentId={{environmentId}}&protocol=http&address=localhost&port=8080&authKey={{token}}&enabled=on",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction",
										"cmd",
										"addEndpoint"
									],
									"query": [
										{
											"key": "sending",
											"value": "false"
										},
										{
											"key": "serverName",
											"value": "{{endpointName}}"
										},
										{
											"key": "environmentId",
											"value": "{{environmentId}}"
										},
										{
											"key": "protocol",
											"value": "http"
										},
										{
											"key": "address",
											"value": "localhost"
										},
										{
											"key": "port",
											"value": "8080"
										},
										{
											"key": "authKey",
											"value": "{{token}}"
										},
										{
											"key": "enabled",
											"value": "on"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "create content type and content",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "ea410b21-953b-46d8-b042-e2eff8639a89",
										"exec": [
											"pm.test(\"Bundle uploaded sucessfully\", function () {",
											"    pm.response.to.have.status(200);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										},
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/octet-stream"
									},
									{
										"key": "Content-Disposition",
										"type": "text",
										"value": "attachment"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": [
										{
											"key": "file",
											"contentType": "application/tar+gzip ",
											"type": "file",
											"src": "resources/Push_publish/content_type_and_content_demo.tar.gz"
										}
									],
									"options": {
										"formdata": {}
									}
								},
								"url": {
									"raw": "{{serverURL}}/api/bundle/sync",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"api",
										"bundle",
										"sync"
									]
								},
								"description": "Imports a Bundle that includes:\n*  A piece of content of type \"Rich text\" with \"test Content\" as title and body"
							},
							"response": []
						},
						{
							"name": "Add bundle",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "29f15d25-82b8-4995-9ce3-df7a5f101be0",
										"exec": [
											"bundleName = 'bundleName-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"bundleName\", bundleName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "c68efa2e-56ed-4210-a53e-3c46763d9530",
										"exec": [
											"pm.test(\"Bundle uploaded sucessfully\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"    var jsonData = pm.response.json();",
											"    pm.collectionVariables.set(\"bundleId\", jsonData[\"bundleId\"]);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.ajax.RemotePublishAjaxAction/cmd/addToBundle?assetIdentifier=cc8d9edc-f01e-405d-b2c0-020869391bdb&bundleName={{bundleName}}",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.ajax.RemotePublishAjaxAction",
										"cmd",
										"addToBundle"
									],
									"query": [
										{
											"key": "assetIdentifier",
											"value": "cc8d9edc-f01e-405d-b2c0-020869391bdb"
										},
										{
											"key": "bundleName",
											"value": "{{bundleName}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Push publish",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "2861f8cf-87e5-4c97-8b5e-d6d4ae6b8198",
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.ajax.RemotePublishAjaxAction/cmd/pushBundle?assetIdentifier={{bundleId}}&iWantTo=publish&whoToSend={{environmentId}}&remotePublishDate=2020-09-10&remotePublishTime=17-14",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.ajax.RemotePublishAjaxAction",
										"cmd",
										"pushBundle"
									],
									"query": [
										{
											"key": "assetIdentifier",
											"value": "{{bundleId}}"
										},
										{
											"key": "iWantTo",
											"value": "publish"
										},
										{
											"key": "whoToSend",
											"value": "{{environmentId}}"
										},
										{
											"key": "remotePublishDate",
											"value": "2020-09-10"
										},
										{
											"key": "remotePublishTime",
											"value": "17-14"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "check failed status",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "2cc47e71-b66c-4c6a-b600-d4f44d2c869e",
										"exec": [
											"",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "e5082360-797d-4d6a-9e37-87f7c24bfae8",
										"exec": [
											"pm.test(\"Bundle uploaded sucessfully\", function () {",
											"",
											"    checkBundleStatus = eval(pm.collectionVariables.get(\"checkBundleStatus\", checkBundleStatus.toString()));",
											"",
											"    pm.response.to.have.status(200);",
											"",
											"    checkBundleStatus(pm.response.text(), [\"bundleFailed\", \"endpointInvalidtoken\"], \"check failed status\");",
											"});",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/html/portlet/ext/contentlet/publishing/view_publish_audit_detail.jsp?bundle={{bundleId}}",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"html",
										"portlet",
										"ext",
										"contentlet",
										"publishing",
										"view_publish_audit_detail.jsp"
									],
									"query": [
										{
											"key": "bundle",
											"value": "{{bundleId}}"
										}
									]
								}
							},
							"response": []
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				},
				{
					"name": "Invalid token",
					"item": [
						{
							"name": "create environment",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "5ec6951d-99d6-4613-a61d-0937201eb386",
										"exec": [
											"",
											"environmentName = 'environment-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"environmentName\", environmentName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "625e4122-514e-4298-9247-550ec6796b5a",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"    var environmentId = pm.response.text();",
											"    pm.collectionVariables.set(\"environmentId\", environmentId);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"value": "{{origin}}",
										"type": "text"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.environment.ajax.EnvironmentAjaxAction/cmd/addEnvironment?environmentName={{environmentName}}&pushType=pushToOne&whoCanUseSelect=e7d4e34e-5127-45fc-8123-d48b62d510e3&whoCanUse=e7d4e34e-5127-45fc-8123-d48b62d510e3",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.environment.ajax.EnvironmentAjaxAction",
										"cmd",
										"addEnvironment"
									],
									"query": [
										{
											"key": "environmentName",
											"value": "{{environmentName}}"
										},
										{
											"key": "pushType",
											"value": "pushToOne"
										},
										{
											"key": "whoCanUseSelect",
											"value": "e7d4e34e-5127-45fc-8123-d48b62d510e3"
										},
										{
											"key": "whoCanUse",
											"value": "e7d4e34e-5127-45fc-8123-d48b62d510e3"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "create end point",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "aa424a3f-7947-4205-939d-a7a29a22278d",
										"exec": [
											"endpointName = 'endpoint-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"endpointName\", endpointName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "a32c489e-8e23-4a18-ab17-c0deca46ca14",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction/cmd/addEndpoint?sending=false&serverName={{endpointName}}&environmentId={{environmentId}}&protocol=http&address=localhost&port=8080&authKey=invalid_token&enabled=on",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction",
										"cmd",
										"addEndpoint"
									],
									"query": [
										{
											"key": "sending",
											"value": "false"
										},
										{
											"key": "serverName",
											"value": "{{endpointName}}"
										},
										{
											"key": "environmentId",
											"value": "{{environmentId}}"
										},
										{
											"key": "protocol",
											"value": "http"
										},
										{
											"key": "address",
											"value": "localhost"
										},
										{
											"key": "port",
											"value": "8080"
										},
										{
											"key": "authKey",
											"value": "invalid_token"
										},
										{
											"key": "enabled",
											"value": "on"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "create content type and content",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "6f5a4460-e561-4288-8b01-43e7b317046e",
										"exec": [
											"pm.test(\"Bundle uploaded sucessfully\", function () {",
											"    pm.response.to.have.status(200);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										},
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/octet-stream"
									},
									{
										"key": "Content-Disposition",
										"type": "text",
										"value": "attachment"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": [
										{
											"key": "file",
											"contentType": "application/tar+gzip ",
											"type": "file",
											"src": "resources/Push_publish/content_type_and_content_demo.tar.gz"
										}
									],
									"options": {
										"formdata": {}
									}
								},
								"url": {
									"raw": "{{serverURL}}/api/bundle/sync",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"api",
										"bundle",
										"sync"
									]
								},
								"description": "Imports a Bundle that includes:\n*  A piece of content of type \"Rich text\" with \"test Content\" as title and body"
							},
							"response": []
						},
						{
							"name": "Add bundle",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "7ef4e50a-fbde-4a1a-91d5-a1b148be072c",
										"exec": [
											"bundleName = 'bundleName-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"bundleName\", bundleName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "75dfdfe7-b6e0-4ea0-ba97-368b1146ac89",
										"exec": [
											"pm.test(\"Bundle uploaded sucessfully\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"    var jsonData = pm.response.json();",
											"    pm.collectionVariables.set(\"bundleId\", jsonData[\"bundleId\"]);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.ajax.RemotePublishAjaxAction/cmd/addToBundle?assetIdentifier=cc8d9edc-f01e-405d-b2c0-020869391bdb&bundleName={{bundleName}}",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.ajax.RemotePublishAjaxAction",
										"cmd",
										"addToBundle"
									],
									"query": [
										{
											"key": "assetIdentifier",
											"value": "cc8d9edc-f01e-405d-b2c0-020869391bdb"
										},
										{
											"key": "bundleName",
											"value": "{{bundleName}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Push publish",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "56fafb0a-e735-4f8f-9e59-bf3ca9019e9e",
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.ajax.RemotePublishAjaxAction/cmd/pushBundle?assetIdentifier={{bundleId}}&iWantTo=publish&whoToSend={{environmentId}}&remotePublishDate=2020-09-10&remotePublishTime=17-14",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.ajax.RemotePublishAjaxAction",
										"cmd",
										"pushBundle"
									],
									"query": [
										{
											"key": "assetIdentifier",
											"value": "{{bundleId}}"
										},
										{
											"key": "iWantTo",
											"value": "publish"
										},
										{
											"key": "whoToSend",
											"value": "{{environmentId}}"
										},
										{
											"key": "remotePublishDate",
											"value": "2020-09-10"
										},
										{
											"key": "remotePublishTime",
											"value": "17-14"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "check failed status",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "c5057065-dd01-4dcf-ad16-ed1d8b39ec92",
										"exec": [
											"",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "4d388a05-305f-4708-a53f-802bac8fc4e9",
										"exec": [
											"pm.test(\"Bundle uploaded sucessfully\", function () {",
											"",
											"    checkBundleStatus = eval(pm.collectionVariables.get(\"checkBundleStatus\", checkBundleStatus.toString()));",
											"",
											"    pm.response.to.have.status(200);",
											"",
											"    checkBundleStatus(pm.response.text(), [\"bundleFailed\", \"endpointInvalidtoken\"], \"check failed status\");",
											"});",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/html/portlet/ext/contentlet/publishing/view_publish_audit_detail.jsp?bundle={{bundleId}}",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"html",
										"portlet",
										"ext",
										"contentlet",
										"publishing",
										"view_publish_audit_detail.jsp"
									],
									"query": [
										{
											"key": "bundle",
											"value": "{{bundleId}}"
										}
									]
								}
							},
							"response": []
						}
					],
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "c906b96f-2e4a-480c-b436-0a88eca89462",
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "a5e3cc9f-2623-4e49-99aa-2b35c3b8944c",
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				},
				{
					"name": "When JWT fail should use old way",
					"item": [
						{
							"name": "create environment",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "ec44b151-fc06-43cf-a3b0-5c2ae806630e",
										"exec": [
											"",
											"environmentName = 'environment-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"environmentName\", environmentName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "70777da2-187c-4216-8827-32a6a6a5ef0f",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"    var environmentId = pm.response.text();",
											"    pm.collectionVariables.set(\"environmentId\", environmentId);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"value": "{{origin}}",
										"type": "text"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.environment.ajax.EnvironmentAjaxAction/cmd/addEnvironment?environmentName={{environmentName}}&pushType=pushToOne&whoCanUseSelect=e7d4e34e-5127-45fc-8123-d48b62d510e3&whoCanUse=e7d4e34e-5127-45fc-8123-d48b62d510e3",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.environment.ajax.EnvironmentAjaxAction",
										"cmd",
										"addEnvironment"
									],
									"query": [
										{
											"key": "environmentName",
											"value": "{{environmentName}}"
										},
										{
											"key": "pushType",
											"value": "pushToOne"
										},
										{
											"key": "whoCanUseSelect",
											"value": "e7d4e34e-5127-45fc-8123-d48b62d510e3"
										},
										{
											"key": "whoCanUse",
											"value": "e7d4e34e-5127-45fc-8123-d48b62d510e3"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "create end point",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "f738cafa-015e-45f0-ab03-9b3adba0dd35",
										"exec": [
											"endpointName = 'endpoint-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"endpointName\", endpointName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "f4061cd6-b0fe-479e-8dfb-0f40d80153de",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction/cmd/addEndpoint?sending=false&serverName={{endpointName}}&environmentId={{environmentId}}&protocol=http&address=localhost&port=8080&authKey=123&enabled=on",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction",
										"cmd",
										"addEndpoint"
									],
									"query": [
										{
											"key": "sending",
											"value": "false"
										},
										{
											"key": "serverName",
											"value": "{{endpointName}}"
										},
										{
											"key": "environmentId",
											"value": "{{environmentId}}"
										},
										{
											"key": "protocol",
											"value": "http"
										},
										{
											"key": "address",
											"value": "localhost"
										},
										{
											"key": "port",
											"value": "8080"
										},
										{
											"key": "authKey",
											"value": "123"
										},
										{
											"key": "enabled",
											"value": "on"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "create receiver",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "327303b0-9278-4783-845a-850330ee507e",
										"exec": [
											"receiverName = 'receiverName-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"receiverName\", receiverName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "836f3514-79e0-468e-aa4f-4837dee2f4e8",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction/cmd/addEndpoint?sending=true&serverName={{receiverName}}&environmentId={{environmentId}}&address=localhost&authKey=123&enabled=on",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction",
										"cmd",
										"addEndpoint"
									],
									"query": [
										{
											"key": "sending",
											"value": "true"
										},
										{
											"key": "serverName",
											"value": "{{receiverName}}"
										},
										{
											"key": "environmentId",
											"value": "{{environmentId}}"
										},
										{
											"key": "address",
											"value": "localhost"
										},
										{
											"key": "authKey",
											"value": "123"
										},
										{
											"key": "enabled",
											"value": "on"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "create content type and content",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "ef9113b7-0a23-4931-b1ee-1cf83685e33a",
										"exec": [
											"pm.test(\"Bundle uploaded sucessfully\", function () {",
											"    pm.response.to.have.status(200);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										},
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"type": "text",
										"value": "application/octet-stream"
									},
									{
										"key": "Content-Disposition",
										"type": "text",
										"value": "attachment"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": [
										{
											"key": "file",
											"contentType": "application/tar+gzip ",
											"type": "file",
											"src": "resources/Push_publish/content_type_and_content_demo.tar.gz"
										}
									],
									"options": {
										"formdata": {}
									}
								},
								"url": {
									"raw": "{{serverURL}}/api/bundle/sync",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"api",
										"bundle",
										"sync"
									]
								},
								"description": "Imports a Bundle that includes:\n*  A piece of content of type \"Rich text\" with \"test Content\" as title and body"
							},
							"response": []
						},
						{
							"name": "Add bundle",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "27ea95ee-06fc-4490-95df-15ccb2477bff",
										"exec": [
											"bundleName = 'bundleName-' + new Date().getMilliseconds();",
											"pm.collectionVariables.set(\"bundleName\", bundleName);",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "5add608f-211c-4ae2-a949-69810e0454fe",
										"exec": [
											"pm.test(\"Bundle uploaded sucessfully\", function () {",
											"    pm.response.to.have.status(200);",
											"",
											"    var jsonData = pm.response.json();",
											"    pm.collectionVariables.set(\"bundleId\", jsonData[\"bundleId\"]);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.ajax.RemotePublishAjaxAction/cmd/addToBundle?assetIdentifier=ea533f67-4883-42bb-9701-83293e7313e5&bundleName={{bundleName}}",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.ajax.RemotePublishAjaxAction",
										"cmd",
										"addToBundle"
									],
									"query": [
										{
											"key": "assetIdentifier",
											"value": "ea533f67-4883-42bb-9701-83293e7313e5"
										},
										{
											"key": "bundleName",
											"value": "{{bundleName}}"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "Push publish",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "674bdf6a-4682-46f9-8ff3-dfcefffd08e8",
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "8b38a0f4-afb9-4312-b183-93bf1a7e31b1",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.ajax.RemotePublishAjaxAction/cmd/pushBundle?assetIdentifier={{bundleId}}&iWantTo=publish&whoToSend={{environmentId}}&remotePublishDate=2020-09-10&remotePublishTime=17-14",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"DotAjaxDirector",
										"com.dotcms.publisher.ajax.RemotePublishAjaxAction",
										"cmd",
										"pushBundle"
									],
									"query": [
										{
											"key": "assetIdentifier",
											"value": "{{bundleId}}"
										},
										{
											"key": "iWantTo",
											"value": "publish"
										},
										{
											"key": "whoToSend",
											"value": "{{environmentId}}"
										},
										{
											"key": "remotePublishDate",
											"value": "2020-09-10"
										},
										{
											"key": "remotePublishTime",
											"value": "17-14"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "check success status",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "19dd5b3f-814a-4442-9d96-f505f36d1c89",
										"exec": [
											"",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "c8dde6ca-320b-40bf-824a-aa17c8ec3fe8",
										"exec": [
											"pm.test(\"Bundle uploaded sucessfully\", function () {",
											"",
											"    checkBundleStatus = eval(pm.collectionVariables.get(\"checkBundleStatus\", checkBundleStatus.toString()));",
											"",
											"    pm.response.to.have.status(200);",
											"",
											"    checkBundleStatus(pm.response.text(), [\"endpointSuccess\"], \"check success status\");",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "basic",
									"basic": [
										{
											"key": "password",
											"value": "admin",
											"type": "string"
										},
										{
											"key": "username",
											"value": "admin@dotcms.com",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Origin",
										"type": "text",
										"value": "{{origin}}"
									}
								],
								"body": {
									"mode": "formdata",
									"formdata": []
								},
								"url": {
									"raw": "{{serverURL}}/html/portlet/ext/contentlet/publishing/view_publish_audit_detail.jsp?bundle={{bundleId}}",
									"host": [
										"{{serverURL}}"
									],
									"path": [
										"html",
										"portlet",
										"ext",
										"contentlet",
										"publishing",
										"view_publish_audit_detail.jsp"
									],
									"query": [
										{
											"key": "bundle",
											"value": "{{bundleId}}"
										}
									]
								}
							},
							"response": []
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				}
			],
			"protocolProfileBehavior": {}
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"id": "5938650b-422d-4d28-a127-012e66327ffb",
				"type": "text/javascript",
				"exec": [
					"checkBundleStatus = (responseBody, casesToTest, requestToRepeat) => {",
					"    console.log(responseBody.trim().length, responseBody.trim().length === 0);",
					"    if (responseBody.trim().length === 0){",
					"        console.log('AGAIN 1');",
					"        postman.setNextRequest(requestToRepeat);",
					"    } else {",
					"",
					"        const $ = cheerio.load(responseBody);",
					"",
					"        bundleWaitingPublish = pm.collectionVariables.get(\"bundleWaitingPublish\");",
					"        pendingStatus = pm.collectionVariables.get(\"pendingStatus\");",
					"        bundlingStatus = pm.collectionVariables.get(\"bundlingStatus\");",
					"        noResultFound = pm.collectionVariables.get(\"noResultFound\");",
					"        publishingBundle = pm.collectionVariables.get(\"publishingBundle\");",
					"        bundleReceived = pm.collectionVariables.get(\"bundleReceived\");",
					"",
					"        htmlWithoutSpace = $.html().replace(/(\\r\\n|\\n|\\r)/gm, \"\");",
					"",
					"        if (htmlWithoutSpace.includes(bundleWaitingPublish) || htmlWithoutSpace.includes(pendingStatus) || htmlWithoutSpace.includes(bundlingStatus) || htmlWithoutSpace.includes(noResultFound) || htmlWithoutSpace.includes(publishingBundle) || htmlWithoutSpace.includes(bundleReceived)) {",
					"            console.log('AGAIN');",
					"            postman.setNextRequest(\"check success status\");",
					"        } else {",
					"            casesToTest.forEach((caseToTest) => {",
					"                expectedInclude = pm.collectionVariables.get(caseToTest);",
					"                pm.expect(htmlWithoutSpace).to.contain(expectedInclude);",
					"            });",
					"",
					"        }",
					"    }",
					"};",
					"",
					"serverURL = pm.environment.get(\"serverURL\");",
					"",
					"console.log('hostName', serverURL);",
					"pm.collectionVariables.set(\"origin\", serverURL);",
					"",
					"pm.collectionVariables.set(\"checkBundleStatus\", checkBundleStatus.toString());",
					"",
					"wait = (ms) => {",
					"   var start = new Date().getTime();",
					"   var end = start;",
					"   while(end < start + ms) {",
					"     end = new Date().getTime();",
					"  }",
					"};",
					"",
					"pm.collectionVariables.set(\"wait\", wait.toString());",
					"",
					"bundleSuccess = \"<th>Status:</th>        <td> Success</td>    </tr>\";",
					"pm.collectionVariables.set(\"bundleSuccess\", bundleSuccess);",
					"",
					"endpointSuccess = 'Everything ok';",
					"pm.collectionVariables.set(\"endpointSuccess\", endpointSuccess);",
					"",
					"bundleFailed = \" <th>Status:</th>        <td> Failed to send to all environments</td>\";",
					"pm.collectionVariables.set(\"bundleFailed\", bundleFailed);",
					"",
					"endpointInvalidtoken = '<td valign=\"top\">Authentication error</td>\t\t\t\t        <td valign=\"top\">Invalid token</td>\t';",
					"pm.collectionVariables.set(\"endpointInvalidtoken\", endpointInvalidtoken);",
					"",
					"bundleWaitingPublish = \"<th>Status:</th>        <td> Waiting for Publishing</td>    </tr>\";",
					"pm.collectionVariables.set(\"bundleWaitingPublish\", bundleWaitingPublish);",
					"",
					"pendingStatus = \"th>Status:</th>        <td> Pending</td\";",
					"pm.collectionVariables.set(\"pendingStatus\", pendingStatus);",
					"",
					"",
					"bundlingStatus = \"th>Status:</th>        <td> Bundling</td\";",
					"pm.collectionVariables.set(\"bundlingStatus\", bundlingStatus);",
					"",
					"noResultFound = \"No results found\";",
					"",
					"pm.collectionVariables.set(\"noResultFound\", noResultFound);",
					"",
					"publishingBundle = \"Publishing bundle\";",
					"pm.collectionVariables.set(\"publishingBundle\", publishingBundle);",
					"",
					"bundleReceived = \"Bundle Received\";",
					"pm.collectionVariables.set(\"bundleReceived\", bundleReceived);",
					"",
					"",
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"id": "82216258-8d43-4d44-b5ea-4b0cd188d9fb",
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"id": "911a500b-b210-451a-9805-26597e35ab75",
			"key": "origin",
			"value": "http://localhost:8080"
		},
		{
			"id": "f71a28c5-22cd-4e88-8663-0502898564f0",
			"key": "environmentName",
			"value": "environment-353"
		},
		{
			"id": "90fb0915-0e61-41a5-8d94-73c7ab5147e4",
			"key": "endpointName",
			"value": "endpoint-496"
		},
		{
			"id": "c56799ea-4b11-48a7-a477-ed99f6184094",
			"key": "environmentId",
			"value": "a4d2cc7a-1566-4b0d-9c31-b22d84814506"
		},
		{
			"id": "6e55f1a7-6932-4993-a2b7-e79cee3b2b7c",
			"key": "receiverName",
			"value": "receiverName-976"
		},
		{
			"id": "df7e4a53-662a-4a3c-b937-0ba32f600074",
			"key": "bundleName",
			"value": "bundleName-461"
		},
		{
			"id": "71bfc8d8-5269-4a1d-a164-b7ca4fa37f7f",
			"key": "bundleID",
			"value": null
		},
		{
			"id": "bd4ab460-c243-4327-95fe-182917635cc1",
			"key": "bundleId",
			"value": "01EK0WTHC89J1KJKSD1SY418QQ"
		},
		{
			"id": "bb3cb2f4-dff9-48e1-a2ec-92c88425dbdf",
			"key": "token",
			"value": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhcGk5MGY5MzgwZS03MGE0LTRlYmMtOGQ1Yy1hYjY2ZTc2NjI2NjkiLCJ4bW9kIjoxNjAwODk1ODY1MDAwLCJuYmYiOjE2MDA4OTU4NjUsImlzcyI6Ijc1MzI4OGMwODYiLCJsYWJlbCI6InRlc3RpbmciLCJleHAiOjE2OTU0NjcyMzAsImlhdCI6MTYwMDg5NTg2NSwianRpIjoiNmNjOTUxYzctMTIyNi00NzkxLTk4NzMtNDA1OTdjMWNhM2VmIn0.DNcI9_MIorM1HVWN3dERS5TAfjY72DfxQlhZ7s6lcik"
		},
		{
			"id": "3ffa053a-a968-4260-ad99-a2b5f9dc6504",
			"key": "bundleSuccessExpected",
			"value": "<tr>        <th>Title</th>        <td>                            <b><span>ea533f67-4883-42bb-9701-83293e7313e5</span></b> (contentlet)                                </td>    </tr>    <tr>        <th>Status:</th>        <td> Success</td>    </tr>"
		},
		{
			"id": "8e4d8952-e713-443e-9a78-6feb4f5c94d2",
			"key": "bundleFailedExpected",
			"value": " <th>Status:</th>        <td> Failed to send to all environments</td>"
		},
		{
			"id": "16c86aae-e9c7-40eb-af17-74f252d66cbb",
			"key": "endpointInvalidtoken",
			"value": "<td valign=\"top\">Authentication error</td>\t\t\t\t        <td valign=\"top\">Invalid token</td>\t"
		},
		{
			"id": "a423ef3b-a657-4df7-8e55-5a3d2625d3e0",
			"key": "endpointSuccess",
			"value": "<td valign=\"top\">Success</td>\t\t\t\t        <td valign=\"top\">Everything ok</td>"
		},
		{
			"id": "7e156e73-18f1-4607-80e0-e2eecf6c1cab",
			"key": "bundleFailed",
			"value": " <th>Status:</th>        <td> Failed to send to all environments</td>"
		},
		{
			"id": "04f2c0a9-24f2-462d-a969-803eb42364a9",
			"key": "bundleSuccess",
			"value": "<th>Status:</th>        <td> Success</td>    </tr>"
		},
		{
			"id": "4ed694b5-9c16-4acb-857f-9a9a9f40ecbb",
			"key": "bundleWaitingPublish",
			"value": "<th>Status:</th>        <td> Waiting for Publishing</td>    </tr>"
		},
		{
			"id": "8d8115fb-4b56-4f3d-9a76-2ecaaf71ca45",
			"key": "checkBundleStatus",
			"value": "(responseBody, casesToTest, requestToRepeat) => {\n    console.log(responseBody.trim().length, responseBody.trim().length === 0);\n    if (responseBody.trim().length === 0){\n        console.log('AGAIN 1');\n        postman.setNextRequest(requestToRepeat);\n    } else {\n\n        const $ = cheerio.load(responseBody);\n\n        bundleWaitingPublish = pm.collectionVariables.get(\"bundleWaitingPublish\");\n        htmlWithoutSpace = $.html().replace(/(\\r\\n|\\n|\\r)/gm, \"\");\n\n        if (htmlWithoutSpace.includes(bundleWaitingPublish)) {\n            console.log('AGAIN');\n            postman.setNextRequest(\"check success status\");\n        } else {\n            casesToTest.forEach((caseToTest) => {\n                expectedInclude = pm.collectionVariables.get(caseToTest);\n                pm.expect(htmlWithoutSpace).to.contain(expectedInclude);\n            });\n\n        }\n    }\n}"
		},
		{
			"id": "dd817701-4989-45b9-b9a1-194c4daa9abf",
			"key": "wait",
			"value": "(ms) => {\n   var start = new Date().getTime();\n   var end = start;\n   while(end < start + ms) {\n     end = new Date().getTime();\n  }\n}"
		}
	],
	"protocolProfileBehavior": {}
}