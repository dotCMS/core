{
	"info": {
		"_postman_id": "d9186044-2c7d-43da-9b36-c5d61bc117f8",
		"name": "Integrity Checker From Sender",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Generate ",
			"item": [
				{
					"name": "old Way",
					"item": [
						{
							"name": "Happy path",
							"item": [
								{
									"name": "set USE_JWT_TOKEN_IN_PUSH_PUBLISH to false",
									"request": {
										"auth": {
											"type": "basic",
											"basic": [
												{
													"key": "password",
													"value": "admin",
													"type": "string"
												},
												{
													"key": "username",
													"value": "admin@dotcms.com",
													"type": "string"
												}
											]
										},
										"method": "PUT",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"USE_JWT_TOKEN_IN_PUSH_PUBLISH\": false\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{serverURL}}/api//v1/configuration",
											"host": [
												"{{serverURL}}"
											],
											"path": [
												"api",
												"",
												"v1",
												"configuration"
											]
										}
									},
									"response": []
								},
								{
									"name": "create environment",
									"event": [
										{
											"listen": "prerequest",
											"script": {
												"id": "f59bd6d5-aea2-42ca-b012-1eddd617fb01",
												"exec": [
													"",
													"environmentName = 'environment-' + new Date().getMilliseconds();",
													"pm.collectionVariables.set(\"environmentName\", environmentName);",
													""
												],
												"type": "text/javascript"
											}
										},
										{
											"listen": "test",
											"script": {
												"id": "95917d0c-e4dd-407f-993f-7e6c2e85e204",
												"exec": [
													"pm.test(\"Status code is 200\", function () {",
													"    pm.response.to.have.status(200);",
													"",
													"    var environmentId = pm.response.text();",
													"    pm.collectionVariables.set(\"environmentId\", environmentId);",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "basic",
											"basic": [
												{
													"key": "password",
													"value": "admin",
													"type": "string"
												},
												{
													"key": "username",
													"value": "admin@dotcms.com",
													"type": "string"
												}
											]
										},
										"method": "POST",
										"header": [
											{
												"key": "Origin",
												"value": "{{origin}}",
												"type": "text"
											}
										],
										"body": {
											"mode": "formdata",
											"formdata": []
										},
										"url": {
											"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.environment.ajax.EnvironmentAjaxAction/cmd/addEnvironment?environmentName={{environmentName}}&pushType=pushToOne&whoCanUseSelect=e7d4e34e-5127-45fc-8123-d48b62d510e3&whoCanUse=e7d4e34e-5127-45fc-8123-d48b62d510e3",
											"host": [
												"{{serverURL}}"
											],
											"path": [
												"DotAjaxDirector",
												"com.dotcms.publisher.environment.ajax.EnvironmentAjaxAction",
												"cmd",
												"addEnvironment"
											],
											"query": [
												{
													"key": "environmentName",
													"value": "{{environmentName}}"
												},
												{
													"key": "pushType",
													"value": "pushToOne"
												},
												{
													"key": "whoCanUseSelect",
													"value": "e7d4e34e-5127-45fc-8123-d48b62d510e3"
												},
												{
													"key": "whoCanUse",
													"value": "e7d4e34e-5127-45fc-8123-d48b62d510e3"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "create end point",
									"event": [
										{
											"listen": "prerequest",
											"script": {
												"id": "30f821d2-fb78-4146-87ee-3ac0fcb130fe",
												"exec": [
													"endpointName = 'endpoint-' + new Date().getMilliseconds();",
													"pm.collectionVariables.set(\"endpointName\", endpointName);",
													""
												],
												"type": "text/javascript"
											}
										},
										{
											"listen": "test",
											"script": {
												"id": "aeb2f33e-7ad5-47c2-a35e-0fdd8a22bb4d",
												"exec": [
													"pm.test(\"Status code is 200\", function () {",
													"    pm.response.to.have.status(200);",
													"",
													"    var environmentId = pm.response.text();",
													"    pm.collectionVariables.set(\"endpintId\", environmentId);",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "basic",
											"basic": [
												{
													"key": "password",
													"value": "admin",
													"type": "string"
												},
												{
													"key": "username",
													"value": "admin@dotcms.com",
													"type": "string"
												}
											]
										},
										"method": "POST",
										"header": [
											{
												"key": "Origin",
												"type": "text",
												"value": "{{origin}}"
											}
										],
										"body": {
											"mode": "formdata",
											"formdata": []
										},
										"url": {
											"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction/cmd/addEndpoint?sending=false&serverName={{endpointName}}&environmentId={{environmentId}}&protocol=http&address=localhost&port=8080&authKey=123&enabled=on",
											"host": [
												"{{serverURL}}"
											],
											"path": [
												"DotAjaxDirector",
												"com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction",
												"cmd",
												"addEndpoint"
											],
											"query": [
												{
													"key": "sending",
													"value": "false"
												},
												{
													"key": "serverName",
													"value": "{{endpointName}}"
												},
												{
													"key": "environmentId",
													"value": "{{environmentId}}"
												},
												{
													"key": "protocol",
													"value": "http"
												},
												{
													"key": "address",
													"value": "localhost"
												},
												{
													"key": "port",
													"value": "8080"
												},
												{
													"key": "authKey",
													"value": "123"
												},
												{
													"key": "enabled",
													"value": "on"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "create receiver",
									"event": [
										{
											"listen": "prerequest",
											"script": {
												"id": "640dc23b-bc99-4026-91a4-2ac8ffd7850a",
												"exec": [
													"receiverName = 'receiverName-' + new Date().getMilliseconds();",
													"pm.collectionVariables.set(\"receiverName\", receiverName);",
													""
												],
												"type": "text/javascript"
											}
										},
										{
											"listen": "test",
											"script": {
												"id": "750dad47-cf8b-48ed-8f09-3a6633ffbb5b",
												"exec": [
													"pm.test(\"Status code is 200\", function () {",
													"    pm.response.to.have.status(200);",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "basic",
											"basic": [
												{
													"key": "password",
													"value": "admin",
													"type": "string"
												},
												{
													"key": "username",
													"value": "admin@dotcms.com",
													"type": "string"
												}
											]
										},
										"method": "POST",
										"header": [
											{
												"key": "Origin",
												"type": "text",
												"value": "{{origin}}"
											}
										],
										"body": {
											"mode": "formdata",
											"formdata": []
										},
										"url": {
											"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction/cmd/addEndpoint?sending=true&serverName={{receiverName}}&environmentId={{environmentId}}&address=localhost&authKey=123&enabled=on",
											"host": [
												"{{serverURL}}"
											],
											"path": [
												"DotAjaxDirector",
												"com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction",
												"cmd",
												"addEndpoint"
											],
											"query": [
												{
													"key": "sending",
													"value": "true"
												},
												{
													"key": "serverName",
													"value": "{{receiverName}}"
												},
												{
													"key": "environmentId",
													"value": "{{environmentId}}"
												},
												{
													"key": "address",
													"value": "localhost"
												},
												{
													"key": "authKey",
													"value": "123"
												},
												{
													"key": "enabled",
													"value": "on"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "generate Integrity Checker",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "7242a034-91c2-4421-8204-192c8133cb98",
												"exec": [
													"pm.test(\"Status code is 200\", function () {",
													"    pm.response.to.have.status(200);",
													"",
													"    response = pm.response.json();",
													"",
													"    pm.expect(response['success']).to.equals(true, );",
													"    pm.expect(response['message']).to.equals(\"Integrity Checking Initialized...\");",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "basic",
											"basic": [
												{
													"key": "password",
													"value": "admin",
													"type": "string"
												},
												{
													"key": "username",
													"value": "admin@dotcms.com",
													"type": "string"
												}
											]
										},
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{serverURL}}/api/integrity/checkintegrity/endpoint/{{endpintId}}",
											"host": [
												"{{serverURL}}"
											],
											"path": [
												"api",
												"integrity",
												"checkintegrity",
												"endpoint",
												"{{endpintId}}"
											]
										}
									},
									"response": []
								},
								{
									"name": "set USE_JWT_TOKEN_IN_PUSH_PUBLISH to true",
									"request": {
										"auth": {
											"type": "basic",
											"basic": [
												{
													"key": "password",
													"value": "admin",
													"type": "string"
												},
												{
													"key": "username",
													"value": "admin@dotcms.com",
													"type": "string"
												}
											]
										},
										"method": "PUT",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"USE_JWT_TOKEN_IN_PUSH_PUBLISH\": true\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{serverURL}}/api//v1/configuration",
											"host": [
												"{{serverURL}}"
											],
											"path": [
												"api",
												"",
												"v1",
												"configuration"
											]
										}
									},
									"response": []
								},
								{
									"name": "{{serverURL}}/api/v1/apitoken",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "9b8025aa-02cd-4889-85dc-fe4fdf9049f2",
												"exec": [
													"pm.test(\"Status code is 200\", function () {",
													"    pm.response.to.have.status(200);",
													"",
													"    var jsonData = pm.response.json();",
													"    pm.expect(jsonData.errors.length).to.eql(0);",
													"    pm.expect(jsonData.entity).to.not.eq(undefined);",
													"    pm.expect(jsonData.entity.jwt).to.not.eq(undefined);",
													"    pm.collectionVariables.set(\"token\", jsonData.entity.jwt);",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "basic",
											"basic": [
												{
													"key": "password",
													"value": "admin",
													"type": "string"
												},
												{
													"key": "username",
													"value": "admin@dotcms.com",
													"type": "string"
												}
											]
										},
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"claims\": {\n        \"label\": \"testing\"\n    },\n    \"expirationSeconds\": 1,\n    \"network\": \"0.0.0.0/0\",\n    \"userId\": \"dotcms.org.1\"\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{serverURL}}/api/v1/apitoken",
											"host": [
												"{{serverURL}}"
											],
											"path": [
												"api",
												"v1",
												"apitoken"
											]
										}
									},
									"response": []
								}
							],
							"protocolProfileBehavior": {},
							"_postman_isSubFolder": true
						},
						{
							"name": "invalid token",
							"item": [
								{
									"name": "set USE_JWT_TOKEN_IN_PUSH_PUBLISH to false",
									"request": {
										"auth": {
											"type": "basic",
											"basic": [
												{
													"key": "password",
													"value": "admin",
													"type": "string"
												},
												{
													"key": "username",
													"value": "admin@dotcms.com",
													"type": "string"
												}
											]
										},
										"method": "PUT",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"USE_JWT_TOKEN_IN_PUSH_PUBLISH\": false\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{serverURL}}/api//v1/configuration",
											"host": [
												"{{serverURL}}"
											],
											"path": [
												"api",
												"",
												"v1",
												"configuration"
											]
										}
									},
									"response": []
								},
								{
									"name": "create environment",
									"event": [
										{
											"listen": "prerequest",
											"script": {
												"id": "63bdf766-b69a-44cb-a1b7-8cfb2df5a39f",
												"exec": [
													"",
													"environmentName = 'environment-' + new Date().getMilliseconds();",
													"pm.collectionVariables.set(\"environmentName\", environmentName);",
													""
												],
												"type": "text/javascript"
											}
										},
										{
											"listen": "test",
											"script": {
												"id": "19f2a763-fd67-4140-80c1-6b77b63967c7",
												"exec": [
													"pm.test(\"Status code is 200\", function () {",
													"    pm.response.to.have.status(200);",
													"",
													"    var environmentId = pm.response.text();",
													"    pm.collectionVariables.set(\"environmentId\", environmentId);",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "basic",
											"basic": [
												{
													"key": "password",
													"value": "admin",
													"type": "string"
												},
												{
													"key": "username",
													"value": "admin@dotcms.com",
													"type": "string"
												}
											]
										},
										"method": "POST",
										"header": [
											{
												"key": "Origin",
												"value": "{{origin}}",
												"type": "text"
											}
										],
										"body": {
											"mode": "formdata",
											"formdata": []
										},
										"url": {
											"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.environment.ajax.EnvironmentAjaxAction/cmd/addEnvironment?environmentName={{environmentName}}&pushType=pushToOne&whoCanUseSelect=e7d4e34e-5127-45fc-8123-d48b62d510e3&whoCanUse=e7d4e34e-5127-45fc-8123-d48b62d510e3",
											"host": [
												"{{serverURL}}"
											],
											"path": [
												"DotAjaxDirector",
												"com.dotcms.publisher.environment.ajax.EnvironmentAjaxAction",
												"cmd",
												"addEnvironment"
											],
											"query": [
												{
													"key": "environmentName",
													"value": "{{environmentName}}"
												},
												{
													"key": "pushType",
													"value": "pushToOne"
												},
												{
													"key": "whoCanUseSelect",
													"value": "e7d4e34e-5127-45fc-8123-d48b62d510e3"
												},
												{
													"key": "whoCanUse",
													"value": "e7d4e34e-5127-45fc-8123-d48b62d510e3"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "create end point",
									"event": [
										{
											"listen": "prerequest",
											"script": {
												"id": "8741012e-9b75-4c24-a377-d7280e26e24c",
												"exec": [
													"endpointName = 'endpoint-' + new Date().getMilliseconds();",
													"pm.collectionVariables.set(\"endpointName\", endpointName);",
													""
												],
												"type": "text/javascript"
											}
										},
										{
											"listen": "test",
											"script": {
												"id": "01a60b8d-2de8-4b88-b1e9-016eee8b0cc8",
												"exec": [
													"pm.test(\"Status code is 200\", function () {",
													"    pm.response.to.have.status(200);",
													"",
													"    var environmentId = pm.response.text();",
													"    pm.collectionVariables.set(\"endpintId\", environmentId);",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "basic",
											"basic": [
												{
													"key": "password",
													"value": "admin",
													"type": "string"
												},
												{
													"key": "username",
													"value": "admin@dotcms.com",
													"type": "string"
												}
											]
										},
										"method": "POST",
										"header": [
											{
												"key": "Origin",
												"type": "text",
												"value": "{{origin}}"
											}
										],
										"body": {
											"mode": "formdata",
											"formdata": []
										},
										"url": {
											"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction/cmd/addEndpoint?sending=false&serverName={{endpointName}}&environmentId={{environmentId}}&protocol=http&address=localhost&port=8080&authKey=invalid&enabled=on",
											"host": [
												"{{serverURL}}"
											],
											"path": [
												"DotAjaxDirector",
												"com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction",
												"cmd",
												"addEndpoint"
											],
											"query": [
												{
													"key": "sending",
													"value": "false"
												},
												{
													"key": "serverName",
													"value": "{{endpointName}}"
												},
												{
													"key": "environmentId",
													"value": "{{environmentId}}"
												},
												{
													"key": "protocol",
													"value": "http"
												},
												{
													"key": "address",
													"value": "localhost"
												},
												{
													"key": "port",
													"value": "8080"
												},
												{
													"key": "authKey",
													"value": "invalid"
												},
												{
													"key": "enabled",
													"value": "on"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "generate Integrity Checker",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "6364fb25-f39f-4ced-836c-0d7160482b4d",
												"exec": [
													"pm.test(\"Status code is 200\", function () {",
													"    pm.response.to.have.status(401);",
													"    endPoint = pm.collectionVariables.get(\"endpintId\");",
													"    pm.expect(pm.response.text()).to.equals(\"Invalid token Response indicating Not Authorized received from Endpoint. Please check Auth Token. Endpoint Id: \" + endPoint);",
													"",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "basic",
											"basic": [
												{
													"key": "password",
													"value": "admin",
													"type": "string"
												},
												{
													"key": "username",
													"value": "admin@dotcms.com",
													"type": "string"
												}
											]
										},
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{serverURL}}/api/integrity/checkintegrity/endpoint/{{endpintId}}",
											"host": [
												"{{serverURL}}"
											],
											"path": [
												"api",
												"integrity",
												"checkintegrity",
												"endpoint",
												"{{endpintId}}"
											]
										}
									},
									"response": []
								},
								{
									"name": "set USE_JWT_TOKEN_IN_PUSH_PUBLISH to true",
									"request": {
										"auth": {
											"type": "basic",
											"basic": [
												{
													"key": "password",
													"value": "admin",
													"type": "string"
												},
												{
													"key": "username",
													"value": "admin@dotcms.com",
													"type": "string"
												}
											]
										},
										"method": "PUT",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"USE_JWT_TOKEN_IN_PUSH_PUBLISH\": true\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{serverURL}}/api//v1/configuration",
											"host": [
												"{{serverURL}}"
											],
											"path": [
												"api",
												"",
												"v1",
												"configuration"
											]
										}
									},
									"response": []
								}
							],
							"protocolProfileBehavior": {},
							"_postman_isSubFolder": true
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				},
				{
					"name": "using JWT",
					"item": [
						{
							"name": "Happy path",
							"item": [
								{
									"name": "request_token",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "fb866d8e-21b6-4705-9b6b-4dc556645053",
												"exec": [
													"pm.test(\"Status code is 200\", function () {",
													"    pm.response.to.have.status(200);",
													"",
													"    var jsonData = pm.response.json();",
													"    pm.expect(jsonData.errors.length).to.eql(0);",
													"    pm.expect(jsonData.entity).to.not.eq(undefined);",
													"    pm.expect(jsonData.entity.jwt).to.not.eq(undefined);",
													"    pm.collectionVariables.set(\"token\", jsonData.entity.jwt);",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "basic",
											"basic": [
												{
													"key": "password",
													"value": "admin",
													"type": "string"
												},
												{
													"key": "username",
													"value": "admin@dotcms.com",
													"type": "string"
												}
											]
										},
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"claims\": {\n        \"label\": \"testing\"\n    },\n    \"expirationSeconds\": 94571365,\n    \"network\": \"0.0.0.0/0\",\n    \"userId\": \"dotcms.org.1\"\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{serverURL}}/api/v1/apitoken",
											"host": [
												"{{serverURL}}"
											],
											"path": [
												"api",
												"v1",
												"apitoken"
											]
										}
									},
									"response": []
								},
								{
									"name": "create environment",
									"event": [
										{
											"listen": "prerequest",
											"script": {
												"id": "9217c52c-4bd9-4a59-907a-dd8040db90cb",
												"exec": [
													"",
													"environmentName = 'environment-' + new Date().getMilliseconds();",
													"pm.collectionVariables.set(\"environmentName\", environmentName);",
													""
												],
												"type": "text/javascript"
											}
										},
										{
											"listen": "test",
											"script": {
												"id": "587ce869-eecf-4a3c-8886-0bcb57c110ce",
												"exec": [
													"pm.test(\"Status code is 200\", function () {",
													"    pm.response.to.have.status(200);",
													"",
													"    var environmentId = pm.response.text();",
													"    pm.collectionVariables.set(\"environmentId\", environmentId);",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "basic",
											"basic": [
												{
													"key": "password",
													"value": "admin",
													"type": "string"
												},
												{
													"key": "username",
													"value": "admin@dotcms.com",
													"type": "string"
												}
											]
										},
										"method": "POST",
										"header": [
											{
												"key": "Origin",
												"value": "{{origin}}",
												"type": "text"
											}
										],
										"body": {
											"mode": "formdata",
											"formdata": []
										},
										"url": {
											"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.environment.ajax.EnvironmentAjaxAction/cmd/addEnvironment?environmentName={{environmentName}}&pushType=pushToOne&whoCanUseSelect=e7d4e34e-5127-45fc-8123-d48b62d510e3&whoCanUse=e7d4e34e-5127-45fc-8123-d48b62d510e3",
											"host": [
												"{{serverURL}}"
											],
											"path": [
												"DotAjaxDirector",
												"com.dotcms.publisher.environment.ajax.EnvironmentAjaxAction",
												"cmd",
												"addEnvironment"
											],
											"query": [
												{
													"key": "environmentName",
													"value": "{{environmentName}}"
												},
												{
													"key": "pushType",
													"value": "pushToOne"
												},
												{
													"key": "whoCanUseSelect",
													"value": "e7d4e34e-5127-45fc-8123-d48b62d510e3"
												},
												{
													"key": "whoCanUse",
													"value": "e7d4e34e-5127-45fc-8123-d48b62d510e3"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "create end point",
									"event": [
										{
											"listen": "prerequest",
											"script": {
												"id": "3d062e07-e2b7-412a-8608-f4584a2d8953",
												"exec": [
													"endpointName = 'endpoint-' + new Date().getMilliseconds();",
													"pm.collectionVariables.set(\"endpointName\", endpointName);",
													""
												],
												"type": "text/javascript"
											}
										},
										{
											"listen": "test",
											"script": {
												"id": "c9f2fe90-c6b6-48e9-ad7d-2a056e9b442e",
												"exec": [
													"pm.test(\"Status code is 200\", function () {",
													"    pm.response.to.have.status(200);",
													"",
													"    var environmentId = pm.response.text();",
													"    pm.collectionVariables.set(\"endpintId\", environmentId);",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "basic",
											"basic": [
												{
													"key": "password",
													"value": "admin",
													"type": "string"
												},
												{
													"key": "username",
													"value": "admin@dotcms.com",
													"type": "string"
												}
											]
										},
										"method": "POST",
										"header": [
											{
												"key": "Origin",
												"type": "text",
												"value": "{{origin}}"
											}
										],
										"body": {
											"mode": "formdata",
											"formdata": []
										},
										"url": {
											"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction/cmd/addEndpoint?sending=false&serverName={{endpointName}}&environmentId={{environmentId}}&protocol=http&address=localhost&port=8080&authKey={{token}}&enabled=on",
											"host": [
												"{{serverURL}}"
											],
											"path": [
												"DotAjaxDirector",
												"com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction",
												"cmd",
												"addEndpoint"
											],
											"query": [
												{
													"key": "sending",
													"value": "false"
												},
												{
													"key": "serverName",
													"value": "{{endpointName}}"
												},
												{
													"key": "environmentId",
													"value": "{{environmentId}}"
												},
												{
													"key": "protocol",
													"value": "http"
												},
												{
													"key": "address",
													"value": "localhost"
												},
												{
													"key": "port",
													"value": "8080"
												},
												{
													"key": "authKey",
													"value": "{{token}}"
												},
												{
													"key": "enabled",
													"value": "on"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "generate Integrity Checker",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "51e9a31a-e00d-49ef-a686-57c85e4345f7",
												"exec": [
													"pm.test(\"Status code is 200\", function () {",
													"    pm.response.to.have.status(200);",
													"",
													"    response = pm.response.json();",
													"",
													"    pm.expect(response['success']).to.equals(true, );",
													"    pm.expect(response['message']).to.equals(\"Integrity Checking Initialized...\");",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{token}}",
													"type": "string"
												}
											]
										},
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{serverURL}}/api/integrity/checkintegrity/endpoint/{{endpintId}}",
											"host": [
												"{{serverURL}}"
											],
											"path": [
												"api",
												"integrity",
												"checkintegrity",
												"endpoint",
												"{{endpintId}}"
											]
										}
									},
									"response": []
								}
							],
							"protocolProfileBehavior": {},
							"_postman_isSubFolder": true
						},
						{
							"name": "Invalid Token",
							"item": [
								{
									"name": "create environment",
									"event": [
										{
											"listen": "prerequest",
											"script": {
												"id": "f79d7369-d8d6-4c4d-9073-dfab9693e126",
												"exec": [
													"",
													"environmentName = 'environment-' + new Date().getMilliseconds();",
													"pm.collectionVariables.set(\"environmentName\", environmentName);",
													""
												],
												"type": "text/javascript"
											}
										},
										{
											"listen": "test",
											"script": {
												"id": "15b4bcd1-3fdb-440a-8045-4e0bb994f046",
												"exec": [
													"pm.test(\"Status code is 200\", function () {",
													"    pm.response.to.have.status(200);",
													"",
													"    var environmentId = pm.response.text();",
													"    pm.collectionVariables.set(\"environmentId\", environmentId);",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "basic",
											"basic": [
												{
													"key": "password",
													"value": "admin",
													"type": "string"
												},
												{
													"key": "username",
													"value": "admin@dotcms.com",
													"type": "string"
												}
											]
										},
										"method": "POST",
										"header": [
											{
												"key": "Origin",
												"value": "{{origin}}",
												"type": "text"
											}
										],
										"body": {
											"mode": "formdata",
											"formdata": []
										},
										"url": {
											"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.environment.ajax.EnvironmentAjaxAction/cmd/addEnvironment?environmentName={{environmentName}}&pushType=pushToOne&whoCanUseSelect=e7d4e34e-5127-45fc-8123-d48b62d510e3&whoCanUse=e7d4e34e-5127-45fc-8123-d48b62d510e3",
											"host": [
												"{{serverURL}}"
											],
											"path": [
												"DotAjaxDirector",
												"com.dotcms.publisher.environment.ajax.EnvironmentAjaxAction",
												"cmd",
												"addEnvironment"
											],
											"query": [
												{
													"key": "environmentName",
													"value": "{{environmentName}}"
												},
												{
													"key": "pushType",
													"value": "pushToOne"
												},
												{
													"key": "whoCanUseSelect",
													"value": "e7d4e34e-5127-45fc-8123-d48b62d510e3"
												},
												{
													"key": "whoCanUse",
													"value": "e7d4e34e-5127-45fc-8123-d48b62d510e3"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "create end point",
									"event": [
										{
											"listen": "prerequest",
											"script": {
												"id": "b7d21191-2d68-49c0-bcd9-61e7f38a9942",
												"exec": [
													"endpointName = 'endpoint-' + new Date().getMilliseconds();",
													"pm.collectionVariables.set(\"endpointName\", endpointName);",
													""
												],
												"type": "text/javascript"
											}
										},
										{
											"listen": "test",
											"script": {
												"id": "c7e6a190-9800-4fc9-958a-0995e79a781a",
												"exec": [
													"pm.test(\"Status code is 200\", function () {",
													"    pm.response.to.have.status(200);",
													"",
													"    var environmentId = pm.response.text();",
													"    pm.collectionVariables.set(\"endpintId\", environmentId);",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "basic",
											"basic": [
												{
													"key": "password",
													"value": "admin",
													"type": "string"
												},
												{
													"key": "username",
													"value": "admin@dotcms.com",
													"type": "string"
												}
											]
										},
										"method": "POST",
										"header": [
											{
												"key": "Origin",
												"type": "text",
												"value": "{{origin}}"
											}
										],
										"body": {
											"mode": "formdata",
											"formdata": []
										},
										"url": {
											"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction/cmd/addEndpoint?sending=false&serverName={{endpointName}}&environmentId={{environmentId}}&protocol=http&address=localhost&port=8080&authKey=123&enabled=on",
											"host": [
												"{{serverURL}}"
											],
											"path": [
												"DotAjaxDirector",
												"com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction",
												"cmd",
												"addEndpoint"
											],
											"query": [
												{
													"key": "sending",
													"value": "false"
												},
												{
													"key": "serverName",
													"value": "{{endpointName}}"
												},
												{
													"key": "environmentId",
													"value": "{{environmentId}}"
												},
												{
													"key": "protocol",
													"value": "http"
												},
												{
													"key": "address",
													"value": "localhost"
												},
												{
													"key": "port",
													"value": "8080"
												},
												{
													"key": "authKey",
													"value": "123"
												},
												{
													"key": "enabled",
													"value": "on"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "logout",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "b2e3516f-6f0c-4d8d-9f8a-cb03335ed5b4",
												"exec": [
													"pm.test(\"Status code is 200\", function () {",
													"    pm.response.to.have.status(200);",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{serverURL}}/api/v1/logout",
											"host": [
												"{{serverURL}}"
											],
											"path": [
												"api",
												"v1",
												"logout"
											]
										}
									},
									"response": []
								},
								{
									"name": "Shoyld response with 401",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "08a4abe3-41c2-4ee4-8878-908a7cb6370b",
												"exec": [
													"pm.test(\"Status code is 200\", function () {",
													"    pm.response.to.have.status(401);",
													"",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "invalid_token",
													"type": "string"
												}
											]
										},
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{serverURL}}/api/integrity/checkintegrity/endpoint/{{endpintId}}",
											"host": [
												"{{serverURL}}"
											],
											"path": [
												"api",
												"integrity",
												"checkintegrity",
												"endpoint",
												"{{endpintId}}"
											]
										}
									},
									"response": []
								}
							],
							"protocolProfileBehavior": {},
							"_postman_isSubFolder": true
						},
						{
							"name": "experied Token",
							"item": [
								{
									"name": "request_token",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "f73745c5-f268-43df-9ed7-c96d1378d29f",
												"exec": [
													"pm.test(\"Status code is 200\", function () {",
													"    pm.response.to.have.status(200);",
													"",
													"    var jsonData = pm.response.json();",
													"    pm.expect(jsonData.errors.length).to.eql(0);",
													"    pm.expect(jsonData.entity).to.not.eq(undefined);",
													"    pm.expect(jsonData.entity.jwt).to.not.eq(undefined);",
													"    pm.collectionVariables.set(\"token\", jsonData.entity.jwt);",
													"",
													"    eval(pm.collectionVariables.get(\"wait\"))(2);",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "basic",
											"basic": [
												{
													"key": "password",
													"value": "admin",
													"type": "string"
												},
												{
													"key": "username",
													"value": "admin@dotcms.com",
													"type": "string"
												}
											]
										},
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"claims\": {\n        \"label\": \"testing\"\n    },\n    \"expirationSeconds\": 94571365,\n    \"network\": \"0.0.0.0/0\",\n    \"userId\": \"dotcms.org.1\"\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{serverURL}}/api/v1/apitoken",
											"host": [
												"{{serverURL}}"
											],
											"path": [
												"api",
												"v1",
												"apitoken"
											]
										}
									},
									"response": []
								},
								{
									"name": "create environment",
									"event": [
										{
											"listen": "prerequest",
											"script": {
												"id": "6be52b6f-21ae-4087-82f2-7b8a3b49127b",
												"exec": [
													"",
													"environmentName = 'environment-' + new Date().getMilliseconds();",
													"pm.collectionVariables.set(\"environmentName\", environmentName);",
													""
												],
												"type": "text/javascript"
											}
										},
										{
											"listen": "test",
											"script": {
												"id": "52fd9b75-6778-46dc-b497-918dd0d5d8dc",
												"exec": [
													"pm.test(\"Status code is 200\", function () {",
													"    pm.response.to.have.status(200);",
													"",
													"    var environmentId = pm.response.text();",
													"    pm.collectionVariables.set(\"environmentId\", environmentId);",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "basic",
											"basic": [
												{
													"key": "password",
													"value": "admin",
													"type": "string"
												},
												{
													"key": "username",
													"value": "admin@dotcms.com",
													"type": "string"
												}
											]
										},
										"method": "POST",
										"header": [
											{
												"key": "Origin",
												"value": "{{origin}}",
												"type": "text"
											}
										],
										"body": {
											"mode": "formdata",
											"formdata": []
										},
										"url": {
											"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.environment.ajax.EnvironmentAjaxAction/cmd/addEnvironment?environmentName={{environmentName}}&pushType=pushToOne&whoCanUseSelect=e7d4e34e-5127-45fc-8123-d48b62d510e3&whoCanUse=e7d4e34e-5127-45fc-8123-d48b62d510e3",
											"host": [
												"{{serverURL}}"
											],
											"path": [
												"DotAjaxDirector",
												"com.dotcms.publisher.environment.ajax.EnvironmentAjaxAction",
												"cmd",
												"addEnvironment"
											],
											"query": [
												{
													"key": "environmentName",
													"value": "{{environmentName}}"
												},
												{
													"key": "pushType",
													"value": "pushToOne"
												},
												{
													"key": "whoCanUseSelect",
													"value": "e7d4e34e-5127-45fc-8123-d48b62d510e3"
												},
												{
													"key": "whoCanUse",
													"value": "e7d4e34e-5127-45fc-8123-d48b62d510e3"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "create end point",
									"event": [
										{
											"listen": "prerequest",
											"script": {
												"id": "4ec96307-5fa7-42ba-8525-fceb6daf797d",
												"exec": [
													"endpointName = 'endpoint-' + new Date().getMilliseconds();",
													"pm.collectionVariables.set(\"endpointName\", endpointName);",
													""
												],
												"type": "text/javascript"
											}
										},
										{
											"listen": "test",
											"script": {
												"id": "77687e25-6845-4b1b-9ed1-cd4a750fb850",
												"exec": [
													"pm.test(\"Status code is 200\", function () {",
													"    pm.response.to.have.status(200);",
													"",
													"    var environmentId = pm.response.text();",
													"    pm.collectionVariables.set(\"endpintId\", environmentId);",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "basic",
											"basic": [
												{
													"key": "password",
													"value": "admin",
													"type": "string"
												},
												{
													"key": "username",
													"value": "admin@dotcms.com",
													"type": "string"
												}
											]
										},
										"method": "POST",
										"header": [
											{
												"key": "Origin",
												"type": "text",
												"value": "{{origin}}"
											}
										],
										"body": {
											"mode": "formdata",
											"formdata": []
										},
										"url": {
											"raw": "{{serverURL}}/DotAjaxDirector/com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction/cmd/addEndpoint?sending=false&serverName={{endpointName}}&environmentId={{environmentId}}&protocol=http&address=localhost&port=8080&authKey=123&enabled=on",
											"host": [
												"{{serverURL}}"
											],
											"path": [
												"DotAjaxDirector",
												"com.dotcms.publisher.endpoint.ajax.PublishingEndpointAjaxAction",
												"cmd",
												"addEndpoint"
											],
											"query": [
												{
													"key": "sending",
													"value": "false"
												},
												{
													"key": "serverName",
													"value": "{{endpointName}}"
												},
												{
													"key": "environmentId",
													"value": "{{environmentId}}"
												},
												{
													"key": "protocol",
													"value": "http"
												},
												{
													"key": "address",
													"value": "localhost"
												},
												{
													"key": "port",
													"value": "8080"
												},
												{
													"key": "authKey",
													"value": "123"
												},
												{
													"key": "enabled",
													"value": "on"
												}
											]
										}
									},
									"response": []
								},
								{
									"name": "logout",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "263e210e-6629-4e7f-bceb-c52f504e6f2c",
												"exec": [
													"pm.test(\"Status code is 200\", function () {",
													"    pm.response.to.have.status(200);",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{serverURL}}/api/v1/logout",
											"host": [
												"{{serverURL}}"
											],
											"path": [
												"api",
												"v1",
												"logout"
											]
										}
									},
									"response": []
								},
								{
									"name": "Shoyld response with 401",
									"event": [
										{
											"listen": "test",
											"script": {
												"id": "eb31be64-f609-470b-b8b1-54c66648896f",
												"exec": [
													"pm.test(\"Status code is 200\", function () {",
													"    pm.response.to.have.status(401);",
													"",
													"});"
												],
												"type": "text/javascript"
											}
										}
									],
									"request": {
										"auth": {
											"type": "bearer",
											"bearer": [
												{
													"key": "token",
													"value": "{{token}}",
													"type": "string"
												}
											]
										},
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{serverURL}}/api/integrity/checkintegrity/endpoint/{{endpintId}}",
											"host": [
												"{{serverURL}}"
											],
											"path": [
												"api",
												"integrity",
												"checkintegrity",
												"endpoint",
												"{{endpintId}}"
											]
										}
									},
									"response": []
								}
							],
							"protocolProfileBehavior": {},
							"_postman_isSubFolder": true
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				}
			],
			"protocolProfileBehavior": {}
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"id": "4a0c3478-ec3b-4cc9-93a3-269630d0e082",
				"type": "text/javascript",
				"exec": [
					"wait = (ms) => {",
					"   var start = new Date().getTime();",
					"   var end = start;",
					"   while(end < start + ms) {",
					"     end = new Date().getTime();",
					"  }",
					"};",
					"",
					"pm.collectionVariables.set(\"wait\", wait.toString());",
					"",
					"serverURL = pm.environment.get(\"serverURL\");",
					"",
					"console.log('hostName', serverURL);",
					"pm.collectionVariables.set(\"origin\", serverURL);"
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"id": "9c21dd52-e128-4aae-a5de-0f2fe089a4fd",
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"id": "a9899814-0138-4309-bfda-ae9ec6b30ad5",
			"key": "endpointName",
			"value": "endpoint-537"
		},
		{
			"id": "98b67fee-e1e9-43db-bcf8-8042ea495474",
			"key": "environmentName",
			"value": "environment-57"
		},
		{
			"id": "7f271169-fe6a-4f0f-8ffb-32a1053c29e7",
			"key": "origin",
			"value": "http://localhost:8080"
		},
		{
			"id": "0455a07e-d39b-4548-8e4c-9a900e5d34bd",
			"key": "environmentId",
			"value": "a100ed31-db50-4dd1-a56a-c8dbe6e95560"
		},
		{
			"id": "2cb1b4c4-344e-454d-8ae2-3a12c46d2372",
			"key": "endpintId",
			"value": "1737d79b-1877-4cfc-aa62-5124afada319"
		},
		{
			"id": "54905aae-dd97-4b00-9672-204caaa27884",
			"key": "receiverName",
			"value": "receiverName-443"
		},
		{
			"id": "83afd85f-02ec-405e-a3e5-53ef5c141ad0",
			"key": "token",
			"value": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhcGlhZTJjMmY2NS04MzdhLTQyMDYtOGMzOS1jMTEyM2I3MWViYTAiLCJ4bW9kIjoxNjAyMjcwMjU2MDAwLCJuYmYiOjE2MDIyNzAyNTYsImlzcyI6ImI2ZTc1ZTIyNzMiLCJsYWJlbCI6InRlc3RpbmciLCJleHAiOjE2OTY4NDE2MjEsImlhdCI6MTYwMjI3MDI1NiwianRpIjoiYjIzNjkyNjUtNzhjOC00ZTY3LTk3M2YtOWMyNDc5Y2U1M2FkIn0.ozJdF3x2rnmd4AwKkKXAmCtIHragPDTgUOTyIisVw_Q"
		},
		{
			"id": "c8368aee-0df2-4263-83cc-5c45e0125f9d",
			"key": "wait",
			"value": "(ms) => {\n   var start = new Date().getTime();\n   var end = start;\n   while(end < start + ms) {\n     end = new Date().getTime();\n  }\n}"
		}
	],
	"protocolProfileBehavior": {}
}