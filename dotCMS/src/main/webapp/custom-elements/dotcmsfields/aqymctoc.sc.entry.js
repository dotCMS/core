const t=window.dotcmsFields.h;import{a as e,h as a,c as s}from"./chunk-098a701f.js";import{a as i,b as o}from"./chunk-e7d75a7f.js";class l{constructor(){this.resetLabel="Reset",this.submitLabel="Submit",this.layout=[],this.status=e(),this.fieldsStatus={},this.value={}}onValueChange(t){const{tagName:e}=t.target,{name:a,value:s}=t.detail,i=o[e];this.value[a]=i?i(s):s}onStatusChange({detail:t}){this.fieldsStatus[t.name]=t.status,this.status=a(this.status,{dotTouched:this.getTouched(),dotPristine:this.getStatusValueByName("dotPristine"),dotValid:this.getStatusValueByName("dotValid")})}layoutWatch(){this.value=this.getUpdateValue()}fieldsToShowWatch(){this.value=this.getUpdateValue()}hostData(){return{class:s(this.status,this.status.dotValid)}}componentWillLoad(){this.value=this.getUpdateValue()}render(){return t("form",{onSubmit:this.handleSubmit.bind(this)},this.layout.map(e=>t("dot-form-row",{row:e,"fields-to-show":this.fieldsToShow})),t("div",{class:"dot-form__buttons"},t("button",{type:"reset",onClick:()=>this.resetForm()},this.resetLabel),t("button",{type:"submit",disabled:!this.status.dotValid},this.submitLabel)))}getStatusValueByName(t){return Object.values(this.fieldsStatus).map(e=>e[t]).every(t=>!0===t)}getTouched(){return Object.values(this.fieldsStatus).map(t=>t.dotTouched).includes(!0)}handleSubmit(t){t.preventDefault(),this.onSubmit.emit(Object.assign({},this.value))}resetForm(){Array.from(this.el.querySelectorAll("form dot-form-column > *")).forEach(t=>{try{t.reset()}catch(e){console.warn(`${t.tagName}`,e)}})}getUpdateValue(){return i(this.layout).reduce((t,{variable:e,defaultValue:a})=>Object.assign({},t,{[e]:a}),{})}static get is(){return"dot-form"}static get properties(){return{el:{elementRef:!0},fieldsToShow:{type:String,attr:"fields-to-show",watchCallbacks:["fieldsToShowWatch"]},layout:{type:"Any",attr:"layout",reflectToAttr:!0,mutable:!0,watchCallbacks:["layoutWatch"]},resetLabel:{type:String,attr:"reset-label",reflectToAttr:!0},status:{state:!0},submitLabel:{type:String,attr:"submit-label",reflectToAttr:!0}}}static get events(){return[{name:"onSubmit",method:"onSubmit",bubbles:!0,cancelable:!0,composed:!0}]}static get listeners(){return[{name:"valueChange",method:"onValueChange"},{name:"statusChange",method:"onStatusChange"}]}static get style(){return"dot-form{display:block}dot-form>form dot-form-column>*{display:block;margin:1rem 0}dot-form>form dot-form-column>:first-child{margin-top:0}dot-form>form dot-form-column>:last-child{margin-bottom:0}dot-form>form .dot-form__buttons{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-pack:end;justify-content:flex-end}dot-form>form .dot-form__buttons button:last-child{margin-left:1rem}"}}export{l as DotForm};