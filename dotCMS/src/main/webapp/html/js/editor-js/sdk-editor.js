var T=()=>new URLSearchParams(window.location.search).get("preview")==="true";function v(e){r({action:"edit-contentlet",payload:e})}function d(e,n){r({action:"init-inline-editing",payload:{type:e,data:n}})}function P(e){let{startLevel:n=1,depth:t=2}=e||{};r({action:"reorder-menu",payload:{startLevel:n,depth:t}})}function w(){return typeof window>"u"||T()?!1:window.parent!==window}function y(){window.dotUVE=l}function _(){document.querySelectorAll('[data-dot-object="contentlet"]').forEach(n=>{n.clientHeight||n.classList.add("empty-contentlet")})}var l={editContentlet:v,initInlineEditing:d,reorderMenu:P,lastScrollYPosition:0};function r(e){window.parent.postMessage(e,"*")}function M(e){return e.map(n=>{let t=n.getBoundingClientRect(),o=Array.from(n.querySelectorAll('[data-dot-object="contentlet"]'));return{x:t.x,y:t.y,width:t.width,height:t.height,payload:JSON.stringify({container:I(n)}),contentlets:k(t,o)}})}function k(e,n){return n.map(t=>{let o=t.getBoundingClientRect();return{x:0,y:o.y-e.y,width:o.width,height:o.height,payload:JSON.stringify({container:t.dataset?.dotContainer?JSON.parse(t.dataset?.dotContainer):m(t),contentlet:{identifier:t.dataset?.dotIdentifier,title:t.dataset?.dotTitle,inode:t.dataset?.dotInode,contentType:t.dataset?.dotType}})}})}function I(e){return{acceptTypes:e.dataset?.dotAcceptTypes||"",identifier:e.dataset?.dotIdentifier||"",maxContentlets:e.dataset?.maxContentlets||"",uuid:e.dataset?.dotUuid||""}}function m(e){let n=e.closest('[data-dot-object="container"]');return n?I(n):(console.warn("No container found for the contentlet"),null)}function f(e){return e?e?.dataset?.dotObject==="contentlet"||e?.dataset?.dotObject==="container"&&e.children.length===0?e:f(e?.parentElement):null}function N(e){let n=e.querySelectorAll('[data-dot-object="vtl-file"]');return n.length?Array.from(n).map(t=>({inode:t.dataset?.dotInode,name:t.dataset?.dotUrl})):null}function L(){let e=document.documentElement.scrollHeight,n=window.innerHeight;return window.scrollY+n>=e}var a=[];function U(){let e=Array.from(document.querySelectorAll('[data-dot-object="container"]')),n=M(e);r({action:"set-bounds",payload:n})}function u(){let e=n=>{({"uve-reload-page":()=>{window.location.reload()},"uve-request-bounds":()=>{U()},"uve-scroll-inside-iframe":()=>{let o=n.data.direction;if(window.scrollY===0&&o==="up"||L()&&o==="down")return;let i=o==="up"?-120:120;window.scrollBy({left:0,top:i,behavior:"smooth"})}})[n.data.name]?.()};window.addEventListener("message",e),a.push({type:"listener",event:"message",callback:e})}function p(){let e=n=>{let t=f(n.target);if(!t)return;let{x:o,y:i,width:s,height:c}=t.getBoundingClientRect(),E=t.dataset?.dotObject==="container",O={identifier:"TEMP_EMPTY_CONTENTLET",title:"TEMP_EMPTY_CONTENTLET",contentType:"TEMP_EMPTY_CONTENTLET_TYPE",inode:"TEMPY_EMPTY_CONTENTLET_INODE",widgetTitle:"TEMP_EMPTY_CONTENTLET",baseType:"TEMP_EMPTY_CONTENTLET",onNumberOfPages:1},h={identifier:t.dataset?.dotIdentifier,title:t.dataset?.dotTitle,inode:t.dataset?.dotInode,contentType:t.dataset?.dotType,baseType:t.dataset?.dotBasetype,widgetTitle:t.dataset?.dotWidgetTitle,onNumberOfPages:t.dataset?.dotOnNumberOfPages},R=N(t),S={container:t.dataset?.dotContainer?JSON.parse(t.dataset?.dotContainer):m(t),contentlet:E?O:h,vtlFiles:R};r({action:"set-contentlet",payload:{x:o,y:i,width:s,height:c,payload:S}})};document.addEventListener("pointermove",e),a.push({type:"listener",event:"pointermove",callback:e})}function g(){let e=()=>{r({action:"scroll"}),window.dotUVE={...window.dotUVE??l,lastScrollYPosition:window.scrollY}},n=()=>{r({action:"scroll-end"})};window.addEventListener("scroll",e),window.addEventListener("scrollend",n),a.push({type:"listener",event:"scroll",callback:n}),a.push({type:"listener",event:"scroll",callback:e})}function C(){let e=()=>{window.scrollTo(0,window.dotUVE?.lastScrollYPosition)};window.addEventListener("load",e),a.push({type:"listener",event:"scroll",callback:e})}var b=()=>{if(document.readyState==="complete"){D();return}window.addEventListener("load",()=>D())},D=()=>{let e=document.querySelectorAll("[data-block-editor-content]");e.length&&e.forEach(n=>{let{inode:t,language:o="1",contentType:i,fieldName:s,blockEditorContent:c}=n.dataset,E=JSON.parse(c||"");if(!t||!o||!i||!s){console.error("Missing data attributes for block editor inline editing."),console.warn("inode, language, contentType and fieldName are required.");return}n.classList.add("dotcms__inline-edit-field"),n.addEventListener("click",()=>{d("BLOCK_EDITOR",{inode:t,content:E,language:parseInt(o),fieldName:s,contentType:i})})})};w()&&(y(),u(),g(),C(),p(),_(),b());
