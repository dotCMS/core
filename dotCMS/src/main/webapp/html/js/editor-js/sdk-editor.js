function p(){if(typeof window>"u"||window.parent===window||!window.location)return;let t=new URL(window.location.href),n=t.searchParams.get("mode")??"unknown",e=t.searchParams.get("language_id"),o=t.searchParams.get("personaId"),r=t.searchParams.get("variantName"),a=t.searchParams.get("experimentId"),l=t.searchParams.get("publishDate");return n==="unknown"&&console.warn(`Couldn't identify the current mode of UVE, please contact customer support. Mode: ${n}`),{mode:n,languageId:e,persona:o,variantName:r,experimentId:a,publishDate:l}}function v(t){i({action:"edit-contentlet",payload:t})}function s(t,n){i({action:"init-inline-editing",payload:{type:t,data:n}})}function N(t){let{startLevel:n=1,depth:e=2}=t||{};i({action:"reorder-menu",payload:{startLevel:n,depth:e}})}function I(){window.dotUVE=c}function _(){document.querySelectorAll('[data-dot-object="contentlet"]').forEach(n=>{n.clientHeight||n.classList.add("empty-contentlet")})}var c={editContentlet:v,initInlineEditing:s,reorderMenu:N,lastScrollYPosition:0};function i(t){window.parent.postMessage(t,"*")}function y(t){return t.map(n=>{let e=n.getBoundingClientRect(),o=Array.from(n.querySelectorAll('[data-dot-object="contentlet"]'));return{x:e.x,y:e.y,width:e.width,height:e.height,payload:JSON.stringify({container:w(n)}),contentlets:V(e,o)}})}function V(t,n){return n.map(e=>{let o=e.getBoundingClientRect();return{x:0,y:o.y-t.y,width:o.width,height:o.height,payload:JSON.stringify({container:e.dataset?.dotContainer?JSON.parse(e.dataset?.dotContainer):g(e),contentlet:{identifier:e.dataset?.dotIdentifier,title:e.dataset?.dotTitle,inode:e.dataset?.dotInode,contentType:e.dataset?.dotType}})}})}function w(t){return{acceptTypes:t.dataset?.dotAcceptTypes||"",identifier:t.dataset?.dotIdentifier||"",maxContentlets:t.dataset?.maxContentlets||"",uuid:t.dataset?.dotUuid||""}}function g(t){let n=t.closest('[data-dot-object="container"]');return n?w(n):(console.warn("No container found for the contentlet"),null)}function T(t){return t?t?.dataset?.dotObject==="contentlet"||t?.dataset?.dotObject==="container"&&t.children.length===0?t:T(t?.parentElement):null}function D(t){let n=t.querySelectorAll('[data-dot-object="vtl-file"]');return n.length?Array.from(n).map(e=>({inode:e.dataset?.dotInode,name:e.dataset?.dotUrl})):null}function M(){let t=document.documentElement.scrollHeight,n=window.innerHeight;return window.scrollY+n>=t}var d=[];function R(){let t=Array.from(document.querySelectorAll('[data-dot-object="container"]')),n=y(t);i({action:"set-bounds",payload:n})}function u(){let t=n=>{({"uve-reload-page":()=>{window.location.reload()},"uve-request-bounds":()=>{R()},"uve-scroll-inside-iframe":()=>{let o=n.data.direction;if(window.scrollY===0&&o==="up"||M()&&o==="down")return;let r=o==="up"?-120:120;window.scrollBy({left:0,top:r,behavior:"smooth"})}})[n.data.name]?.()};window.addEventListener("message",t),d.push({type:"listener",event:"message",callback:t})}function m(){let t=n=>{let e=T(n.target);if(!e)return;let{x:o,y:r,width:a,height:l}=e.getBoundingClientRect(),E=e.dataset?.dotObject==="container",b={identifier:"TEMP_EMPTY_CONTENTLET",title:"TEMP_EMPTY_CONTENTLET",contentType:"TEMP_EMPTY_CONTENTLET_TYPE",inode:"TEMPY_EMPTY_CONTENTLET_INODE",widgetTitle:"TEMP_EMPTY_CONTENTLET",baseType:"TEMP_EMPTY_CONTENTLET",onNumberOfPages:1},O={identifier:e.dataset?.dotIdentifier,title:e.dataset?.dotTitle,inode:e.dataset?.dotInode,contentType:e.dataset?.dotType,baseType:e.dataset?.dotBasetype,widgetTitle:e.dataset?.dotWidgetTitle,onNumberOfPages:e.dataset?.dotOnNumberOfPages},h=D(e),S={container:e.dataset?.dotContainer?JSON.parse(e.dataset?.dotContainer):g(e),contentlet:E?b:O,vtlFiles:h};i({action:"set-contentlet",payload:{x:o,y:r,width:a,height:l,payload:S}})};document.addEventListener("pointermove",t),d.push({type:"listener",event:"pointermove",callback:t})}function f(){let t=()=>{i({action:"scroll"}),window.dotUVE={...window.dotUVE??c,lastScrollYPosition:window.scrollY}},n=()=>{i({action:"scroll-end"})};window.addEventListener("scroll",t),window.addEventListener("scrollend",n),d.push({type:"listener",event:"scroll",callback:n}),d.push({type:"listener",event:"scroll",callback:t})}function L(){let t=()=>{window.scrollTo(0,window.dotUVE?.lastScrollYPosition)};window.addEventListener("load",t),d.push({type:"listener",event:"scroll",callback:t})}var P=()=>{if(document.readyState==="complete"){C();return}window.addEventListener("load",()=>C())},C=()=>{let t=document.querySelectorAll("[data-block-editor-content]");t.length&&t.forEach(n=>{let{inode:e,language:o="1",contentType:r,fieldName:a,blockEditorContent:l}=n.dataset,E=JSON.parse(l||"");if(!e||!o||!r||!a){console.error("Missing data attributes for block editor inline editing."),console.warn("inode, language, contentType and fieldName are required.");return}n.classList.add("dotcms__inline-edit-field"),n.addEventListener("click",()=>{s("BLOCK_EDITOR",{inode:e,content:E,language:parseInt(o),fieldName:a,contentType:r})})})};p()&&(I(),u(),f(),L(),m(),_(),P());
