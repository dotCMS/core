import{r as t,c as i,h as e,g as n,H as s}from"./p-d73782c7.js";import{c as o,a}from"./p-cbaf9c4f.js";var r=o((function(t){t.exports=function(){function t(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var i=function(t){return t.innerHTML=""},e=function(t,e,n,s,o,a){s({event:t,query:e instanceof HTMLInputElement?e.value:e.innerHTML,matches:o.matches,results:o.list.map((function(t){return t.value})),selection:o.list.find((function(i){return 13===t.keyCode?i.index===Number(a.getAttribute("data-id")):"mousedown"===t.type?i.index===Number(t.currentTarget.getAttribute("data-id")):void 0}))}),i(n)},n={getInput:function(t){return"string"==typeof t?document.querySelector(t):t()},createResultsList:function(t){var i=document.createElement(t.element);return i.setAttribute("id","autoComplete_list"),t.container&&t.container(i),t.destination.insertAdjacentElement(t.position,i),i},highlight:function(t){return"<span class=".concat("autoComplete_highlighted",">").concat(t,"</span>")},addResultsToList:function(t,i,e){var n=document.createDocumentFragment();i.forEach((function(t,s){var o=document.createElement(e.element);o.setAttribute("data-id",i[s].index),o.setAttribute("class","autoComplete_result"),e.content?e.content(t,o):o.innerHTML=t.match||t,n.appendChild(o)})),t.appendChild(n)},navigation:function(t,i,n,s){var o,a=i.childNodes,r=a.length-1,u=void 0,h=function(t){u.classList.remove("autoComplete_selected"),o=1===t?u.nextSibling:u.previousSibling},l=function(t){(u=t).classList.add("autoComplete_selected")};t.onkeydown=function(c){if(a.length>0)switch(c.keyCode){case 38:u?(h(0),l(o||a[r])):l(a[r]);break;case 40:u?(h(1),l(o||a[0])):l(a[0]);break;case 13:u&&e(c,t,i,n,s,u)}},a.forEach((function(o){o.onmousedown=function(o){return e(o,t,i,n,s)}}))},clearResults:i},s=function(t,i){i=i||{bubbles:!1,cancelable:!1,detail:void 0};var e=document.createEvent("CustomEvent");return e.initCustomEvent(t,i.bubbles,i.cancelable,i.detail),e};s.prototype=window.Event.prototype;var o={CustomEventWrapper:"function"==typeof window.CustomEvent&&window.CustomEvent||s,initElementClosestPolyfill:function(){Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(t){var i=this;do{if(i.matches(t))return i;i=i.parentElement||i.parentNode}while(null!==i&&1===i.nodeType);return null})}};return function(){function i(t){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,i);var e=t.selector,s=void 0===e?"#autoComplete":e,o=t.data,a=o.key,r=o.src,u=o.cache,h=void 0===u||u,l=t.query,c=t.trigger,d=(c=void 0===c?{}:c).event,f=void 0===d?["input"]:d,v=c.condition,m=void 0!==v&&v,p=t.searchEngine,w=void 0===p?"strict":p,y=t.threshold,E=void 0===y?0:y,g=t.debounce,b=void 0===g?0:g,L=t.resultsList,T=(L=void 0===L?{}:L).render,C=void 0!==T&&T,R=L.container,_=L.position,D=void 0===_?"afterend":_,k=L.element,x=void 0===k?"ul":k,H=L.navigation,I=void 0!==H&&H,$=t.sort,M=void 0!==$&&$,P=t.placeHolder,O=t.maxResults,A=void 0===O?5:O,S=t.resultItem,j=(S=void 0===S?{}:S).content,q=void 0!==j&&j,B=S.element,K=void 0===B?"li":B,N=t.noResults,X=t.highlight,Y=void 0!==X&&X,F=t.onSelection,W=C?n.createResultsList({container:void 0!==R&&R,destination:L.destination||n.getInput(s),position:D,element:x}):null;this.selector=s,this.data={src:function(){return"function"==typeof r?r():r},key:a,cache:h},this.query=l,this.trigger={event:f,condition:m},this.searchEngine="loose"===w?"loose":"function"==typeof w?w:"strict",this.threshold=E,this.debounce=b,this.resultsList={render:C,view:W,navigation:I},this.sort=M,this.placeHolder=P,this.maxResults=A,this.resultItem={content:q,element:K},this.noResults=N,this.highlight=Y,this.onSelection=F,this.init()}var e,s;return e=i,(s=[{key:"search",value:function(t,i){var e=i.toLowerCase();if("loose"===this.searchEngine){t=t.replace(/ /g,"");for(var s=[],o=0,a=0;a<e.length;a++){var r=i[a];o<t.length&&e[a]===t[o]&&(r=this.highlight?n.highlight(r):r,o++),s.push(r)}return o===t.length&&s.join("")}if(e.includes(t))return t=new RegExp("".concat(t),"i").exec(i),this.highlight?i.replace(t,n.highlight(t)):i}},{key:"listMatchedResults",value:function(t){var i=this;return new Promise((function(e){var n=[];t.filter((function(t,e){var s=function(s){var o=s?t[s]:t;if(o){var a="function"==typeof i.searchEngine?i.searchEngine(i.queryValue,o):i.search(i.queryValue,o);a&&s?n.push({key:s,index:e,match:a,value:t}):a&&!s&&n.push({index:e,match:a,value:t})}};if(i.data.key){var o=!0,a=!1,r=void 0;try{for(var u,h=i.data.key[Symbol.iterator]();!(o=(u=h.next()).done);o=!0)s(u.value)}catch(l){a=!0,r=l}finally{try{o||null==h.return||h.return()}finally{if(a)throw r}}}else s()}));var s=i.sort?n.sort(i.sort).slice(0,i.maxResults):n.slice(0,i.maxResults);return e({matches:n.length,list:s})}))}},{key:"ignite",value:function(){var t=this,i=n.getInput(this.selector);this.placeHolder&&i.setAttribute("placeholder",this.placeHolder);this.trigger.event.forEach((function(e){var s,a,r;i.addEventListener(e,(s=function(e){return function(e){Promise.resolve(t.data.cache?t.dataStream:t.data.src()).then((function(s){t.dataStream=s,function(e){var s=i instanceof HTMLInputElement||i instanceof HTMLTextAreaElement?i.value.toLowerCase():i.innerHTML.toLowerCase(),a=t.queryValue=t.query&&t.query.manipulate?t.query.manipulate(s):s,r=t.resultsList.render,u=t.trigger.condition?t.trigger.condition(a):a.length>t.threshold&&a.replace(/ /g,"").length,h=function(t,e){i.dispatchEvent(new o.CustomEventWrapper("autoComplete",{bubbles:!0,detail:{event:t,input:s,query:a,matches:e?e.matches:null,results:e?e.list:null},cancelable:!0}))};if(r){var l=t.resultsList.view;n.clearResults(l),u?t.listMatchedResults(t.dataStream,e).then((function(s){h(e,s),t.resultsList.render&&(0===s.list.length&&t.noResults?t.noResults():(n.addResultsToList(l,s.list,t.resultItem),t.onSelection&&(t.resultsList.navigation?t.resultsList.navigation(e,i,l,t.onSelection,s):n.navigation(i,l,t.onSelection,s))))})):h(e)}else!r&&u&&t.listMatchedResults(t.dataStream,e).then((function(t){h(e,t)}))}(e)}))}(e)},a=t.debounce,function(){var t=this,i=arguments;clearTimeout(r),r=setTimeout((function(){return s.apply(t,i)}),a)}))}))}},{key:"init",value:function(){var t=this;this.data.cache?Promise.resolve(this.data.src()).then((function(i){t.dataStream=i,t.ignite()})):this.ignite(),o.initElementClosestPolyfill()}}])&&t(e.prototype,s),i}()}()}));const u=class{constructor(e){t(this,e),this.disabled=!1,this.placeholder="",this.threshold=0,this.maxResults=0,this.debounce=300,this.data=null,this.id=`autoComplete${(new Date).getTime()}`,this.keyEvent={Enter:this.emitEnter.bind(this),Escape:this.clean.bind(this)},this.selection=i(this,"selection",7),this.enter=i(this,"enter",7),this.lostFocus=i(this,"lostFocus",7)}componentDidLoad(){this.data&&this.initAutocomplete()}render(){return e("input",{autoComplete:"off",disabled:this.disabled||null,id:this.id,onBlur:t=>this.handleBlur(t),onKeyDown:t=>this.handleKeyDown(t),placeholder:this.placeholder||null})}watchThreshold(){this.initAutocomplete()}watchData(){this.initAutocomplete()}watchMaxResults(){this.initAutocomplete()}handleKeyDown(t){const{value:i}=this.getInputElement();i&&this.keyEvent[t.key]&&(t.preventDefault(),this.keyEvent[t.key](i))}handleBlur(t){t.preventDefault(),setTimeout(()=>{document.activeElement.parentElement!==this.getResultList()&&(this.clean(),this.lostFocus.emit(t))},0)}clean(){this.getInputElement().value="",this.cleanOptions()}cleanOptions(){this.getResultList().innerHTML=""}emitselect(t){this.clean(),this.selection.emit(t)}emitEnter(t){t&&(this.clean(),this.enter.emit(t))}getInputElement(){return this.el.querySelector(`#${this.id}`)}initAutocomplete(){this.clearList(),new r({data:{src:async()=>this.getData()},sort:(t,i)=>t.match<i.match?-1:t.match>i.match?1:0,placeHolder:this.placeholder,selector:`#${this.id}`,threshold:this.threshold,searchEngine:"strict",highlight:!0,maxResults:this.maxResults,debounce:this.debounce,resultsList:{container:()=>this.getResultListId(),destination:this.getInputElement(),position:"afterend"},resultItem:({match:t})=>t,onSelection:({event:t,selection:i})=>{t.preventDefault(),this.focusOnInput(),this.emitselect(i.value)}})}clearList(){const t=this.getResultList();t&&t.remove()}focusOnInput(){this.getInputElement().focus()}getResultList(){return this.el.querySelector(`#${this.getResultListId()}`)}getResultListId(){return`${this.id}_results_list`}async getData(){const t=this.getInputElement();t.setAttribute("placeholder","Loading...");const i="function"==typeof this.data?await this.data():[];return t.setAttribute("placeholder",this.placeholder||""),i}get el(){return n(this)}static get watchers(){return{threshold:["watchThreshold"],data:["watchData"],maxResults:["watchMaxResults"]}}static get style(){return"dot-autocomplete input{-webkit-box-sizing:border-box;box-sizing:border-box;width:200px}dot-autocomplete ul{background-color:#fff;list-style:none;margin:0;max-height:300px;overflow:auto;padding:0;position:absolute;width:200px}dot-autocomplete ul li{background-color:#fff;border-top:0;border:1px solid #ccc;-webkit-box-sizing:border-box;box-sizing:border-box;cursor:pointer;padding:.25rem}dot-autocomplete ul li:first-child{border-top:1px solid #ccc}dot-autocomplete ul li:focus{background-color:#ffffe0;outline:0}dot-autocomplete ul li .autoComplete_highlighted{font-weight:700}"}},h=class{constructor(e){t(this,e),this.label="",this.deleteLabel="Delete",this.disabled=!1,this.remove=i(this,"remove",7)}render(){const t=this.label?`${this.deleteLabel} ${this.label}`:null;return e(s,null,e("span",null,this.label),e("button",{type:"button","aria-label":t,disabled:this.disabled,onClick:()=>this.remove.emit(this.label)},this.deleteLabel))}get el(){return n(this)}static get style(){return"dot-chip span{margin-right:.25rem}dot-chip button{cursor:pointer}"}};export{u as dot_autocomplete,h as dot_chip};