(function(){
var g=(r=>(r.EDIT="EDIT_MODE",r.PREVIEW="PREVIEW_MODE",r.LIVE="LIVE",r.UNKNOWN="UNKNOWN",r))(g||{});function D(e){return e.map(t=>{let n=t.getBoundingClientRect(),o=Array.from(t.querySelectorAll('[data-dot-object="contentlet"]'));return{x:n.x,y:n.y,width:n.width,height:n.height,payload:JSON.stringify({container:M(t)}),contentlets:j(n,o)}})}function j(e,t){return t.map(n=>{let o=n.getBoundingClientRect();return{x:0,y:o.y-e.y,width:o.width,height:o.height,payload:JSON.stringify({container:n.dataset?.dotContainer?JSON.parse(n.dataset?.dotContainer):u(n),contentlet:{identifier:n.dataset?.dotIdentifier,title:n.dataset?.dotTitle,inode:n.dataset?.dotInode,contentType:n.dataset?.dotType}})}})}function M(e){return{acceptTypes:e.dataset?.dotAcceptTypes||"",identifier:e.dataset?.dotIdentifier||"",maxContentlets:e.dataset?.maxContentlets||"",uuid:e.dataset?.dotUuid||""}}function u(e){let t=e.closest('[data-dot-object="container"]');return t?M(t):(console.warn("No container found for the contentlet"),null)}function E(e){if(!e)return null;let t=e.querySelector('[data-dot-object="empty-content"]');return e?.dataset?.dotObject==="contentlet"||e?.dataset?.dotObject==="container"&&t||e?.dataset?.dotObject==="container"&&e.children.length===0?e:E(e?.parentElement)}function h(e){let t=e.querySelectorAll('[data-dot-object="vtl-file"]');return t.length?Array.from(t).map(n=>({inode:n.dataset?.dotInode,name:n.dataset?.dotUrl})):null}function v(){let e=document.documentElement.scrollHeight,t=window.innerHeight;return window.scrollY+t>=e}function x(e){let t=n=>{n.data.name==="uve-set-page-data"&&e(n.data.payload)};return window.addEventListener("message",t),{unsubscribe:()=>{window.removeEventListener("message",t)},event:"changes"}}function N(e){let t=n=>{n.data.name==="uve-reload-page"&&e()};return window.addEventListener("message",t),{unsubscribe:()=>{window.removeEventListener("message",t)},event:"page-reload"}}function P(e){let t=n=>{if(n.data.name==="uve-request-bounds"){let o=Array.from(document.querySelectorAll('[data-dot-object="container"]')),r=D(o);e(r)}};return window.addEventListener("message",t),{unsubscribe:()=>{window.removeEventListener("message",t)},event:"request-bounds"}}function w(e){let t=n=>{if(n.data.name==="uve-scroll-inside-iframe"){let o=n.data.direction;e(o)}};return window.addEventListener("message",t),{unsubscribe:()=>{window.removeEventListener("message",t)},event:"iframe-scroll"}}function L(e){let t=n=>{let o=E(n.target);if(!o)return;let{x:r,y:s,width:d,height:l}=o.getBoundingClientRect(),p=o.dataset?.dotObject==="container",H={identifier:"TEMP_EMPTY_CONTENTLET",title:"TEMP_EMPTY_CONTENTLET",contentType:"TEMP_EMPTY_CONTENTLET_TYPE",inode:"TEMPY_EMPTY_CONTENTLET_INODE",widgetTitle:"TEMP_EMPTY_CONTENTLET",baseType:"TEMP_EMPTY_CONTENTLET",onNumberOfPages:1},B={identifier:o.dataset?.dotIdentifier,title:o.dataset?.dotTitle,inode:o.dataset?.dotInode,contentType:o.dataset?.dotType,baseType:o.dataset?.dotBasetype,widgetTitle:o.dataset?.dotWidgetTitle,onNumberOfPages:o.dataset?.dotOnNumberOfPages},q=h(o),G={container:o.dataset?.dotContainer?JSON.parse(o.dataset?.dotContainer):u(o),contentlet:p?H:B,vtlFiles:q};e({x:r,y:s,width:d,height:l,payload:G})};return document.addEventListener("pointermove",t),{unsubscribe:()=>{document.removeEventListener("pointermove",t)},event:"contentlet-hovered"}}var O={changes:e=>x(e),"page-reload":e=>N(e),"request-bounds":e=>P(e),"iframe-scroll":e=>w(e),"contentlet-hovered":e=>L(e)},m=e=>({unsubscribe:()=>{},event:e});function C(){if(typeof window>"u"||window.parent===window||!window.location)return;let e=new URL(window.location.href),t=Object.values(g),n=e.searchParams.get("mode")??"EDIT_MODE",o=e.searchParams.get("language_id"),r=e.searchParams.get("personaId"),s=e.searchParams.get("variantName"),d=e.searchParams.get("experimentId"),l=e.searchParams.get("publishDate"),p=e.searchParams.get("dotCMSHost");return t.includes(n)||(n="EDIT_MODE"),{mode:n,languageId:o,persona:r,variantName:s,experimentId:d,publishDate:l,dotCMSHost:p}}function a(e,t){if(!C())return console.warn("UVE Subscription: Not running inside UVE"),m(e);let n=O[e];return n?n(t):(console.error(`UVE Subscription: Event ${e} not found`),m(e))}function _(e){i({action:"set-url",payload:{url:e||"/"}})}function i(e){window.parent.postMessage(e,"*")}function A(e){i({action:"edit-contentlet",payload:e})}function U(e){let{startLevel:t=1,depth:n=2}=e||{};i({action:"reorder-menu",payload:{startLevel:t,depth:n}})}function V(e,t){i({action:"init-inline-editing",payload:{type:e,data:t}})}function k(e){i({action:"set-bounds",payload:e})}function b(){let e=()=>{i({action:"scroll"})},t=()=>{i({action:"scroll-end"})};return window.addEventListener("scroll",e),window.addEventListener("scrollend",t),{destroyScrollHandler:()=>{window.removeEventListener("scroll",e),window.removeEventListener("scrollend",t)}}}function y(){document.querySelectorAll('[data-dot-object="contentlet"]').forEach(t=>{t.clientHeight||t.classList.add("empty-contentlet")})}function T(){let e=a("page-reload",()=>{window.location.reload()}),t=a("request-bounds",r=>{k(r)}),n=a("iframe-scroll",r=>{if(window.scrollY===0&&r==="up"||v()&&r==="down")return;let s=r==="up"?-120:120;window.scrollBy({left:0,top:s,behavior:"smooth"})}),o=a("contentlet-hovered",r=>{i({action:"set-contentlet",payload:r})});return{subscriptions:[e,t,n,o]}}function f(e){i({action:"client-ready",payload:e})}function S(){return document.readyState==="complete"?(c(),{destroyListenBlockEditorInlineEvent:()=>{window.removeEventListener("load",()=>c())}}):(window.addEventListener("load",()=>c()),{destroyListenBlockEditorInlineEvent:()=>{window.removeEventListener("load",()=>c())}})}var c=()=>{let e=document.querySelectorAll("[data-block-editor-content]");e.length&&e.forEach(t=>{let{inode:n,language:o="1",contentType:r,fieldName:s,blockEditorContent:d}=t.dataset,l=JSON.parse(d||"");if(!n||!o||!r||!s){console.error("Missing data attributes for block editor inline editing."),console.warn("inode, language, contentType and fieldName are required.");return}t.classList.add("dotcms__inline-edit-field"),t.addEventListener("click",()=>{V("BLOCK_EDITOR",{inode:n,content:l,language:parseInt(o),fieldName:s,contentType:r})})})};var $={createSubscription:a,editContentlet:A,reorderMenu:U,updateNavigation:_};window.dotUVE=$;var F=C();F?.mode==="EDIT_MODE"&&(T(),b(),y(),f(),S());
})();
