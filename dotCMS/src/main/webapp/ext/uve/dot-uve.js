(function(){
var c=(o=>(o.EDIT="EDIT_MODE",o.PREVIEW="PREVIEW_MODE",o.LIVE="LIVE",o.UNKNOWN="UNKNOWN",o))(c||{});function f(t){return t.map(e=>{let n=e.getBoundingClientRect(),i=Array.from(e.querySelectorAll('[data-dot-object="contentlet"]'));return{x:n.x,y:n.y,width:n.width,height:n.height,payload:JSON.stringify({container:T(e)}),contentlets:W(n,i)}})}function W(t,e){return e.map(n=>{let i=n.getBoundingClientRect();return{x:0,y:i.y-t.y,width:i.width,height:i.height,payload:JSON.stringify({container:n.dataset?.dotContainer?JSON.parse(n.dataset?.dotContainer):p(n),contentlet:{identifier:n.dataset?.dotIdentifier,title:n.dataset?.dotTitle,inode:n.dataset?.dotInode,contentType:n.dataset?.dotType}})}})}function T(t){return{acceptTypes:t.dataset?.dotAcceptTypes||"",identifier:t.dataset?.dotIdentifier||"",maxContentlets:t.dataset?.maxContentlets||"",uuid:t.dataset?.dotUuid||""}}function p(t){let e=t.closest('[data-dot-object="container"]');return e?T(e):(console.warn("No container found for the contentlet"),null)}function g(t){if(!t)return null;let e=t.querySelector('[data-dot-object="empty-content"]');return t?.dataset?.dotObject==="contentlet"||t?.dataset?.dotObject==="container"&&e||t?.dataset?.dotObject==="container"&&t.children.length===0?t:g(t?.parentElement)}function M(t){let e=t.querySelectorAll('[data-dot-object="vtl-file"]');return e.length?Array.from(e).map(n=>({inode:n.dataset?.dotInode,name:n.dataset?.dotUrl})):null}function h(){let t=document.documentElement.scrollHeight,e=window.innerHeight;return window.scrollY+e>=t}function x(t){let e=n=>{n.data.name==="uve-set-page-data"&&t(n.data.payload)};return window.addEventListener("message",e),{unsubscribe:()=>{window.removeEventListener("message",e)},event:"changes"}}function v(t){let e=n=>{n.data.name==="uve-reload-page"&&t()};return window.addEventListener("message",e),{unsubscribe:()=>{window.removeEventListener("message",e)},event:"page-reload"}}function N(t){let e=n=>{if(n.data.name==="uve-request-bounds"){let i=Array.from(document.querySelectorAll('[data-dot-object="container"]')),o=f(i);t(o)}};return window.addEventListener("message",e),{unsubscribe:()=>{window.removeEventListener("message",e)},event:"request-bounds"}}function L(t){let e=n=>{if(n.data.name==="uve-scroll-inside-iframe"){let i=n.data.direction;t(i)}};return window.addEventListener("message",e),{unsubscribe:()=>{window.removeEventListener("message",e)},event:"iframe-scroll"}}function O(t){let e=null,n=0,i=0,o=()=>{n+=1},a=l=>{let r=g(l.target);if(!r){e=null;return}if(e===r&&!(n!==i))return;let{x:H,y:B,width:q,height:G}=r.getBoundingClientRect(),F=r.dataset?.dotObject==="container",Y={identifier:"TEMP_EMPTY_CONTENTLET",title:"TEMP_EMPTY_CONTENTLET",contentType:"TEMP_EMPTY_CONTENTLET_TYPE",inode:"TEMPY_EMPTY_CONTENTLET_INODE",widgetTitle:"TEMP_EMPTY_CONTENTLET",baseType:"TEMP_EMPTY_CONTENTLET",onNumberOfPages:1},j={identifier:r.dataset?.dotIdentifier,title:r.dataset?.dotTitle,inode:r.dataset?.dotInode,contentType:r.dataset?.dotType,baseType:r.dataset?.dotBasetype,widgetTitle:r.dataset?.dotWidgetTitle,onNumberOfPages:r.dataset?.dotOnNumberOfPages},$=M(r),Q={container:r.dataset?.dotContainer?JSON.parse(r.dataset?.dotContainer):p(r),contentlet:F?Y:j,vtlFiles:$};t({x:H,y:B,width:q,height:G,payload:Q}),e=r,i=n};return document.addEventListener("scroll",o,!0),document.addEventListener("pointermove",a),{unsubscribe:()=>{document.removeEventListener("scroll",o,!0),document.removeEventListener("pointermove",a)},event:"contentlet-hovered"}}var R={changes:t=>x(t),"page-reload":t=>v(t),"request-bounds":t=>N(t),"iframe-scroll":t=>L(t),"contentlet-hovered":t=>O(t)},u=t=>({unsubscribe:()=>{},event:t});function m(){if(typeof window>"u"||window.parent===window||!window.location)return;let t=new URL(window.location.href),e=Object.values(c),n=t.searchParams.get("mode")??"EDIT_MODE",i=t.searchParams.get("language_id"),o=t.searchParams.get("personaId"),a=t.searchParams.get("variantName"),l=t.searchParams.get("experimentId"),r=t.searchParams.get("publishDate"),D=t.searchParams.get("dotCMSHost");return e.includes(n)||(n="EDIT_MODE"),{mode:n,languageId:i,persona:o,variantName:a,experimentId:l,publishDate:r,dotCMSHost:D}}function d(t,e){if(!m())return console.warn("UVE Subscription: Not running inside UVE"),u(t);let n=R[t];return n?n(e):(console.error(`UVE Subscription: Event ${t} not found`),u(t))}function w(t){s({action:"set-url",payload:{url:t||"/"}})}function s(t){window.parent.postMessage(t,"*")}function A(t){s({action:"edit-contentlet",payload:t})}function _(t){let{startLevel:e=1,depth:n=2}=t||{};s({action:"reorder-menu",payload:{startLevel:e,depth:n}})}function U(t,e){s({action:"init-inline-editing",payload:{type:t,data:e}})}function V(t){s({action:"set-bounds",payload:t})}function E(){let t=()=>{s({action:"scroll"})},e=()=>{s({action:"scroll-end"})};return window.addEventListener("scroll",t),window.addEventListener("scrollend",e),{destroyScrollHandler:()=>{window.removeEventListener("scroll",t),window.removeEventListener("scrollend",e)}}}function C(){document.querySelectorAll('[data-dot-object="contentlet"]').forEach(e=>{e.clientHeight||e.classList.add("empty-contentlet")})}function y(){let t=d("page-reload",()=>{window.location.reload()}),e=d("request-bounds",o=>{V(o)}),n=d("iframe-scroll",o=>{if(window.scrollY===0&&o==="up"||h()&&o==="down")return;let a=o==="up"?-120:120;window.scrollBy({left:0,top:a,behavior:"smooth"})}),i=d("contentlet-hovered",o=>{s({action:"set-contentlet",payload:o})});return{subscriptions:[t,e,n,i]}}function S(t){s({action:"client-ready",payload:t})}function b(){if(document.readyState==="complete")return k(),{destroyListenBlockEditorInlineEvent:()=>{}};let t=()=>{k()};return document.addEventListener("DOMContentLoaded",t),{destroyListenBlockEditorInlineEvent:()=>{document.removeEventListener("DOMContentLoaded",t)}}}var k=()=>{let t=document.querySelectorAll("[data-block-editor-content]");t.length&&t.forEach(e=>{let{inode:n,language:i="1",contentType:o,fieldName:a,blockEditorContent:l}=e.dataset,r=JSON.parse(l||"");if(!n||!i||!o||!a){console.error("Missing data attributes for block editor inline editing."),console.warn("inode, language, contentType and fieldName are required.");return}e.classList.add("dotcms__inline-edit-field"),e.addEventListener("click",()=>{U("BLOCK_EDITOR",{inode:n,content:r,language:parseInt(i),fieldName:a,contentType:o})})})};var J={createSubscription:d,editContentlet:A,reorderMenu:_,updateNavigation:w};window.dotUVE=J;var K=m();K?.mode==="EDIT_MODE"&&(y(),E(),C(),S(),b());
})();
