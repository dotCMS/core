(function(){
var G=Object.defineProperty;var F=(t,e)=>{for(var n in e)G(t,n,{get:e[n],enumerable:!0})};function L(t){return t.map(e=>{let n=e.getBoundingClientRect(),o=Array.from(e.querySelectorAll('[data-dot-object="contentlet"]'));return{x:n.x,y:n.y,width:n.width,height:n.height,payload:JSON.stringify({container:S(e)}),contentlets:Y(n,o)}})}function Y(t,e){return e.map(n=>{let o=n.getBoundingClientRect();return{x:0,y:o.y-t.y,width:o.width,height:o.height,payload:JSON.stringify({container:n.dataset?.dotContainer?JSON.parse(n.dataset?.dotContainer):g(n),contentlet:{identifier:n.dataset?.dotIdentifier,title:n.dataset?.dotTitle,inode:n.dataset?.dotInode,contentType:n.dataset?.dotType}})}})}function S(t){return{acceptTypes:t.dataset?.dotAcceptTypes||"",identifier:t.dataset?.dotIdentifier||"",maxContentlets:t.dataset?.maxContentlets||"",uuid:t.dataset?.dotUuid||""}}function g(t){let e=t.closest('[data-dot-object="container"]');return e?S(e):(console.warn("No container found for the contentlet"),null)}function N(t){return t?t?.dataset?.dotObject==="contentlet"||t?.dataset?.dotObject==="container"&&t.children.length===0?t:N(t?.parentElement):null}function _(t){let e=t.querySelectorAll('[data-dot-object="vtl-file"]');return e.length?Array.from(e).map(n=>({inode:n.dataset?.dotInode,name:n.dataset?.dotUrl})):null}function b(){let t=document.documentElement.scrollHeight,e=window.innerHeight;return window.scrollY+e>=t}var l=(r=>(r.EDIT="EDIT_MODE",r.PREVIEW="PREVIEW_MODE",r.LIVE="LIVE",r.UNKNOWN="UNKNOWN",r))(l||{});function i(t){window.parent.postMessage(t,"*")}function $(t){i({action:"edit-contentlet",payload:t})}function j(t){let{startLevel:e=1,depth:n=2}=t||{};i({action:"reorder-menu",payload:{startLevel:e,depth:n}})}function y(t,e){i({action:"init-inline-editing",payload:{type:t,data:e}})}function q(){u(),m();let{subscriptions:t}=p(),{destroyScrollHandler:e}=c(),{destroyListenBlockEditorInlineEvent:n}=T();return{destroyUVESubscriptions:()=>{t.forEach(o=>o.unsubscribe()),e(),n()}}}function I(t){i({action:"set-bounds",payload:t})}function x(t){let e=n=>{n.data.name==="uve-set-page-data"&&t(n.data.payload)};return window.addEventListener("message",e),{unsubscribe:()=>{window.removeEventListener("message",e)},event:"changes"}}function R(t){let e=n=>{n.data.name==="uve-reload-page"&&t()};return window.addEventListener("message",e),{unsubscribe:()=>{window.removeEventListener("message",e)},event:"page-reload"}}function U(t){let e=n=>{if(n.data.name==="uve-request-bounds"){let o=Array.from(document.querySelectorAll('[data-dot-object="container"]')),r=L(o);t(r)}};return window.addEventListener("message",e),{unsubscribe:()=>{window.removeEventListener("message",e)},event:"request-bounds"}}function A(t){let e=n=>{if(n.data.name==="uve-scroll-inside-iframe"){let o=n.data.direction;t(o)}};return window.addEventListener("message",e),{unsubscribe:()=>{window.removeEventListener("message",e)},event:"iframe-scroll"}}function w(t){let e=n=>{let o=N(n.target);if(!o)return;let{x:r,y:a,width:d,height:E}=o.getBoundingClientRect(),V=o.dataset?.dotObject==="container",h={identifier:"TEMP_EMPTY_CONTENTLET",title:"TEMP_EMPTY_CONTENTLET",contentType:"TEMP_EMPTY_CONTENTLET_TYPE",inode:"TEMPY_EMPTY_CONTENTLET_INODE",widgetTitle:"TEMP_EMPTY_CONTENTLET",baseType:"TEMP_EMPTY_CONTENTLET",onNumberOfPages:1},H={identifier:o.dataset?.dotIdentifier,title:o.dataset?.dotTitle,inode:o.dataset?.dotInode,contentType:o.dataset?.dotType,baseType:o.dataset?.dotBasetype,widgetTitle:o.dataset?.dotWidgetTitle,onNumberOfPages:o.dataset?.dotOnNumberOfPages},B=_(o),k={container:o.dataset?.dotContainer?JSON.parse(o.dataset?.dotContainer):g(o),contentlet:V?h:H,vtlFiles:B};t({x:r,y:a,width:d,height:E,payload:k})};return document.addEventListener("pointermove",e),{unsubscribe:()=>{document.removeEventListener("pointermove",e)},event:"contentlet-hovered"}}var P={changes:t=>x(t),"page-reload":t=>R(t),"request-bounds":t=>U(t),"iframe-scroll":t=>A(t),"contentlet-hovered":t=>w(t)},v=t=>({unsubscribe:()=>{},event:t});function f(){if(typeof window>"u"||window.parent===window||!window.location)return;let t=new URL(window.location.href),e=Object.values(l),n=t.searchParams.get("mode")??"EDIT_MODE",o=t.searchParams.get("language_id"),r=t.searchParams.get("personaId"),a=t.searchParams.get("variantName"),d=t.searchParams.get("experimentId"),E=t.searchParams.get("publishDate");return e.includes(n)||(n="EDIT_MODE"),{mode:n,languageId:o,persona:r,variantName:a,experimentId:d,publishDate:E}}function s(t,e){if(!f())return console.warn("UVE Subscription: Not running inside UVE"),v(t);let n=P[t];return n?n(e):(console.error(`UVE Subscription: Event ${t} not found`),v(t))}function c(){let t=()=>{i({action:"scroll"})},e=()=>{i({action:"scroll-end"})};return window.addEventListener("scroll",t),window.addEventListener("scrollend",e),{destroyScrollHandler:()=>{window.removeEventListener("scroll",t),window.removeEventListener("scrollend",e)}}}function u(){document.querySelectorAll('[data-dot-object="contentlet"]').forEach(e=>{e.clientHeight||e.classList.add("empty-contentlet")})}function p(){let t=s("page-reload",()=>{window.location.reload()}),e=s("request-bounds",r=>{I(r)}),n=s("iframe-scroll",r=>{if(window.scrollY===0&&r==="up"||b()&&r==="down")return;let a=r==="up"?-120:120;window.scrollBy({left:0,top:a,behavior:"smooth"})}),o=s("contentlet-hovered",r=>{i({action:"set-contentlet",payload:r})});return{subscriptions:[t,e,n,o]}}function m(){i({action:"client-ready"})}function T(){return document.readyState==="complete"?(C(),{destroyListenBlockEditorInlineEvent:()=>{window.removeEventListener("load",()=>C())}}):(window.addEventListener("load",()=>C()),{destroyListenBlockEditorInlineEvent:()=>{window.removeEventListener("load",()=>C())}})}var C=()=>{let t=document.querySelectorAll("[data-block-editor-content]");t.length&&t.forEach(e=>{let{inode:n,language:o="1",contentType:r,fieldName:a,blockEditorContent:d}=e.dataset,E=JSON.parse(d||"");if(!n||!o||!r||!a){console.error("Missing data attributes for block editor inline editing."),console.warn("inode, language, contentType and fieldName are required.");return}e.classList.add("dotcms__inline-edit-field"),e.addEventListener("click",()=>{y("BLOCK_EDITOR",{inode:n,content:E,language:parseInt(o),fieldName:a,contentType:r})})})};var D={};F(D,{createUVESubscription:()=>s,editContentlet:()=>$,getUVEState:()=>f,initInlineEditing:()=>y,initUVE:()=>q,reorderMenu:()=>j,sendMessageToUVE:()=>i});var K={...D};window.dotUVE=K;var Q=f();Q?.mode==="EDIT_MODE"&&(p(),c(),u(),m(),T());
})();
