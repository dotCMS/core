var Qt=(W,q,B)=>{if(!q.has(W))throw TypeError("Cannot "+B)};var Be=(W,q,B)=>(Qt(W,q,"read from private field"),B?B.call(W):q.get(W)),He=(W,q,B)=>{if(q.has(W))throw TypeError("Cannot add the same private member more than once");q instanceof WeakSet?q.add(W):q.set(W,B)},Xe=(W,q,B,Ie)=>(Qt(W,q,"write to private field"),Ie?Ie.call(W,B):q.set(W,B),B);(function(){"use strict";var Ne,Ye,we;function W(e,t,n,r,o){for(t=t.split?t.split("."):t,r=0;r<t.length;r++)e=e?e[t[r]]:o;return e===o?n:e}var q="undefined",B="object",Ie="any",lt="*",re="__",Te=typeof process<"u"?process:{};Te.env&&Te.env.NODE_ENV;var G=typeof document<"u";Te.versions!=null&&Te.versions.node!=null,typeof Deno<"u"&&Deno.core,G&&window.name==="nodejs"||typeof navigator<"u"&&navigator.userAgent!==void 0&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom"));function ft(e,t){return t.charAt(0)[e]()+t.slice(1)}var Zt=ft.bind(null,"toUpperCase"),en=ft.bind(null,"toLowerCase");function tn(e){return dt(e)?Zt("null"):typeof e=="object"?un(e):Object.prototype.toString.call(e).slice(8,-1)}function $e(e,t){t===void 0&&(t=!0);var n=tn(e);return t?en(n):n}function Se(e,t){return typeof t===e}var K=Se.bind(null,"function"),se=Se.bind(null,"string"),le=Se.bind(null,"undefined"),nn=Se.bind(null,"boolean");Se.bind(null,"symbol");function dt(e){return e===null}function rn(e){return $e(e)==="number"&&!isNaN(e)}function an(e){return $e(e)==="array"}function Y(e){if(!on(e))return!1;for(var t=e;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function on(e){return e&&(typeof e=="object"||e!==null)}function un(e){return K(e.constructor)?e.constructor.name:null}function cn(e){return e instanceof Error||se(e.message)&&e.constructor&&rn(e.constructor.stackTraceLimit)}function pt(e,t){if(typeof t!="object"||dt(t))return!1;if(t instanceof e)return!0;var n=$e(new e(""));if(cn(t))for(;t;){if($e(t)===n)return!0;t=Object.getPrototypeOf(t)}return!1}pt.bind(null,TypeError),pt.bind(null,SyntaxError);function ze(e,t){var n=e instanceof Element||e instanceof HTMLDocument;return n&&t?sn(e,t):n}function sn(e,t){return t===void 0&&(t=""),e&&e.nodeName===t.toUpperCase()}function De(e){var t=[].slice.call(arguments,1);return function(){return e.apply(void 0,[].slice.call(arguments).concat(t))}}De(ze,"form"),De(ze,"button"),De(ze,"input"),De(ze,"select");function gt(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch{return null}}function ln(){if(G){var e=navigator,t=e.languages;return e.userLanguage||(t&&t.length?t[0]:e.language)}}function fn(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch{}}function dn(e){return function(t){for(var n,r=Object.create(null),o=/([^&=]+)=?([^&]*)/g;n=o.exec(t);){var u=gt(n[1]),c=gt(n[2]);u.substring(u.length-2)==="[]"?(r[u=u.substring(0,u.length-2)]||(r[u]=[])).push(c):r[u]=c===""||c}for(var s in r){var S=s.split("[");S.length>1&&(pn(r,S.map(function(v){return v.replace(/[?[\]\\ ]/g,"")}),r[s]),delete r[s])}return r}(function(t){return G&&window.location.search.substring(1)}())}function pn(e,t,n){for(var r=t.length-1,o=0;o<r;++o){var u=t[o];if(u==="__proto__"||u==="constructor")break;u in e||(e[u]={}),e=e[u]}e[t[r]]=n}function Le(){for(var e="",t=0,n=4294967295*Math.random()|0;t++<36;){var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx"[t-1],o=15&n;e+=r=="-"||r=="4"?r:(r=="x"?o:3&o|8).toString(16),n=t%8==0?4294967295*Math.random()|0:n>>4}return e}var Pe="global",fe=re+"global"+re,de=typeof self===B&&self.self===self&&self||typeof global===B&&global.global===global&&global||void 0;function ie(e){return de[fe][e]}function ae(e,t){return de[fe][e]=t}function pe(e){delete de[fe][e]}function ge(e,t,n){var r;try{if(Ge(e)){var o=window[e];r=o[t].bind(o)}}catch{}return r||n}de[fe]||(de[fe]={});var Me={};function Ge(e){if(typeof Me[e]!==q)return Me[e];try{var t=window[e];t.setItem(q,q),t.removeItem(q)}catch{return Me[e]=!1}return Me[e]=!0}function p(){return p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},p.apply(this,arguments)}var ee="function",Z="undefined",gn="@@redux/"+Math.random().toString(36),mt=function(){return typeof Symbol===ee&&Symbol.observable||"@@observable"}(),Ce=" != "+ee;function vt(e,t,n){var r;if(typeof t===ee&&typeof n===Z&&(n=t,t=void 0),typeof n!==Z){if(typeof n!==ee)throw new Error("enhancer"+Ce);return n(vt)(e,t)}if(typeof e!==ee)throw new Error("reducer"+Ce);var o=e,u=t,c=[],s=c,S=!1;function v(){s===c&&(s=c.slice())}function L(){return u}function m(h){if(typeof h!==ee)throw new Error("Listener"+Ce);var T=!0;return v(),s.push(h),function(){if(T){T=!1,v();var P=s.indexOf(h);s.splice(P,1)}}}function E(h){if(!Y(h))throw new Error("Act != obj");if(typeof h.type===Z)throw new Error("ActType "+Z);if(S)throw new Error("Dispatch in reducer");try{S=!0,u=o(u,h)}finally{S=!1}for(var T=c=s,P=0;P<T.length;P++)(0,T[P])();return h}return E({type:"@@redux/INIT"}),(r={dispatch:E,subscribe:m,getState:L,replaceReducer:function(h){if(typeof h!==ee)throw new Error("next reducer"+Ce);o=h,E({type:"@@redux/INIT"})}})[mt]=function(){var h,T=m;return(h={subscribe:function(P){if(typeof P!="object")throw new TypeError("Observer != obj");function b(){P.next&&P.next(L())}return b(),{unsubscribe:T(b)}}})[mt]=function(){return this},h},r}function mn(e,t){var n=t&&t.type;return"action "+(n&&n.toString()||"?")+"reducer "+e+" returns "+Z}function me(){var e=[].slice.call(arguments);return e.length===0?function(t){return t}:e.length===1?e[0]:e.reduce(function(t,n){return function(){return t(n.apply(void 0,[].slice.call(arguments)))}})}function vn(){var e=arguments;return function(t){return function(n,r,o){var u,c=t(n,r,o),s=c.dispatch,S={getState:c.getState,dispatch:function(v){return s(v)}};return u=[].slice.call(e).map(function(v){return v(S)}),p({},c,{dispatch:s=me.apply(void 0,u)(c.dispatch)})}}}var te=re+"anon_id",oe=re+"user_id",ve=re+"user_traits",ne="userId",he="anonymousId",Ue=["bootstrap","params","campaign","initializeStart","initialize","initializeEnd","ready","resetStart","reset","resetEnd","pageStart","page","pageEnd","pageAborted","trackStart","track","trackEnd","trackAborted","identifyStart","identify","identifyEnd","identifyAborted","userIdChanged","registerPlugins","enablePlugin","disablePlugin","online","offline","setItemStart","setItem","setItemEnd","setItemAborted","removeItemStart","removeItem","removeItemEnd","removeItemAborted"],Ke=["name","EVENTS","config","loaded"],g=Ue.reduce(function(e,t){return e[t]=t,e},{registerPluginType:function(e){return"registerPlugin:"+e},pluginReadyType:function(e){return"ready:"+e}}),ht=/^utm_/,yt=/^an_prop_/,bt=/^an_trait_/;function hn(e){var t=e.storage.setItem;return function(n){return function(r){return function(o){if(o.type===g.bootstrap){var u=o.params,c=o.user,s=o.persistedUser,S=o.initialUser,v=s.userId===c.userId;s.anonymousId!==c.anonymousId&&t(te,c.anonymousId),v||t(oe,c.userId),S.traits&&t(ve,p({},v&&s.traits?s.traits:{},S.traits));var L=Object.keys(o.params);if(L.length){var m=u.an_uid,E=u.an_event,h=L.reduce(function(T,P){if(P.match(ht)||P.match(/^(d|g)clid/)){var b=P.replace(ht,"");T.campaign[b==="campaign"?"name":b]=u[P]}return P.match(yt)&&(T.props[P.replace(yt,"")]=u[P]),P.match(bt)&&(T.traits[P.replace(bt,"")]=u[P]),T},{campaign:{},props:{},traits:{}});n.dispatch(p({type:g.params,raw:u},h,m?{userId:m}:{})),m&&setTimeout(function(){return e.identify(m,h.traits)},0),E&&setTimeout(function(){return e.track(E,h.props)},0),Object.keys(h.campaign).length&&n.dispatch({type:g.campaign,campaign:h.campaign})}}return r(o)}}}}function yn(e){return function(t,n){if(t===void 0&&(t={}),n===void 0&&(n={}),n.type===g.setItemEnd){if(n.key===te)return p({},t,{anonymousId:n.value});if(n.key===oe)return p({},t,{userId:n.value})}switch(n.type){case g.identify:return Object.assign({},t,{userId:n.userId,traits:p({},t.traits,n.traits)});case g.reset:return[oe,te,ve].forEach(function(r){e.removeItem(r)}),Object.assign({},t,{userId:null,anonymousId:null,traits:{}});default:return t}}}function wt(e){return{userId:e.getItem(oe),anonymousId:e.getItem(te),traits:e.getItem(ve)}}var Qe=function(e){return re+"TEMP"+re+e};function bn(e){var t=e.storage,n=t.setItem,r=t.removeItem,o=t.getItem;return function(u){return function(c){return function(s){var S=s.userId,v=s.traits,L=s.options;if(s.type===g.reset&&([oe,ve,te].forEach(function(h){r(h)}),[ne,he,"traits"].forEach(function(h){pe(Qe(h))})),s.type===g.identify){o(te)||n(te,Le());var m=o(oe),E=o(ve)||{};m&&m!==S&&u.dispatch({type:g.userIdChanged,old:{userId:m,traits:E},new:{userId:S,traits:v},options:L}),S&&n(oe,S),v&&n(ve,p({},E,v))}return c(s)}}}}var Ee={};function It(e,t){Ee[e]&&K(Ee[e])&&(Ee[e](t),delete Ee[e])}function St(e,t,n){return new Promise(function(r,o){return t()?r(e):n<1?o(p({},e,{queue:!0})):new Promise(function(u){return setTimeout(u,10)}).then(function(u){return St(e,t,n-10).then(r,o)})})}function wn(e){return{abort:e}}function Pt(e,t,n){var r={},o=t(),u=e.getState(),c=u.plugins,s=u.queue,S=u.user;if(!u.context.offline&&s&&s.actions&&s.actions.length){var v=s.actions.reduce(function(m,E,h){return c[E.plugin].loaded?(m.process.push(E),m.processIndex.push(h)):(m.requeue.push(E),m.requeueIndex.push(h)),m},{processIndex:[],process:[],requeue:[],requeueIndex:[]});if(v.processIndex&&v.processIndex.length){v.processIndex.forEach(function(m){var E=s.actions[m],h=E.plugin,T=E.payload.type,P=o[h][T];if(P&&K(P)){var b,_=function(d,l){return d===void 0&&(d={}),l===void 0&&(l={}),[ne,he].reduce(function(z,O){return d.hasOwnProperty(O)&&l[O]&&l[O]!==d[O]&&(z[O]=l[O]),z},d)}(E.payload,S),$=r[_.meta.rid];if(!$&&(b=P({payload:_,config:c[h].config,instance:n,abort:wn}))&&Y(b)&&b.abort)return void(r[_.meta.rid]=!0);if(!$){var k=T+":"+h;e.dispatch(p({},_,{type:k,_:{called:k,from:"queueDrain"}}))}}});var L=s.actions.filter(function(m,E){return!~v.processIndex.indexOf(E)});s.actions=L}}}var Ze=function(e){var t=e.data,n=e.action,r=e.instance,o=e.state,u=e.allPlugins,c=e.allMatches,s=e.store,S=e.EVENTS;try{var v=o.plugins,L=o.context,m=n.type,E=m.match(ye),h=t.exact.map(function(b){return b.pluginName});E&&(h=c.during.map(function(b){return b.pluginName}));var T=function(b,_){return function($,k,d){var l=k.config,z=k.name,O=z+"."+$.type;d&&(O=d.event);var N=$.type.match(ye)?function(M,D,H,C,X){return function(V,y){var J=C?C.name:M,F=y&&Oe(y)?y:H;if(C&&(!(F=y&&Oe(y)?y:[M]).includes(M)||F.length!==1))throw new Error("Method "+D+" can only abort "+M+" plugin. "+JSON.stringify(F)+" input valid");return p({},X,{abort:{reason:V,plugins:F,caller:D,_:J}})}}(z,O,_,d,$):function(M,D){return function(){throw new Error(M.type+" action not cancellable. Remove abort in "+D)}}($,O);return{payload:In($),instance:b,config:l||{},abort:N}}}(r,h),P=t.exact.reduce(function(b,_){var $=_.pluginName,k=_.methodName,d=!1;return k.match(/^initialize/)||k.match(/^reset/)||(d=!v[$].loaded),L.offline&&k.match(/^(page|track|identify)/)&&(d=!0),b[""+$]=d,b},{});return Promise.resolve(t.exact.reduce(function(b,_,$){try{var k=_.pluginName;return Promise.resolve(b).then(function(d){function l(){return Promise.resolve(d)}var z=function(){if(t.namespaced&&t.namespaced[k])return Promise.resolve(t.namespaced[k].reduce(function(O,N,M){try{return Promise.resolve(O).then(function(D){return N.method&&K(N.method)?(function(V,y){var J=kt(V);if(J&&J.name===y){var F=kt(J.method);throw new Error([y+" plugin is calling method "+V,"Plugins cant call self","Use "+J.method+" "+(F?"or "+F.method:"")+" in "+y+" plugin insteadof "+V].join(`
`))}}(N.methodName,N.pluginName),Promise.resolve(N.method({payload:D,instance:r,abort:(H=D,C=k,X=N.pluginName,function(V,y){return p({},H,{abort:{reason:V,plugins:y||[C],caller:m,from:X||C}})}),config:xt(N.pluginName,v,u),plugins:v})).then(function(V){var y=Y(V)?V:{};return Promise.resolve(p({},D,y))})):D;var H,C,X})}catch(D){return Promise.reject(D)}},Promise.resolve(n))).then(function(O){d[k]=O});d[k]=n}();return z&&z.then?z.then(l):l()})}catch(d){return Promise.reject(d)}},Promise.resolve({}))).then(function(b){return Promise.resolve(t.exact.reduce(function(_,$,k){try{var d=t.exact.length===k+1,l=$.pluginName,z=u[l];return Promise.resolve(_).then(function(O){var N=b[l]?b[l]:{};if(E&&(N=O),tt(N,l))return et({data:N,method:m,instance:r,pluginName:l,store:s}),Promise.resolve(O);if(tt(O,l))return d&&et({data:O,method:m,instance:r,store:s}),Promise.resolve(O);if(P.hasOwnProperty(l)&&P[l]===!0)return s.dispatch({type:"queue",plugin:l,payload:N,_:{called:"queue",from:"queueMechanism"}}),Promise.resolve(O);var M=T(b[l],u[l]);return Promise.resolve(z[m]({abort:M.abort,payload:N,instance:r,config:xt(l,v,u),plugins:v})).then(function(D){var H=Y(D)?D:{},C=p({},O,H),X=b[l];if(tt(X,l))et({data:X,method:m,instance:r,pluginName:l,store:s});else{var V=m+":"+l;(V.match(/:/g)||[]).length<2&&!m.match(Et)&&!m.match(Ot)&&r.dispatch(p({},E?C:N,{type:V,_:{called:V,from:"submethod"}}))}return Promise.resolve(C)})})}catch(O){return Promise.reject(O)}},Promise.resolve(n))).then(function(_){if(!(m.match(ye)||m.match(/^registerPlugin/)||m.match(Ot)||m.match(Et)||m.match(/^params/)||m.match(/^userIdChanged/))){if(S.plugins.includes(m),_._&&_._.originalAction===m)return _;var $=p({},_,{_:{originalAction:_.type,called:_.type,from:"engineEnd"}});Nt(_,t.exact.length)&&!m.match(/End$/)&&($=p({},$,{type:_.type+"Aborted"})),s.dispatch($)}return _})})}catch(b){return Promise.reject(b)}},ye=/Start$/,Et=/^bootstrap/,Ot=/^ready/;function et(e){var t=e.pluginName,n=e.method+"Aborted"+(t?":"+t:"");e.store.dispatch(p({},e.data,{type:n,_:{called:n,from:"abort"}}))}function xt(e,t,n){var r=t[e]||n[e];return r&&r.config?r.config:{}}function At(e,t){return t.reduce(function(n,r){return r[e]?n.concat({methodName:e,pluginName:r.name,method:r[e]}):n},[])}function _t(e,t){var n=e.replace(ye,""),r=t?":"+t:"";return[""+e+r,""+n+r,n+"End"+r]}function tt(e,t){var n=e.abort;return!!n&&(n===!0||jt(n,t)||n&&jt(n.plugins,t))}function Nt(e,t){var n=e.abort;if(!n)return!1;if(n===!0||se(n))return!0;var r=n.plugins;return Oe(n)&&n.length===t||Oe(r)&&r.length===t}function Oe(e){return Array.isArray(e)}function jt(e,t){return!(!e||!Oe(e))&&e.includes(t)}function kt(e){var t=e.match(/(.*):(.*)/);return!!t&&{method:t[1],name:t[2]}}function In(e){return Object.keys(e).reduce(function(t,n){return n==="type"||(t[n]=Y(e[n])?Object.assign({},e[n]):e[n]),t},{})}function Sn(e,t,n){var r={};return function(o){return function(u){return function(c){try{var s,S=function(d){return s?d:u(m)},v=c.type,L=c.plugins,m=c;if(c.abort)return Promise.resolve(u(c));if(v===g.enablePlugin&&o.dispatch({type:g.initializeStart,plugins:L,disabled:[],fromEnable:!0,meta:c.meta}),v===g.disablePlugin&&setTimeout(function(){return It(c.meta.rid,{payload:c})},0),v===g.initializeEnd){var E=t(),h=Object.keys(E),T=h.filter(function(d){return L.includes(d)}).map(function(d){return E[d]}),P=[],b=[],_=c.disabled,$=T.map(function(d){var l=d.loaded,z=d.name,O=d.config;return St(d,function(){return l({config:O})},1e4).then(function(N){return r[z]||(o.dispatch({type:g.pluginReadyType(z),name:z,events:Object.keys(d).filter(function(M){return!Ke.includes(M)})}),r[z]=!0),P=P.concat(z),d}).catch(function(N){if(N instanceof Error)throw new Error(N);return b=b.concat(N.name),N})});Promise.all($).then(function(d){var l={plugins:P,failed:b,disabled:_};setTimeout(function(){h.length===$.length+_.length&&o.dispatch(p({},{type:g.ready},l))},0)})}var k=function(){if(v!==g.bootstrap)return/^ready:([^:]*)$/.test(v)&&setTimeout(function(){return Pt(o,t,e)},0),Promise.resolve(function(d,l,z,O,N){try{var M=K(l)?l():l,D=d.type,H=D.replace(ye,"");if(d._&&d._.called)return Promise.resolve(d);var C=z.getState(),X=(J=M,(F=C.plugins)===void 0&&(F={}),(je=d.options)===void 0&&(je={}),Object.keys(J).filter(function(i){var a=je.plugins||{};return nn(a[i])?a[i]:a.all!==!1&&(!F[i]||F[i].enabled!==!1)}).map(function(i){return J[i]}));D===g.initializeStart&&d.fromEnable&&(X=Object.keys(C.plugins).filter(function(i){var a=C.plugins[i];return d.plugins.includes(i)&&!a.initialized}).map(function(i){return M[i]}));var V=X.map(function(i){return i.name}),y=function(i,a,f){var w=_t(i).map(function(I){return At(I,a)});return a.reduce(function(I,x){var R=x.name,j=_t(i,R).map(function(ke){return At(ke,a)}),U=j[0],A=j[1],Q=j[2];return U.length&&(I.beforeNS[R]=U),A.length&&(I.duringNS[R]=A),Q.length&&(I.afterNS[R]=Q),I},{before:w[0],beforeNS:{},during:w[1],duringNS:{},after:w[2],afterNS:{}})}(D,X);return Promise.resolve(Ze({action:d,data:{exact:y.before,namespaced:y.beforeNS},state:C,allPlugins:M,allMatches:y,instance:z,store:O,EVENTS:N})).then(function(i){function a(){var I=function(){if(D.match(ye))return Promise.resolve(Ze({action:p({},f,{type:H+"End"}),data:{exact:y.after,namespaced:y.afterNS},state:C,allPlugins:M,allMatches:y,instance:z,store:O,EVENTS:N})).then(function(x){x.meta&&x.meta.hasCallback&&It(x.meta.rid,{payload:x})})}();return I&&I.then?I.then(function(){return i}):i}if(Nt(i,V.length))return i;var f,w=function(){if(D!==H)return Promise.resolve(Ze({action:p({},i,{type:H}),data:{exact:y.during,namespaced:y.duringNS},state:C,allPlugins:M,allMatches:y,instance:z,store:O,EVENTS:N})).then(function(I){f=I});f=i}();return w&&w.then?w.then(a):a()})}catch(i){return Promise.reject(i)}var J,F,je}(c,t,e,o,n)).then(function(d){return s=1,u(d)})}();return Promise.resolve(k&&k.then?k.then(S):S(k))}catch(d){return Promise.reject(d)}}}}}function Pn(e){return function(t){return function(n){return function(r){var o=r.type,u=r.key,c=r.value,s=r.options;if(o===g.setItem||o===g.removeItem){if(r.abort)return n(r);o===g.setItem?e.setItem(u,c,s):e.removeItem(u,s)}return n(r)}}}}var En=function(){var e=this;this.before=[],this.after=[],this.addMiddleware=function(t,n){e[n]=e[n].concat(t)},this.removeMiddleware=function(t,n){var r=e[n].findIndex(function(o){return o===t});r!==-1&&(e[n]=[].concat(e[n].slice(0,r),e[n].slice(r+1)))},this.dynamicMiddlewares=function(t){return function(n){return function(r){return function(o){var u={getState:n.getState,dispatch:function(s){return n.dispatch(s)}},c=e[t].map(function(s){return s(u)});return me.apply(void 0,c)(r)(o)}}}}};function On(e){return function(t,n){t===void 0&&(t={});var r={};if(n.type==="initialize:aborted")return t;if(/^registerPlugin:([^:]*)$/.test(n.type)){var o=Tt(n.type,"registerPlugin"),u=e()[o];if(!u||!o)return t;var c=n.enabled,s=u.config;return r[o]={enabled:c,initialized:!!c&&!u.initialize,loaded:!!c&&!!u.loaded({config:s}),config:s},p({},t,r)}if(/^initialize:([^:]*)$/.test(n.type)){var S=Tt(n.type,g.initialize),v=e()[S];return v&&S?(r[S]=p({},t[S],{initialized:!0,loaded:!!v.loaded({config:v.config})}),p({},t,r)):t}if(/^ready:([^:]*)$/.test(n.type))return r[n.name]=p({},t[n.name],{loaded:!0}),p({},t,r);switch(n.type){case g.disablePlugin:return p({},t,$t(n.plugins,!1,t));case g.enablePlugin:return p({},t,$t(n.plugins,!0,t));default:return t}}}function Tt(e,t){return e.substring(t.length+1,e.length)}function $t(e,t,n){return e.reduce(function(r,o){return r[o]=p({},n[o],{enabled:t}),r},n)}function zt(e){try{return JSON.parse(JSON.stringify(e))}catch{}return e}var xn={last:{},history:[]};function An(e,t){e===void 0&&(e=xn);var n=t.options,r=t.meta;if(t.type===g.track){var o=zt(p({event:t.event,properties:t.properties},Object.keys(n).length&&{options:n},{meta:r}));return p({},e,{last:o,history:e.history.concat(o)})}return e}var _n={actions:[]};function Nn(e,t){e===void 0&&(e=_n);var n=t.payload;switch(t.type){case"queue":var r;return r=n&&n.type&&n.type===g.identify?[t].concat(e.actions):e.actions.concat(t),p({},e,{actions:r});case"dequeue":return[];default:return e}}var Dt=/#.*$/;function jn(e){var t=/(http[s]?:\/\/)?([^\/\s]+\/)(.*)/g.exec(e);return"/"+(t&&t[3]?t[3].split("?")[0].replace(Dt,""):"")}var Lt,Mt,Ct,Ut,kn=function(e){if(e===void 0&&(e={}),!G)return e;var t=document,n=t.title,r=t.referrer,o=window,u=o.location,c=o.innerWidth,s=o.innerHeight,S=u.hash,v=u.search,L=function(E){var h=function(){if(G){for(var T,P=document.getElementsByTagName("link"),b=0;T=P[b];b++)if(T.getAttribute("rel")==="canonical")return T.getAttribute("href")}}();return h?h.match(/\?/)?h:h+E:window.location.href.replace(Dt,"")}(v),m={title:n,url:L,path:jn(L),hash:S,search:v,width:c,height:s};return r&&r!==""&&(m.referrer=r),p({},m,e)},Tn={last:{},history:[]};function $n(e,t){e===void 0&&(e=Tn);var n=t.options;if(t.type===g.page){var r=zt(p({properties:t.properties,meta:t.meta},Object.keys(n).length&&{options:n}));return p({},e,{last:r,history:e.history.concat(r)})}return e}Lt=function(){if(!G)return!1;var e=navigator.appVersion;return~e.indexOf("Win")?"Windows":~e.indexOf("Mac")?"MacOS":~e.indexOf("X11")?"UNIX":~e.indexOf("Linux")?"Linux":"Unknown OS"}(),Mt=G?document.referrer:null,Ct=ln(),Ut=fn();var Vt={initialized:!1,sessionId:Le(),app:null,version:null,debug:!1,offline:!!G&&!navigator.onLine,os:{name:Lt},userAgent:G?navigator.userAgent:"node",library:{name:"analytics",version:"0.12.14"},timezone:Ut,locale:Ct,campaign:{},referrer:Mt};function zn(e,t){e===void 0&&(e=Vt);var n=e.initialized,r=t.campaign;switch(t.type){case g.campaign:return p({},e,{campaign:r});case g.offline:return p({},e,{offline:!0});case g.online:return p({},e,{offline:!1});default:return n?e:p({},Vt,e,{initialized:!0})}}var Dn=["plugins","reducers","storage"];function Ln(e,t,n){if(G){var r=window[(n?"add":"remove")+"EventListener"];e.split(" ").forEach(function(o){r(o,t)})}}function Mn(e){var t=Ln.bind(null,"online offline",function(n){return Promise.resolve(!navigator.onLine).then(e)});return t(!0),function(n){return t(!1)}}function qt(){return ae("analytics",[]),function(e){return function(t,n,r){var o=e(t,n,r),u=o.dispatch;return Object.assign(o,{dispatch:function(c){return de[fe].analytics.push(c.action||c),u(c)}})}}}function Rt(e){return function(){return me(me.apply(null,arguments),qt())}}function nt(e){return e?an(e)?e:[e]:[]}function Wt(e,t,n){e===void 0&&(e={});var r,o,u=Le();return t&&(Ee[u]=(r=t,o=function(c){for(var s,S=c||Array.prototype.slice.call(arguments),v=0;v<S.length;v++)if(K(S[v])){s=S[v];break}return s}(n),function(c){o&&o(c),r(c)})),p({},e,{rid:u,ts:new Date().getTime()},t?{hasCallback:!0}:{})}function Cn(e){e===void 0&&(e={});var t=e.reducers||{},n=e.initialUser||{},r=(e.plugins||[]).reduce(function(i,a){if(K(a))return i.middlewares=i.middlewares.concat(a),i;if(a.NAMESPACE&&(a.name=a.NAMESPACE),!a.name)throw new Error("https://lytics.dev/errors/1");a.config||(a.config={});var f=a.EVENTS?Object.keys(a.EVENTS).map(function(x){return a.EVENTS[x]}):[];i.pluginEnabled[a.name]=!(a.enabled===!1||a.config.enabled===!1),delete a.enabled,a.methods&&(i.methods[a.name]=Object.keys(a.methods).reduce(function(x,R){var j;return x[R]=(j=a.methods[R],function(){for(var U=Array.prototype.slice.call(arguments),A=new Array(j.length),Q=0;Q<U.length;Q++)A[Q]=U[Q];return A[A.length]=l,j.apply({instance:l},A)}),x},{}),delete a.methods);var w=Object.keys(a).concat(f),I=new Set(i.events.concat(w));if(i.events=Array.from(I),i.pluginsArray=i.pluginsArray.concat(a),i.plugins[a.name])throw new Error(a.name+"AlreadyLoaded");return i.plugins[a.name]=a,i.plugins[a.name].loaded||(i.plugins[a.name].loaded=function(){return!0}),i},{plugins:{},pluginEnabled:{},methods:{},pluginsArray:[],middlewares:[],events:[]}),o=e.storage?e.storage:{getItem:ie,setItem:ae,removeItem:pe},u=function(i){return function(a,f,w){return f.getState("user")[a]||(w&&Y(w)&&w[a]?w[a]:wt(i)[a]||ie(Qe(a))||null)}}(o),c=r.plugins,s=r.events.filter(function(i){return!Ke.includes(i)}).sort(),S=new Set(s.concat(Ue).filter(function(i){return!Ke.includes(i)})),v=Array.from(S).sort(),L=function(){return c},m=new En,E=m.addMiddleware,h=m.removeMiddleware,T=m.dynamicMiddlewares,P=function(){throw new Error("Abort disabled inListener")},b=dn(),_=wt(o),$=p({},_,n,b.an_uid?{userId:b.an_uid}:{},b.an_aid?{anonymousId:b.an_aid}:{});$.anonymousId||($.anonymousId=Le());var k=p({enable:function(i,a){return new Promise(function(f){y.dispatch({type:g.enablePlugin,plugins:nt(i),_:{originalAction:g.enablePlugin}},f,[a])})},disable:function(i,a){return new Promise(function(f){y.dispatch({type:g.disablePlugin,plugins:nt(i),_:{originalAction:g.disablePlugin}},f,[a])})}},r.methods),d=!1,l={identify:function(i,a,f,w){try{var I=se(i)?i:null,x=Y(i)?i:a,R=f||{},j=l.user();ae(Qe(ne),I);var U=I||x.userId||u(ne,l,x);return Promise.resolve(new Promise(function(A){y.dispatch(p({type:g.identifyStart,userId:U,traits:x||{},options:R,anonymousId:j.anonymousId},j.id&&j.id!==I&&{previousId:j.id}),A,[a,f,w])}))}catch(A){return Promise.reject(A)}},track:function(i,a,f,w){try{var I=Y(i)?i.event:i;if(!I||!se(I))throw new Error("EventMissing");var x=Y(i)?i:a||{},R=Y(f)?f:{};return Promise.resolve(new Promise(function(j){y.dispatch({type:g.trackStart,event:I,properties:x,options:R,userId:u(ne,l,a),anonymousId:u(he,l,a)},j,[a,f,w])}))}catch(j){return Promise.reject(j)}},page:function(i,a,f){try{var w=Y(i)?i:{},I=Y(a)?a:{};return Promise.resolve(new Promise(function(x){y.dispatch({type:g.pageStart,properties:kn(w),options:I,userId:u(ne,l,w),anonymousId:u(he,l,w)},x,[i,a,f])}))}catch(x){return Promise.reject(x)}},user:function(i){if(i===ne||i==="id")return u(ne,l);if(i===he||i==="anonId")return u(he,l);var a=l.getState("user");return i?W(a,i):a},reset:function(i){return new Promise(function(a){y.dispatch({type:g.resetStart},a,i)})},ready:function(i){return d&&i({plugins:k,instance:l}),l.on(g.ready,function(a){i(a),d=!0})},on:function(i,a){if(!i||!K(a))return!1;if(i===g.bootstrap)throw new Error(".on disabled for "+i);var f=/Start$|Start:/;if(i==="*"){var w=function(j){return function(U){return function(A){return A.type.match(f)&&a({payload:A,instance:l,plugins:c}),U(A)}}},I=function(j){return function(U){return function(A){return A.type.match(f)||a({payload:A,instance:l,plugins:c}),U(A)}}};return E(w,Ve),E(I,qe),function(){h(w,Ve),h(I,qe)}}var x=i.match(f)?Ve:qe,R=function(j){return function(U){return function(A){return A.type===i&&a({payload:A,instance:l,plugins:c,abort:P}),U(A)}}};return E(R,x),function(){return h(R,x)}},once:function(i,a){if(!i||!K(a))return!1;if(i===g.bootstrap)throw new Error(".once disabled for "+i);var f=l.on(i,function(w){a({payload:w.payload,instance:l,plugins:c,abort:P}),f()});return f},getState:function(i){var a=y.getState();return i?W(a,i):Object.assign({},a)},dispatch:function(i){var a=se(i)?{type:i}:i;if(Ue.includes(a.type))throw new Error("reserved action "+a.type);var f=p({},a,{_:p({originalAction:a.type},i._||{})});y.dispatch(f)},enablePlugin:k.enable,disablePlugin:k.disable,plugins:k,storage:{getItem:o.getItem,setItem:function(i,a,f){y.dispatch({type:g.setItemStart,key:i,value:a,options:f})},removeItem:function(i,a){y.dispatch({type:g.removeItemStart,key:i,options:a})}},setAnonymousId:function(i,a){l.storage.setItem(te,i,a)},events:{core:Ue,plugins:s}},z=r.middlewares.concat([function(i){return function(a){return function(f){return f.meta||(f.meta=Wt()),a(f)}}},T(Ve),Sn(l,L,{all:v,plugins:s}),Pn(o),hn(l),bn(l),T(qe)]),O={context:zn,user:yn(o),page:$n,track:An,plugins:On(L),queue:Nn},N=me,M=me;if(G&&e.debug){var D=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__;D&&(N=D({trace:!0,traceLimit:25})),M=function(){return arguments.length===0?qt():Y(typeof arguments[0])?Rt():Rt().apply(null,arguments)}}var H,C=function(i){return Object.keys(i).reduce(function(a,f){return Dn.includes(f)||(a[f]=i[f]),a},{})}(e),X=r.pluginsArray.reduce(function(i,a){var f=a.name,w=a.config,I=a.loaded,x=r.pluginEnabled[f];return i[f]={enabled:x,initialized:!!x&&!a.initialize,loaded:!!I({config:w}),config:w},i},{}),V={context:C,user:$,plugins:X},y=vt(function(i){for(var a=Object.keys(i),f={},w=0;w<a.length;w++){var I=a[w];typeof i[I]===ee&&(f[I]=i[I])}var x,R=Object.keys(f);try{(function(j){Object.keys(j).forEach(function(U){var A=j[U];if(typeof A(void 0,{type:"@@redux/INIT"})===Z||typeof A(void 0,{type:gn})===Z)throw new Error("reducer "+U+" "+Z)})})(f)}catch(j){x=j}return function(j,U){if(j===void 0&&(j={}),x)throw x;for(var A=!1,Q={},ke=0;ke<R.length;ke++){var Fe=R[ke],Kt=j[Fe],st=(0,f[Fe])(Kt,U);if(typeof st===Z){var ir=mn(Fe,U);throw new Error(ir)}Q[Fe]=st,A=A||st!==Kt}return A?Q:j}}(p({},O,t)),V,M(N(vn.apply(void 0,z))));y.dispatch=(H=y.dispatch,function(i,a,f){var w=p({},i,{meta:Wt(i.meta,a,nt(f))});return H.apply(null,[w])});var J=Object.keys(c);y.dispatch({type:g.bootstrap,plugins:J,config:C,params:b,user:$,initialUser:n,persistedUser:_});var F=J.filter(function(i){return r.pluginEnabled[i]}),je=J.filter(function(i){return!r.pluginEnabled[i]});return y.dispatch({type:g.registerPlugins,plugins:J,enabled:r.pluginEnabled}),r.pluginsArray.map(function(i,a){var f=i.bootstrap,w=i.config,I=i.name;f&&K(f)&&f({instance:l,config:w,payload:i}),y.dispatch({type:g.registerPluginType(I),name:I,enabled:r.pluginEnabled[I],plugin:i}),r.pluginsArray.length===a+1&&y.dispatch({type:g.initializeStart,plugins:F,disabled:je})}),Mn(function(i){y.dispatch({type:i?g.offline:g.online})}),function(i,a,f){setInterval(function(){return Pt(i,a,f)},3e3)}(y,L,l),l}var Ve="before",qe="after",xe="cookie",ue=Ft(),Jt=Re,Un=Re;function Yt(e){return ue?Re(e,"",-1):pe(e)}function Ft(){if(ue!==void 0)return ue;var e="cookiecookie";try{Re(e,e),ue=document.cookie.indexOf(e)!==-1,Yt(e)}catch{ue=!1}return ue}function Re(e,t,n,r,o,u){if(typeof window<"u"){var c=arguments.length>1;return ue===!1&&(c?ae(e,t):ie(e)),c?document.cookie=e+"="+encodeURIComponent(t)+(n?"; expires="+new Date(+new Date+1e3*n).toUTCString()+(r?"; path="+r:"")+(o?"; domain="+o:"")+(u?"; secure":""):""):decodeURIComponent((("; "+document.cookie).split("; "+e+"=")[1]||"").split(";")[0])}}var Ae="localStorage",Vn=Ge.bind(null,"localStorage");ge("localStorage","getItem",ie),ge("localStorage","setItem",ae),ge("localStorage","removeItem",pe);var _e="sessionStorage",qn=Ge.bind(null,"sessionStorage");ge("sessionStorage","getItem",ie),ge("sessionStorage","setItem",ae),ge("sessionStorage","removeItem",pe);function be(e){var t=e;try{if((t=JSON.parse(e))==="true")return!0;if(t==="false")return!1;if(Y(t))return t;parseFloat(t)===t&&(t=parseFloat(t))}catch{}if(t!==null&&t!=="")return t}var Rn=Vn(),Wn=qn(),Jn=Ft();function Bt(e,t){if(e){var n=rt(t),r=!ut(n),o=it(n)?be(localStorage.getItem(e)):void 0;if(r&&!le(o))return o;var u=at(n)?be(Jt(e)):void 0;if(r&&u)return u;var c=ot(n)?be(sessionStorage.getItem(e)):void 0;if(r&&c)return c;var s=ie(e);return r?s:{localStorage:o,sessionStorage:c,cookie:u,global:s}}}function Yn(e,t,n){if(e&&!le(t)){var r={},o=rt(n),u=JSON.stringify(t),c=!ut(o);return it(o)&&(r[Ae]=Je(Ae,t,be(localStorage.getItem(e))),localStorage.setItem(e,u),c)?r[Ae]:at(o)&&(r[xe]=Je(xe,t,be(Jt(e))),Un(e,u),c)?r[xe]:ot(o)&&(r[_e]=Je(_e,t,be(sessionStorage.getItem(e))),sessionStorage.setItem(e,u),c)?r[_e]:(r[Pe]=Je(Pe,t,ie(e)),ae(e,t),c?r[Pe]:r)}}function Fn(e,t){if(e){var n=rt(t),r=Bt(e,lt),o={};return!le(r.localStorage)&&it(n)&&(localStorage.removeItem(e),o[Ae]=r.localStorage),!le(r.cookie)&&at(n)&&(Yt(e),o[xe]=r.cookie),!le(r.sessionStorage)&&ot(n)&&(sessionStorage.removeItem(e),o[_e]=r.sessionStorage),!le(r.global)&&We(n,Pe)&&(pe(e),o[Pe]=r.global),o}}function rt(e){return e?se(e)?e:e.storage:Ie}function it(e){return Rn&&We(e,Ae)}function at(e){return Jn&&We(e,xe)}function ot(e){return Wn&&We(e,_e)}function ut(e){return e===lt||e==="all"}function We(e,t){return e===Ie||e===t||ut(e)}function Je(e,t,n){return{location:e,current:t,previous:n}}var Bn={setItem:Yn,getItem:Bt,removeItem:Fn};function Hn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ht(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function Xt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ht(Object(n),!0).forEach(function(r){Hn(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ht(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Xn(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t={storage:Bn};return Cn(Xt(Xt({},t),e))}const Gt="dotAnalytics",Gn=Gt,Kn="/api/v1/analytics/content/event",Qn="PAGE_REQUEST",Zn=async(e,t)=>{const n={...e,timestamp:new Date().toISOString()};t.debug&&console.warn("DotAnalytics: Sending event:",n);try{return await fetch(`${t.server}${Kn}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})}catch(r){throw console.error("DotAnalytics: Error sending event:",r),r}},er=e=>{const t=tr();return{server:t.getAttribute("data-analytics-server")||e.href,debug:t.hasAttribute("data-analytics-debug"),autoPageView:t.hasAttribute("data-analytics-auto-page-view"),key:t.getAttribute("data-analytics-key")||""}},tr=()=>{const e=document.querySelector("script[data-analytics-server]");if(!e)throw new Error("Analytics script not found");return e};function nr(e,t){const n=new URLSearchParams(t.search),r={source:n.get("utm_source")||void 0,medium:n.get("utm_medium")||void 0,campaign:n.get("utm_campaign")||void 0,id:n.get("utm_id")||void 0},o=window.innerWidth,u=window.innerHeight,c=navigator.language,s=document.characterSet;return{event_type:e,utc_time:new Date().toISOString(),local_tz_offset:new Date().getTimezoneOffset(),referer:document.referrer,url:t.href,page_title:document.title,doc_path:t.pathname,doc_host:t.hostname,doc_protocol:t.protocol,doc_hash:t.hash,doc_search:t.search,screen_resolution:`${window.screen.width}x${window.screen.height}`,vp_size:`${o}x${u}`,user_agent:navigator.userAgent,user_language:c,doc_encoding:s,utm:r,src:Gn}}const rr=e=>{let t=!1;return{name:"dot-analytics",config:e,initialize:({config:n})=>{if(!n.server)throw new Error("DotAnalytics: Server URL is required");if(n.debug&&console.warn("DotAnalytics: Initialized with config",n),t=!0,n.autoPageView){const r={type:"track",key:n.key,...nr(Qn,window.location)};return Zn(r,n)}return Promise.resolve()},loaded:()=>t}},ce=class ce{constructor(t){He(this,Ne,!1);He(this,Ye,null);He(this,we,void 0);Xe(this,we,t)}static getInstance(t){return ce.instance||(ce.instance=new ce(t)),ce.instance}async ready(){if(Be(this,Ne))return Promise.resolve();try{Xe(this,Ye,Xn({app:"dotAnalytics",debug:Be(this,we).debug,plugins:[rr(Be(this,we))]})),Xe(this,Ne,!0)}catch(t){throw console.error("Failed to initialize DotAnalytics:",t),t}}};Ne=new WeakMap,Ye=new WeakMap,we=new WeakMap,ce.instance=null;let ct=ce;(async()=>{const e=er(window.location),t=ct.getInstance({...e});await t.ready(),window[Gt]=t})().catch(e=>{console.error("Failed to initialize analytics:",e)})})();
