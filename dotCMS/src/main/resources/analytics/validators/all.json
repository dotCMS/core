{
  "context": {
    "type": "json_object",
    "required": true,

    "allowed_attributes": {
      "site_auth": {
        "type": "string",
        "required": true,
        "custom-validator": "SiteAuthValidator"
      },
      "session_id": {
        "type": "string",
        "required": true
      },
      "user_id": {
        "type": "string",
        "required": true
      },
      "device": {
        "type": "json_object",
        "required": true,

        "allowed_attributes": {
          "screen_resolution": {
            "type": "string",
            "required": true
          },
          "language": {
            "type": "string",
            "required": true
          },
          "viewport_width": {
            "type": "string",
            "required": true
          },
          "viewport_height": {
            "type": "string",
            "required": true
          }
        }
      }
    }
  },
  "events": {
    "type": "json_array",
    "array_type": "json_object",
    "required": true,

    "allowed_attributes": {
        "event_type": {
          "type": "string",
          "required": true
        },
        "local_time": {
          "type": "date",
          "required": true
        },
        "data": {
          "type": "json_object",

          "allowed_attributes": {
            "custom": {
              "type": "json_object"
            }
          }
        }
    }
  }
}