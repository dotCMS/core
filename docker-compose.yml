version: '3.7'
networks:
    es_net:
volumes:
    esdata:
services:
    database:
        image: postgres:14.7-alpine
        command: postgres -c 'max_connections=400' -c 'shared_buffers=128MB'
        environment:
            POSTGRES_USER: postgres
            POSTGRES_PASSWORD: admin
            POSTGRES_DB: dotcms
        ports:
            - '5432:5432'
        tmpfs:
            - /var/lib/postgresql/data:rw
    elasticsearch:
        container_name: dot_opendistro
        image: docker.elastic.co/elasticsearch/elasticsearch:7.10.2
        environment:
            - cluster.name=elastic-cluster
            - discovery.type=single-node
            - data
            - bootstrap.memory_lock=true
            - 'ES_JAVA_OPTS=-Xmx1G '
        ports:
            - 9200:9200
            - 9600:9600
        volumes:
            - esdata:/usr/share/elasticsearch/data
        networks:
            - es_net
