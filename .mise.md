# Mise Configuration for dotCMS

This repository uses [mise](https://mise.jdx.dev/) for managing development tool versions, including GitHub CLI and Python.

## What is Mise?

Mise (formerly rtx) is a polyglot tool version manager. It automatically installs and manages versions of tools like Python, Node.js, GitHub CLI, and many others.

## Quick Start

### 1. Install Mise

```bash
# macOS
brew install mise

# Or using the official installer
curl https://mise.run | sh
```

### 2. Activate Mise in Your Shell

Add to your `~/.zshrc` (for zsh) or `~/.bashrc` (for bash):

```bash
eval "$(mise activate zsh)"  # for zsh
eval "$(mise activate bash)" # for bash
```

Then reload your shell:

```bash
source ~/.zshrc  # or source ~/.bashrc
# Or restart your terminal
```

### 3. Install Tools

Navigate to the repository and mise will automatically install configured tools:

```bash
cd /path/to/dotcms/core
mise install
```

Or let mise auto-install when you enter the directory:

```bash
cd /path/to/dotcms/core
# Tools will install automatically if auto_install is enabled
```

## Configured Tools

The `.mise.toml` file configures these tools:

- **gh (GitHub CLI)** - `latest` version
  - Used for issue and PR management
  - Commands: `gh issue`, `gh pr`, etc.

- **python** - `3.11.x` (latest 3.11)
  - Used for cicd-diagnostics skill
  - Automatically creates virtual environment in `.venv/`

## Usage

### Verify Installation

```bash
mise doctor
```

### List Installed Tools

```bash
mise list
```

### Check Current Tool Versions

```bash
gh --version
python --version
```

### Python Virtual Environment

Mise automatically creates a Python virtual environment in `.venv/`:

```bash
# Activate venv (if needed manually)
source .venv/bin/activate

# Install cicd-diagnostics dependencies
pip install -r .claude/skills/cicd-diagnostics/requirements.txt

# Deactivate venv
deactivate
```

## Benefits of Using Mise

1. **Consistent versions** - Everyone uses the same tool versions
2. **Automatic installation** - Tools install when entering the directory
3. **Per-project configuration** - Each project can have different versions
4. **Virtual environment management** - Automatic Python venv creation
5. **No PATH pollution** - Tools only available in project directory

## Troubleshooting

### Tools not found

If `gh` or `python` commands still point to system versions:

```bash
# Check if mise is activated
mise doctor

# If not, activate mise
eval "$(mise activate $(basename $SHELL))"

# Or add to your shell rc file permanently
```

### Force reinstall tools

```bash
mise install --force
```

### Clear mise cache

```bash
mise cache clear
```

## Related Documentation

- [Mise Documentation](https://mise.jdx.dev/)
- [GitHub CLI Documentation](https://cli.github.com/manual/)
- [Python Documentation](https://docs.python.org/3.11/)

## CI/CD Diagnostics Skill

The Python installation is primarily for the cicd-diagnostics skill:

```bash
# All scripts use the mise-managed Python
.claude/skills/cicd-diagnostics/fetch-logs.py
.claude/skills/cicd-diagnostics/fetch-jobs.py
.claude/skills/cicd-diagnostics/fetch-metadata.py
```

See `.claude/skills/cicd-diagnostics/README.md` for skill documentation.
