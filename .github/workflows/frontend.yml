name: Frontend
on:
  pull_request:
    types: [synchronize, opened, reopened, ready_for_review]
  push:
    paths:
      - 'core-web/**'
    branches:
      - master
      - release-*
env:
  GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
  GH_TOKEN: ${{ secrets.CICD_GITHUB_TOKEN }}
  PULL_REQUEST_URL: ${{ github.event.pull_request._links.html.href }}
  IS_PULL_REQUEST: ${{ github.event_name == 'pull_request' }}
  HEAD_REF: ${{ github.head_ref }}
jobs:
  test-all:
    runs-on: ubuntu-latest # the image our job will run on
    name: Test core-web # the name that will appear on the Actions UI
    steps: # what steps it will perform
      - uses: actions/checkout@v3 # checkout whatever branch the PR is using
        with:
          fetch-depth: 0
      - uses: actions/setup-node@v3
        with:
          node-version: 16.14.2
      - uses: bahmutov/npm-install@v1 # trigger an `npm install`
        with:
          working-directory: core-web
      # - run: cd core-web && npx nx affected --target=lint --base=origin/master --parallel --exclude=dot-rules,dot-layout-grid,dot-primeng-theme-styles,dot-rules,dotcms,dotcms-field-elements,dotcms-js,dotcms-models,dotcms-webcomponents,dotcdn-e2e,dotcms-block-editor,dotcms-block-editor-e2e,dotcms-ui-e2e,utils-testing
      # - run: cd core-web && npx nx affected --target=build --base=origin/master --parallel --exclude=dot-rules,dot-layout-grid,dot-primeng-theme-styles,dot-rules,dotcms,dotcms-field-elements,dotcms-js,dotcms-models,dotcms-webcomponents,dotcdn-e2e,dotcms-block-editor,dotcms-block-editor-e2e,dotcms-ui-e2e,utils-testing
      - run: cd core-web && npx nx affected --target=test --base=origin/master --parallel --exclude=dot-rules,dot-layout-grid,dot-primeng-theme-styles,dot-rules,dotcms,dotcms-field-elements,dotcms-js,dotcms-models,dotcms-webcomponents,dotcdn-e2e,dotcms-block-editor,dotcms-block-editor-e2e,dotcms-ui-e2e,utils-testing,block-editor,utils