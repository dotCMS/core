@if ($showMainSkeleton()) {
    <dot-category-field-list-skeleton />
} @else {
    @if ($categories().length) {
        <div
            class="w-full flex items-center h-12 px-6 py-2 text-base font-semibold border-b border-(--gray-400)  ">
            <dot-collapse-breadcrumb data-testId="breadcrumb-menu" [model]="$breadcrumbsMenu()" />
        </div>
        <div
            [ngClass]="{ 'overflow-x-hidden': $emptyColumns().length }"
            class="flex-1 flex overflow-x-auto overflow-y-hidden">
            @for (column of $categories(); let index = $index; track index) {
                <!--dynamic columns-->
                <div
                    #categoryColumn
                    class="flex-[0_0_38%] border-r border-(--gray-400) overflow-y-auto h-full p-2 last:border-r-0"
                    data-testId="category-column">
                    @for (item of column; track item.key) {
                        <div
                            data-testId="category-item"
                            class="flex content-center items-center h-10 flex-nowrap transition-colors duration-200 animate-[fadeIn_0.2s_ease-out] animate-fill-forwards hover:bg-(--color-palette-primary-100)"
                            [ngClass]="{ 'bg-(--color-palette-primary-200)': item.clicked }">
                            <p-checkbox
                                [(ngModel)]="$selected"
                                [value]="item.key"
                                class="ml-2"
                                (onChange)="itemChecked.emit({ selected: $event.checked, item })" />

                        
                            <div
                                data-testId="category-item-wrapper"
                                class="flex w-full h-full items-stretch content-center pl-4 pr-2 overflow-hidden"
                                (click)="rowClicked.emit({ index, item })"
                                [class.cursor-pointer]="item.hasChildren">
                                <div
                                    class="flex w-full gap-1 content-center items-center justify-between">
                                    <label
                                        data-testId="category-item-label"
                                        class="truncate"
                                        [class.cursor-pointer]="item.hasChildren"
                                        [for]="item.key">
                                        {{ item.value }}
                                    </label>

                                    @if (item.hasChildren) {
                                        <i
                                            data-testId="category-item-with-child"
                                            class="pi pi-chevron-right text-(--color-palette-primary-500) cursor-pointer"></i>
                                    }
                                </div>
                            </div>
                        </div>
                    }
                </div>
            }

            <!--Fake empty columns-->
            @for (_ of $emptyColumns(); track $index) {
                <div
                    class="grow border-r border-(--gray-400) overflow-y-auto h-full p-2 last:border-r-0"
                    data-testId="category-column-empty">
                    @if ($state() === stateList.LOADING && 0 === $index) {
                        <dot-category-field-list-skeleton />
                    }
                </div>
            }
        </div>
    } @else {
        <dot-empty-container [configuration]="$emptyState()" [hideContactUsLink]="true" />
    }
}
