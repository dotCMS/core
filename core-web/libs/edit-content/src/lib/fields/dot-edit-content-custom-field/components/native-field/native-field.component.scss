@use "variables" as *;
@import "mixins";

:host {
    ::ng-deep {
        input:not([type="checkbox"]):not([type="radio"]):not([type="button"]):not(
                [type="submit"]
            ):not([type="reset"]),
        select,
        textarea {
            width: 100%;
            background-color: $white;
            height: $field-height-md;
            border-radius: $field-border-radius;
            border: $field-border-size solid $color-palette-gray-400;
            padding: 0 $spacing-1;
            color: $color-palette-gray-700;
            font-size: $font-size-md;
            font-family: $font-default;
            outline: none;
            transition:
                border-color $basic-speed,
                box-shadow $basic-speed;

            &::placeholder {
                color: $label-color;
            }

            &:enabled:hover,
            &:hover {
                border-color: $color-palette-primary-400;
            }

            &:enabled:active,
            &:enabled:focus,
            &:active,
            &:focus {
                border-color: $color-palette-primary-400;
                @include field-focus;
            }

            &:disabled {
                border-color: $color-palette-gray-200;
                background: $color-palette-gray-100;
                color: $color-palette-gray-500;
                cursor: not-allowed;

                &::placeholder {
                    color: $color-palette-gray-500;
                }
            }

            &.p-filled {
                color: $black;
            }
        }

        textarea {
            padding: $spacing-1;
            min-height: 4rem;
            resize: vertical;
        }

        select {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%237e7a86' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right $spacing-1 center;
            padding-right: $spacing-6;
        }

        button:not(.p-button):not(.custom-select-button):not(.custom-button),
        input[type="button"],
        input[type="submit"],
        input[type="reset"] {
            border: none;
            color: $white;
            background-color: $color-palette-primary;
            border-radius: $border-radius-md;
            font-size: $font-size-md;
            font-family: $font-default;
            height: $field-height-md;
            padding: 0 $spacing-3;
            cursor: pointer;
            transition:
                background-color $basic-speed,
                box-shadow $basic-speed;
            text-transform: capitalize;
            outline: none;

            &:hover:not(:disabled) {
                background-color: $color-palette-primary-600;
            }

            &:active:not(:disabled) {
                background-color: $color-palette-primary-700;
            }

            &:focus:not(:disabled) {
                background-color: $color-palette-primary;
                @include field-focus;
            }

            &:disabled {
                background-color: $color-palette-gray-200;
                color: $color-palette-gray-500;
                cursor: not-allowed;
            }
        }

        /* Shared custom dropdown/select styles (template field, tag storage field, etc.) */
        .custom-field-wrapper,
        .tag-storage-field-wrapper {
            font-family: $font-default;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            max-width: 100%;
            min-height: 2.5rem;
        }

        .select-wrapper,
        .tag-storage-select-wrapper {
            position: relative;
            width: 100%;
        }

        .custom-select-button,
        .tag-storage-custom-select-button {
            width: 100%;
            padding: 0.5rem 3rem 0.5rem 0.75rem;
            font-size: 0.875rem;
            line-height: 1.5;
            color: $color-palette-gray-700;
            background-color: $white;
            border: 1px solid ;
            border-radius: 6px;
            cursor: pointer;
            outline: none;
            transition: border-color 0.2s;
            text-align: left;
            position: relative;
            box-shadow: inset 0 0 0 1px
                color-mix(in srgb, $color-palette-primary-500 20%, transparent);
            min-height: 2.5rem;

            &::after {
                content: "";
                position: absolute;
                right: 0;
                top: 0;
                bottom: 0;
                width: 40px;
                background-color: $color-palette-gray-100;
                border-top-right-radius: 6px;
                border-bottom-right-radius: 6px;
                background-image:
                    linear-gradient(
                        45deg,
                        transparent 50%,
                        $color-palette-primary-500 50%
                    ),
                    linear-gradient(
                        135deg,
                        $color-palette-primary-500 50%,
                        transparent 50%
                    );
                background-position:
                    calc(50% - 3px) calc(50% + 1px),
                    calc(50% + 2px) calc(50% + 1px);
                background-size: 5px 5px, 5px 5px;
                background-repeat: no-repeat;
                pointer-events: none;
            }

            &:focus {
                border-color: $color-palette-primary-500;
                box-shadow:
                    inset 0 0 0 1px
                        color-mix(in srgb, $color-palette-primary-500 30%, transparent),
                    0 0 0 2px
                        color-mix(in srgb, $color-palette-primary-500 10%, transparent);
            }

            &:hover {
                border-color: $color-palette-primary-500;
            }

            &.placeholder {
                color: $color-palette-gray-500;
            }

            &:disabled {
                opacity: 0.6;
                cursor: not-allowed;
            }
        }

        .custom-dropdown,
        .tag-storage-custom-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background-color: $white;
            border: 1px solid $color-palette-gray-400;
            border-radius: 6px;
            box-shadow:
                0 4px 6px -1px rgba(0, 0, 0, 0.1),
                0 2px 4px -1px rgba(0, 0, 0, 0.06);
            margin-top: 0.25rem;
            max-height: 400px;
            overflow-y: auto;
            z-index: 1000;
            display: none;

            &.open {
                display: block;
            }

            &::-webkit-scrollbar {
                width: 8px;
            }

            &::-webkit-scrollbar-track {
                background: $color-palette-gray-100;
            }

            &::-webkit-scrollbar-thumb {
                background: $color-palette-gray-400;
                border-radius: 4px;
            }

            &::-webkit-scrollbar-thumb:hover {
                background: $color-palette-gray-500;
            }
        }

        .custom-option,
        .tag-storage-custom-option {
            padding: 0.75rem 1rem;
            cursor: pointer;
            border-bottom: 1px solid $color-palette-gray-100;
            transition: background-color 0.15s;

            &:last-child {
                border-bottom: none;
            }

            &:hover {
                background-color: $color-palette-gray-200;
            }

            &.selected {
                background-color: #dbeafe;
            }
        }

        .option-title,
        .tag-storage-option-title {
            font-size: 0.875rem;
            color: $color-palette-gray-700;
            font-weight: 400;
            margin-bottom: 0.25rem;
        }

        .option-subtitle {
            font-size: 0.75rem;
            color: $color-palette-gray-500;
            font-weight: 400;
        }

        .custom-option.placeholder .option-title {
            color: $color-palette-gray-500;
            font-style: italic;
        }

        .more-choices-button {
            padding: 0.75rem 1rem;
            text-align: center;
            cursor: pointer;
            color: $color-palette-gray-700;
            font-size: 0.875rem;
            border-top: 1px solid $color-palette-gray-200;
            background-color: $white;
            transition: background-color 0.15s;

            &:hover {
                background-color: $color-palette-gray-100;
            }

            &:active {
                background-color: $color-palette-gray-200;
            }

            &.loading {
                color: $color-palette-gray-500;
                cursor: wait;
            }
        }
    }
}
