<form
    (ngSubmit)="onSubmit()"
    [formGroup]="form"
    class="h-full flex flex-col justify-center items-start">
    @if (store.allowFileNameEdit()) {
        <div class="w-full flex flex-col gap-2">
            <label class="p-label-input-required" data-testid="editor-label" for="file-name">
                {{ 'dot.file.field.action.create.new.file.label' | dm }}
            </label>
            <input
                id="file-name"
                autocomplete="off"
                formControlName="name"
                pInputText
                placeholder="Ex. template.html"
                type="text"
                data-testid="editor-file-name" />
            <div class="min-h-6 flex justify-start">
                @let error = store.error();
                @if (error) {
                    <small class="p-invalid" data-testid="error-msg">
                        {{ error | dm: [store.allowFiles()] }}
                    </small>
                } @else {
                    <dot-field-validation-message
                        [field]="nameField"
                        [patternErrorMessage]="'dot.file.field.error.type.file.not.extension'"
                        data-testid="error-message" />
                }
            </div>
        </div>
    }
    <div class="flex flex-col flex-1 w-full gap-2">
        <ngx-monaco-editor
            class="block flex-grow w-full min-h-[30rem] border border-gray-400 rounded-md overflow-auto relative"
            [class.bg-gray-200]="form.disabled"
            [class.opacity-50]="form.disabled"
            [class.code-editor-disabled]="form.disabled"
            [options]="store.monacoConfig()"
            (init)="onEditorInit($event)"
            data-testid="code-editor"
            formControlName="content" />

        @let file = store.file();
        <div
            class="flex items-center gap-2 text-gray-700 text-sm"
            [class.invisible]="!file.mimeType">
            <i class="pi pi-info-circle"></i>
            <small>Mime Type: {{ file.mimeType }}</small>
        </div>
    </div>
    <div class="w-full flex gap-2 items-center justify-end">
        <p-button
            (click)="cancelUpload()"
            [label]="'dot.common.cancel' | dm"
            aria-label="Cancel button"
            data-testid="cancel-button"
            styleClass="p-button-outlined"
            type="button" />

        <p-button
            [label]="'dot.common.save' | dm"
            aria-label="Import button"
            data-testid="import-button"
            type="submit" />
    </div>
</form>
