@let field = $field();
@let showLabel = $showLabel();
@let systemTimezone = $systemTimezone();
@let showTimezoneInfo = $showTimezoneInfo();
@let hasTimezone = showTimezoneInfo && systemTimezone;
@let hasHint = field.hint;
@let fieldHasError = $hasError();

<dot-card-field [hasError]="fieldHasError">
    @if (showLabel) {
        <dot-card-field-label
            [variableName]="field.variable"
            [isRequired]="isRequired"
            [hint]="hasTimezone ? field.hint : null">
            {{ field.name }}
        </dot-card-field-label>
    }
    <dot-card-field-content>
        <dot-calendar-field
            [field]="field"
            [hasError]="fieldHasError"
            [formControlName]="field.variable"
            [utcTimezone]="systemTimezone"
            [contentType]="$contentType()" />
    </dot-card-field-content>
    <dot-card-field-footer>
        <div class="flex justify-between items-center">
            <div class="grow">
                @if (fieldHasError) {
                    <div class="error-message">
                        @if (isRequired) {
                            <small>{{ 'dot.edit.content.form.field.required' | dm }}</small>
                        }
                    </div>
                }

                @if (!fieldHasError && !hasTimezone && hasHint) {
                    <div class="hint-message" data-testid="calendar-field-hints">
                        <small
                            [attr.data-testId]="'hint-' + field.variable"
                            data-testid="calendar-field-hint">
                            {{ field.hint }}
                        </small>
                    </div>
                }
                @if (!fieldHasError && hasTimezone && hasHint) {
                    <div class="hint-message">
                        <small
                            data-testid="calendar-field-timezone"
                            class="text-gray-700"
                            role="status"
                            aria-live="polite">
                            {{ systemTimezone.label }}
                        </small>
                    </div>
                }
            </div>
        </div>
    </dot-card-field-footer>
</dot-card-field>
