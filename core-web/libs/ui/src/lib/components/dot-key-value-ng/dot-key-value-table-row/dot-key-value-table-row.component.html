@let variable = $variable();
@let showHiddenField = $showHiddenField();
@let isHiddenField = $isHiddenField();
@let index = $index();
<tr class="dot-key-value-table-row" [pReorderableRow]="index">
    <td>
        <span class="pi pi-bars text-gray-500" pReorderableRowHandle></span>
    </td>
    <td data-testId="dot-key-value-key">
        <p>{{ variable.key }}</p>
    </td>
    @if (isHiddenField) {
        <td data-testId="dot-key-value-label">{{ passwordPlaceholder }}</td>
    } @else {
        <td
            [pEditableColumn]="variable.value"
            data-testId="dot-key-value-editable-column"
            pEditableColumnField="value">
            <p-cellEditor>
                <ng-template pTemplate="input">
                    <input
                        (keydown.escape)="onCancel($event)"
                        (keydown.enter)="onPressEnter($event)"
                        [placeholder]="'keyValue.value_input.placeholder' | dm"
                        [type]="inputType"
                        [formControl]="valueControl"
                        class="field-value-input"
                        autocomplete="false"
                        data-testId="dot-key-value-input"
                        pInputText />
                </ng-template>
                <ng-template pTemplate="output">
                    <span class="dot-key-value-table-row__value">
                        @if (hiddenControl.value) {
                            {{ passwordPlaceholder }}
                        } @else {
                            {{ variable.value }}
                        }
                    </span>
                </ng-template>
            </p-cellEditor>
        </td>
    }
    @if (showHiddenField) {
        <td class="dot-key-value-table-row__variables-hidden">
            @if (!variable.hidden) {
                <p-inputSwitch
                    class="dot-key-value-table-row__hidden-switch"
                    [formControl]="hiddenControl"
                    data-testId="dot-key-value-hidden-switch" />
            }
        </td>
    }

    <td class="dot-key-value-table-row__variables-actions">
        <p-button
            (click)="delete.emit(variable)"
            data-testId="dot-key-value-delete-button"
            icon="pi pi-times"
            severity="secondary"
            size="small"
            [text]="true" />
    </td>
</tr>
