@let variable = $variable();
@let showHiddenField = $showHiddenField();
@let isHiddenField = $isHiddenField();
@let index = $index();

<tr class="dot-key-value-table-row" [pReorderableRow]="index">
    @if ($dragAndDrop()) {
        <td class="p-2 align-middle">
            <span class="pi pi-bars text-gray-500" pReorderableRowHandle></span>
        </td>
    }
    <td class="p-2 align-middle" data-testId="dot-key-value-key">
        <span>{{ variable.key }}</span>
    </td>
    @if (isHiddenField) {
        <td class="p-2 align-middle" data-testId="dot-key-value-label">
            <span>
                <i class="pi pi-lock inline-block mr-1"></i>
                {{ 'keyValue.value_hidden' | dm }}
            </span>
        </td>
    } @else {
        <td class="p-2 align-middle" data-testId="dot-key-value-editable-column">
            <input
                (keydown.enter)="onPressEnter($event)"
                [placeholder]="'keyValue.value_input.placeholder' | dm"
                [type]="inputType"
                [formControl]="valueControl"
                class="w-full"
                autocomplete="false"
                data-testId="dot-key-value-input"
                pInputText
                pSize="small" />
        </td>
    }
    @if (showHiddenField) {
        <td class="p-2 align-middle">
            @if (valueControl.value !== passwordPlaceholder && !variable.hidden) {
                <p-toggleSwitch
                    [formControl]="hiddenControl"
                    data-testId="dot-key-value-hidden-switch" />
            }
        </td>
    }

    <td class="p-2 align-middle">
        <p-button
            (click)="delete.emit()"
            data-testId="dot-key-value-delete-button"
            icon="pi pi-times"
            severity="secondary"
            size="small"
            [text]="true" />
    </td>
</tr>
