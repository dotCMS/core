@let group = $group();
@let conditions = group._conditions;

<div class="dot-rules-group">
    @if ($groupIndex() === 0) {
        <div class="dot-rules-group-separator">
            {{ getI18nLabel('inputs.group.whenConditions.label') | async }}
        </div>
    }
    @if ($groupIndex() !== 0) {
        <div class="dot-rules-group-separator">
            <button
                (click)="toggleGroupOperator()"
                [label]="group.operator"
                pButton
                severity="secondary"
                size="small"></button>
            <span class="dot-rules-header-text flex-1">
                {{ getI18nLabel('inputs.group.whenFurtherConditions.label') | async }}
            </span>
        </div>
    }
    <div class="dot-rules-conditions flex flex-col flex-1">
        @for (condition of conditions; track trackByCondition($index, condition); let i = $index) {
            <div class="dot-rules-condition-row flex flex-row">
                <dot-rule-condition
                    (deleteCondition)="deleteCondition.emit($event)"
                    (updateConditionType)="updateConditionType.emit($event)"
                    (updateConditionParameter)="updateConditionParameter.emit($event)"
                    (updateConditionOperator)="updateConditionOperator.emit($event)"
                    [condition]="condition"
                    [conditionTypes]="$conditionTypes()"
                    [conditionTypePlaceholder]="$conditionTypePlaceholder()"
                    [index]="i"
                    class="flex-1 flex flex-row" />
                <div class="dot-rules-btn-group dot-rules-add-btn">
                    @if (i === conditions.length - 1) {
                        <button
                            (click)="onCreateCondition()"
                            [disabled]="!condition.isPersisted()"
                            [rounded]="true"
                            [text]="true"
                            pButton
                            type="button"
                            severity="success"
                            icon="pi pi-plus"
                            ariaLabel="Add Condition"></button>
                    }
                </div>
            </div>
        }
    </div>
</div>
