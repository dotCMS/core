@let conditions = $group()._conditions;

<div class="cw-rule-group">
    @if (groupIndex === 0) {
        <div class="cw-condition-group-separator">
            {{ rsrc('inputs.group.whenConditions.label') | async }}
        </div>
    }
    @if (groupIndex !== 0) {
        <div class="cw-condition-group-separator">
            <button
                (click)="toggleGroupOperator()"
                [label]="$group().operator"
                pButton
                class="p-button-secondary p-button-sm"></button>
            <span flex class="cw-header-text">
                {{ rsrc('inputs.group.whenFurtherConditions.label') | async }}
            </span>
        </div>
    }
    <div flex layout="column" class="cw-conditions">
        @for (condition of conditions; track trackByFn($index, condition); let i = $index) {
            <div layout="row" class="cw-condition-row">
                <dot-rule-condition
                    (deleteCondition)="deleteCondition.emit($event)"
                    (updateConditionType)="updateConditionType.emit($event)"
                    (updateConditionParameter)="updateConditionParameter.emit($event)"
                    (updateConditionOperator)="updateConditionOperator.emit($event)"
                    [condition]="condition"
                    [conditionTypes]="conditionTypes"
                    [conditionTypePlaceholder]="conditionTypePlaceholder"
                    [index]="i"
                    flex
                    layout="row" />
                <div class="cw-btn-group cw-add-btn">
                    @if (i === conditions.length - 1) {
                        <div class="ui basic icon buttons">
                            <button
                                (click)="onCreateCondition()"
                                [disabled]="!condition.isPersisted()"
                                pButton
                                type="button"
                                icon="pi pi-plus"
                                class="p-button-rounded p-button-success p-button-text"
                                arial-label="Add Condition"></button>
                        </div>
                    }
                </div>
            </div>
        }
    </div>
</div>
