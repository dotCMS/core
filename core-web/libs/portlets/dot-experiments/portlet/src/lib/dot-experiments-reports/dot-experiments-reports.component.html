@if (vm$ | async; as vm) {
    <dot-experiments-header
        (goBack)="goToExperimentList(vm.experiment.pageId)"
        [experiment]="vm.experiment"
        [isLoading]="vm.isLoading"
        [title]="vm.experiment?.name" />
    <div class="flex flex-col w-full h-full overflow-y-auto bg-gray-100 p-5 pt-3 gap-3">
        @if (!vm.isLoading) {
            <dot-experiments-experiment-summary
                (updateResults)="loadExperimentsResults()"
                [goals]="vm.experiment.goals"
                [scheduling]="vm.experiment.scheduling"
                [sessionsReached]="vm.results ? vm.results.sessions.total : 0"
                [suggestedWinner]="vm.winnerLegendSummary" />
            <div class="flex items-center flex-col w-full bg-white p-5 rounded-xl gap-4">
                <div class="w-full xl:max-w-[1100px]">
                    <p-tabs [value]="0">
                        <p-tablist>
                            <p-tab [value]="0">{{ 'experiments.reports.chart.title' | dm }}</p-tab>
                            <p-tab [value]="1">{{ 'experiments.bayesian.reports.chart.title' | dm }}</p-tab>
                        </p-tablist>
                        <p-tabpanels>
                            <p-tabpanel [value]="0">
                                <div class="flex flex-col gap-2 items-center md:w-[calc(100%-2rem)]">
                                    <dot-experiments-reports-chart
                                        [config]="axisLabelsProbabilityChart"
                                        [data]="vm.dailyChart?.chartData"
                                        [isEmpty]="!vm.dailyChart?.hasEnoughData"
                                        [isLoading]="vm.isLoading"
                                        data-testId="daily-chart" />
                                </div>
                            </p-tabpanel>
                            <p-tabpanel [value]="1">
                                <div class="flex flex-col gap-2 items-center md:w-[calc(100%-2rem)]">
                                    <dot-experiments-reports-chart
                                        [config]="axisLabelsBayesianChart"
                                        [data]="vm.bayesianChart?.chartData"
                                        [isEmpty]="!vm.bayesianChart?.hasEnoughData"
                                        [isLinearAxis]="true"
                                        [isLoading]="vm.isLoading"
                                        data-testId="bayesian-chart" />
                                </div>
                            </p-tabpanel>
                        </p-tabpanels>
                    </p-tabs>
                    <dot-experiments-report-daily-details
                        [detailData]="vm.detailData"
                        [experimentId]="vm.experiment.id"
                        [hasEnoughSessions]="vm.results ? vm.results.sessions.total >= 10 : false"
                        [promotedVariantId]="vm.promotedVariant" />
                </div>
            </div>
        } @else {
            <dot-experiments-reports-skeleton />
        }
    </div>
}

<ng-template dotDynamic></ng-template>
<p-confirmpopup />
