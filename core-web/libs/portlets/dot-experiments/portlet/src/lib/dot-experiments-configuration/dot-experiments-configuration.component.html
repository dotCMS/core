@if (vm$ | async; as vm) {
    <dot-experiments-header
        (goBack)="goToExperimentList(vm.experiment.pageId)"
        [experiment]="vm.experiment"
        [isLoading]="vm.isLoading"
        [title]="vm.experiment?.name">
        <div class="flex grow-0 items-center justify-between">
            <p-button
                (click)="menu.toggle($event)"
                data-testId="experiment-button-menu"
                icon="pi pi-ellipsis-v" />
            <p-menu [model]="vm.menuItems" [popup]="true" #menu data-testId="experiment-menu" />
        </div>
    </dot-experiments-header>

    <div class="flex h-full w-full flex-col gap-4 overflow-y-auto bg-[var(--gray-100)] p-4 md:p-8">
        @if (!vm.isLoading) {
            <p-card data-testId="experiment-description">
                <dot-experiments-inplace-edit-text
                    (textChanged)="saveDescriptionAction($event, vm.experiment)"
                    [disabled]="
                        vm.experimentStatus === experimentStatus.RUNNING ||
                        !!vm.disabledTooltipLabel
                    "
                    [isLoading]="vm.isDescriptionSaving"
                    [text]="vm.experiment.description"
                    emptyTextMessage="experiments.configure.description.add" />
            </p-card>
            <dot-experiments-configuration-variants />
            <dot-experiments-configuration-goals />
            <!-- Hide until is implemented
        <dot-experiments-configuration-targeting />-->
            <dot-experiments-configuration-traffic />
            <dot-experiments-configuration-scheduling />
        } @else {
            <dot-experiments-configuration-skeleton />
        }
    </div>
    @if (vm.addToBundleContentId) {
        <dot-add-to-bundle
            (cancel)="vm.addToBundleContentId = null"
            [assetIdentifier]="vm.addToBundleContentId" />
    }
}

<p-confirmDialog [key]="confirmDialogKey" [style]="{ width: '30vw' }" />
<p-confirmpopup dotRemoveConfirmPopupWithEscape />
