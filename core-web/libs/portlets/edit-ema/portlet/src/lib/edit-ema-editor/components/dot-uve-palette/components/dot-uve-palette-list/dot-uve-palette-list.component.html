<div class="dot-uve-palette-list__controls">
    @if ($currentView() === DotUVEPaletteListView.CONTENTLETS) {
        <p-button
            icon="pi pi-chevron-left"
            styleClass="options-menu-button"
            [text]="true"
            [rounded]="true"
            (onClick)="onBackToContentTypes()" />
    }

    <p-iconField iconPosition="left" [style]="{ width: '100%' }">
        <p-inputIcon styleClass="pi pi-search" />
        <input
            pInputText
            placeholder="Search"
            styleClass="input-text-sm"
            [style]="{ width: '100%' }"
            (input)="onSearch($event)"
            [value]="" />
    </p-iconField>

    @if ($currentView() === DotUVEPaletteListView.CONTENT_TYPES && $listType() !== 'FAVORITES') {
        <p-button
            icon="pi pi-arrow-right-arrow-left"
            styleClass="options-menu-button"
            [text]="true"
            [rounded]="true"
            (onClick)="setSortMenuItems(); cm.toggle($event)" />
    } @else if ($listType() === 'FAVORITES') {
        <p-button
            icon="pi pi-plus"
            styleClass="options-menu-button"
            [text]="true"
            [rounded]="true"
            (onClick)="overlayPanel.toggle($event)" />
    }
</div>

<div
    class="dot-uve-palette-list__grid"
    [class.dot-uve-palette-list__grid--list]="$isListLayout()"
    [class.dot-uve-palette-list__grid--loading]="$isLoading()">
    @if ($status() === DotPaletteListStatus.LOADING) {
        @let skeletonHeight = $isListLayout() ? '4rem' : '6.875rem';
        @for (i of LOADING_ROWS; track i) {
            <p-skeleton width="100%" [height]="skeletonHeight" />
        }
    } @else if ($status() === DotPaletteListStatus.EMPTY) {
        <div class="dot-uve-palette-list__empty">
            <div class="dot-uve-palette-list__empty-icon">
                <i class="pi pi-plus"></i>
            </div>

            @if ($listType() === 'FAVORITES') {
                <p class="dot-uve-palette-list__empty-text">
                    <span
                        class="dot-uve-palette-list__empty-link"
                        (click)="overlayPanel.toggle($event)">
                        Add
                    </span>
                    new favorite to this list for easy access.
                </p>
            } @else if ($currentView() === DotUVEPaletteListView.CONTENT_TYPES) {
                <p class="dot-uve-palette-list__empty-text">
                    Add new content type to this list for easy access.
                </p>
            } @else if ($currentView() === DotUVEPaletteListView.CONTENTLETS) {
                <p class="dot-uve-palette-list__empty-text">
                    Add new contentlet to this list for easy access.
                </p>
            }
        </div>
    } @else {
        @switch ($currentView()) {
            @case (DotUVEPaletteListView.CONTENTLETS) {
                @for (contentlet of $contentlets(); track contentlet.identifier) {
                    <dot-uve-palette-contentlet [contentlet]="contentlet" />
                }
            }
            @case (DotUVEPaletteListView.CONTENT_TYPES) {
                @for (contentType of $contenttypes(); track contentType.id) {
                    <dot-uve-palette-contenttype
                        [contentType]="contentType"
                        [view]="$viewMode()"
                        (selectContentType)="onSelectContentType($event)"
                        (rightClick)="setFavoriteMenuItems(contentType); cm.show($event)" />
                }
            }
        }
    }
</div>

@if (!$isLoading()) {
    <p-paginator
        (onPageChange)="onPageChange($event)"
        [showPageLinks]="false"
        [showJumpToPageDropdown]="false"
        [showCurrentPageReport]="true"
        [showFirstLastIcon]="false"
        [first]="$start()"
        [rows]="$pagination.perPage()"
        [totalRecords]="$pagination.totalEntries()"
        [currentPageReportTemplate]="$paginatorTemplate()" />
}

<p-menu
    #cm
    [model]="$contextMenuItems()"
    [popup]="true"
    appendTo="body"
    styleClass="options-menu-popup"
    showTransitionOptions="0ms" />

<p-overlayPanel #overlayPanel styleClass="favorite-selector-overlaypanel">
    <dot-favorite-selector />
</p-overlayPanel>
