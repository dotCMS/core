<!-- Hover Overlay: Blue box with opacity, no border, no tools -->
@if (showHoverOverlay()) {
    <div [ngStyle]="hoverBoundsStyles()" class="bounds hover" (click)="handleClick()" data-testId="bounds-hover"></div>
}

<!-- Selected Overlay: Border, tools visible, pointer-events: none on bounds -->
@if (showSelectedOverlay()) {
    @let selectedContext = selectedContentContext();
    @let selectedDragItem = dragPayload();
    @let selectedIsEmpty = isSelectedContainerEmpty();

    <div [ngStyle]="selectedBoundsStyles()" class="bounds selected" data-testId="bounds-selected">
        <p-button
            (click)="setPositionFlag('before'); menu.toggle($event)"
            class="add-button-top"
            data-testId="add-top-button"
            icon="pi pi-plus" />
        @if (!selectedIsEmpty) {
            <p-button
                (click)="setPositionFlag('after'); menu.toggle($event)"
                class="add-button-bottom"
                data-testId="add-bottom-button"
                icon="pi pi-plus" />
        }

        @if (!selectedIsEmpty) {
            <div class="actions" data-testId="actions">
                @if (selectedHasVtlFiles()) {
                    <p-button
                        (click)="menuVTL.toggle($event)"
                        data-testId="edit-vtl-button"
                        styleClass="p-button-rounded p-button-raised"
                        icon="pi pi-code" />
                    <p-menu
                        [model]="vtlMenuItems()"
                        [popup]="true"
                        #menuVTL
                        appendTo="body"
                        data-testId="menu-vtl" />
                }
                <p-button
                    [attr.data-item]="selectedDragItem | json"
                    [attr.data-use-custom-drag-image]="useCustomDragImage"
                    data-type="contentlet"
                    draggable="true"
                    data-testId="drag-button"
                    styleClass="p-button-rounded p-button-raised"
                    icon="pi pi-arrows-alt" />
                <p-button
                    (click)="deleteContent.emit(selectedContext)"
                    [disabled]="!allowContentDelete()"
                    [pTooltip]="deleteButtonTooltip() | dm"
                    tooltipPosition="bottom"
                    [escape]="false"
                    data-testId="delete-button"
                    styleClass="p-button-rounded p-button-raised delete"
                    icon="pi pi-times" />

                <p-button
                    (click)="editContent.emit(selectedContext)"
                    data-testId="edit-button"
                    styleClass="p-button-rounded p-button-raised"
                    icon="pi pi-pencil" />

                @if (showStyleEditorOption()) {
                    <p-button
                        (click)="selectContent.emit(selectedContext.contentlet)"
                        data-testId="palette-button"
                        styleClass="p-button-rounded p-button-raised"
                        icon="pi pi-palette" />
                }
            </div>
        }

        <p-menu [model]="menuItems()" [popup]="true" #menu appendTo="body" data-testId="menu-add" />
    </div>
}
