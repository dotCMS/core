<ng-container *ngIf="shellProperties$ | async as sp">
    <ng-container *ngIf="sp.canRead; else error">
        <router-outlet (activate)="onActivateRoute($event)"></router-outlet>
        <dot-edit-ema-navigation-bar [items]="sp.items"></dot-edit-ema-navigation-bar>
        <p-toast position="top-center" data-testId="ema-toast"></p-toast>
        <dot-page-tools-seo
            #pageTools
            [currentPageUrlParams]="sp.seoProperties"></dot-page-tools-seo>
    </ng-container>

    <ng-template #error>
        <ng-container [ngSwitch]="sp.error">
            <dot-info-page *ngSwitchCase="403" [info]="EMA_INFO_PAGES.ACCESS_DENIED" />
            <dot-info-page *ngSwitchCase="404" [info]="EMA_INFO_PAGES.NOT_FOUND" />
            <dot-not-license *ngSwitchCase="401" />
        </ng-container>
    </ng-template>
</ng-container>

<p-dialog
    #dialog
    *ngIf="dialogState$ | async as ds"
    [visible]="ds.type === 'shell'"
    [style]="{ height: '90vh', width: '90vw' }"
    [header]="ds.header"
    [draggable]="false"
    [resizable]="false"
    [maximizable]="true"
    [modal]="true"
    (visibleChange)="store.resetDialog()"
    data-testId="dialog"
    styleClass="edit-ema-dialog">
    <iframe
        #dialogIframe
        [style]="{
            border: 'none',
            display: ds.iframeLoading ? 'none' : 'block'
        }"
        [src]="ds.iframeURL | safeUrl"
        (load)="onIframeLoad()"
        title="dialog"
        data-testId="dialog-iframe"
        width="100%"
        height="100%"></iframe>
    <dot-spinner
        *ngIf="ds.iframeLoading"
        [ngStyle]="{ position: 'absolute', top: '50%' }"
        data-testId="spinner"></dot-spinner>
</p-dialog>
