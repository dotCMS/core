<div class="analytics-dashboard flex flex-column" data-testid="analytics-dashboard">
    <!-- Development Status Banner -->
    @if ($showMessage()) {
        <p-messages severity="info" data-testid="analytics-message">
            <ng-template pTemplate="content">
                <div class="flex align-items-center justify-content-between gap-2 w-full">
                    <div class="flex align-items-center gap-2">
                        <i class="pi pi-info-circle"></i>
                        <span data-testid="message-content">
                            {{ 'analytics.feature.state' | dm }}
                            <b>{{ 'development' | dm }}</b>
                        </span>
                    </div>
                    <div class="flex align-items-center gap-2">
                        <button
                            pButton
                            class="p-button-text p-button-rounded p-button-sm p-button-icon-only"
                            type="button"
                            icon="pi pi-times"
                            data-testid="close-message"
                            (click)="onCloseMessage()"></button>
                    </div>
                </div>
            </ng-template>
        </p-messages>
    }

    <!-- Filters Row -->
    <div class="analytics-dashboard__filters-row">
        <div
            class="analytics-dashboard__filters-container flex justify-content-between align-items-center">
            <dot-analytics-dashboard-filters
                class="analytics-dashboard__filters"
                [timeRange]="store.timeRange()"
                (changeFilters)="onTimeRangeChange($event)"
                data-testid="analytics-filters" />

            <p-button
                class="analytics-dashboard__refresh-button"
                [label]="'analytics.dashboard.refresh.button' | dm"
                [rounded]="false"
                severity="primary"
                size="small"
                (onClick)="onRefresh()"
                data-testid="refresh-button" />
        </div>
    </div>

    <!-- Dashboard Content - Tabs -->
    <div class="analytics-dashboard__dashboard-row">
        <p-tabView [activeIndex]="$activeTabIndex()" (onChange)="onTabChange($event)">
            @for (tab of $tabs(); track tab.id) {
                <p-tabPanel [header]="tab.label | dm">
                    <ng-template pTemplate="content">
                        @switch (tab.id) {
                            @case ('pageview') {
                                <dot-analytics-dashboard-pageview-report />
                            }
                            @case ('conversions') {
                                <dot-analytics-dashboard-conversions-report />
                            }
                            @case ('engagement') {
                                <dot-analytics-dashboard-engagement-report />
                            }
                        }
                    </ng-template>
                </p-tabPanel>
            }
        </p-tabView>
    </div>
</div>
