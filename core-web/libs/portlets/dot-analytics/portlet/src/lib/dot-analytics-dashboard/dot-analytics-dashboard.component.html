<div class="w-full h-full overflow-auto" data-testid="analytics-dashboard">
    <!-- Development Status Banner -->
    @if ($showMessage()) {
        <p-message
            severity="info"
            icon="pi pi-info-circle"
            [closable]="true"
            (onClose)="onCloseMessage()"
            data-testid="analytics-message">
            <span data-testid="message-content">
                {{ 'analytics.feature.state' | dm }}
                <b>{{ 'development' | dm }}</b>
            </span>
        </p-message>
    }

    <!-- Filters Row -->
    <div class="w-full bg-gray-100 border-b border-gray-300 py-3 px-4">
        <div class="max-w-full flex justify-between items-center">
            <dot-analytics-dashboard-filters
                [timeRange]="store.timeRange()"
                (changeFilters)="onTimeRangeChange($event)"
                data-testid="analytics-filters" />

            <p-button
                [label]="'analytics.dashboard.refresh.button' | dm"
                [rounded]="false"
                severity="primary"
                size="small"
                (onClick)="onRefresh()"
                data-testid="refresh-button" />
        </div>
    </div>

    <!-- Dashboard Content - Tabs -->
    <div class="bg-white px-4">
        <p-tabs [value]="store.currentTab()" (valueChange)="onTabChange($event)">
            <p-tablist>
                @for (tab of tabs; track tab.id) {
                    <p-tab [value]="tab.id">
                        {{ tab.label | dm }}
                    </p-tab>
                }
            </p-tablist>

            <p-tabpanels>
                @for (tab of tabs; track tab.id) {
                    <p-tabpanel [value]="tab.id">
                        @switch (tab.id) {
                            @case ('pageview') {
                                <dot-analytics-dashboard-pageview-report />
                            }
                            @case ('conversions') {
                                <dot-analytics-dashboard-conversions-report />
                            }
                        }
                    </p-tabpanel>
                }
            </p-tabpanels>
        </p-tabs>
    </div>
</div>
