<div class="analytics-dashboard" data-testid="analytics-dashboard">

    <!-- Filters Row - Gray Background -->
    <div class="analytics-dashboard__filters-row">
        <div class="analytics-dashboard__filters-container">
            <dot-analytics-dashboard-filters
                class="analytics-dashboard__filters"
                [selectedTimeRange]="$currentTimeRange()"
                (timeRangeChanged)="onTimeRangeChange($event)"
                data-testid="analytics-filters" />

            <p-button
                class="analytics-dashboard__refresh-button"
                [label]="'analytics.dashboard.refresh.button' | dm"
                icon="pi pi-refresh"
                [rounded]="false"
                severity="primary"
                size="small"
                (onClick)="onRefresh()"
                data-testid="refresh-button">
            </p-button>
        </div>
    </div>

    <!-- Dashboard Row - White Background -->
    <div class="analytics-dashboard__dashboard-row">
        <div class="analytics-dashboard__dashboard-container">

            <!-- Metrics Section -->
            <div class="analytics-dashboard__metrics">
                @for (metric of $metricsData(); track metric.name) {
                    <dot-analytics-dashboard-metrics
                        class="analytics-dashboard__metric-card"
                        [name]="metric.name"
                        [value]="metric.value || 0"
                        [subtitle]="metric.subtitle || ''"
                        [icon]="metric.icon || ''"
                        [status]="metric.status" />
                }
            </div>

            <!-- Charts Section -->
            <div class="analytics-dashboard__charts">
                <!-- Line Chart -->
                <div class="analytics-dashboard__timeline-chart">
                    <dot-analytics-dashboard-chart
                        [title]="'analytics.charts.pageviews-timeline.title' | dm"
                        type="line"
                        [data]="$pageviewsTimelineData()"
                        height="350px" />
                </div>
            </div>

            <!-- Table and Pie Chart Section -->
            <div class="analytics-dashboard__bottom-section">
                <!-- Pie Chart -->
                <div class="analytics-dashboard__device-chart">
                    <dot-analytics-dashboard-chart
                        [title]="'analytics.charts.device-breakdown.title' | dm"
                        type="pie"
                        [data]="$deviceBreakdownData()"
                        height="370px" />
                </div>

                <!-- Table -->
                <div class="analytics-dashboard__table">
                    <dot-analytics-dashboard-table
                        [data]="$topPagesTableData()"
                        [status]="$topPagesTableStatus()" />
                </div>
            </div>

        </div>
    </div>

</div>
