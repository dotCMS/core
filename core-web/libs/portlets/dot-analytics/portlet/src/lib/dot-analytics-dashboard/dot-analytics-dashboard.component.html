<div class="analytics-dashboard flex flex-col" data-testid="analytics-dashboard">
    <!-- Development Status Banner -->
    @if ($showMessage()) {
        <p-message severity="info" data-testid="analytics-message">
            <ng-template pTemplate="content">
                <div class="flex items-center justify-between gap-2 w-full">
                    <div class="flex items-center gap-2">
                        <i class="pi pi-info-circle"></i>
                        <span data-testid="message-content">
                            {{ 'analytics.feature.state' | dm }}
                            <b>{{ 'development' | dm }}</b>
                        </span>
                    </div>
                    <div class="flex items-center gap-2">
                        <button
                            pButton
                            class="p-button-text p-button-rounded p-button-sm p-button-icon-only"
                            type="button"
                            icon="pi pi-times"
                            data-testid="close-message"
                            (click)="onCloseMessage()"></button>
                    </div>
                </div>
            </ng-template>
        </p-message>
    }

    <!-- Filters Row -->
    <div class="analytics-dashboard__filters-row">
        <div class="analytics-dashboard__filters-container flex justify-between items-center">
            <dot-analytics-dashboard-filters
                class="analytics-dashboard__filters"
                [timeRange]="store.timeRange()"
                (changeFilters)="onTimeRangeChange($event)"
                data-testid="analytics-filters" />

            <p-button
                class="analytics-dashboard__refresh-button"
                [label]="'analytics.dashboard.refresh.button' | dm"
                [rounded]="false"
                severity="primary"
                size="small"
                (onClick)="onRefresh()"
                data-testid="refresh-button" />
        </div>
    </div>

    <!-- Dashboard Content - Tabs -->
    <div class="analytics-dashboard__dashboard-row">
        <p-tabs [value]="store.currentTab()" (valueChange)="onTabChange($event)">
            <p-tablist>
                @for (tab of tabs; track tab.id) {
                    <p-tab [value]="tab.id">
                        {{ tab.label | dm }}
                    </p-tab>
                }
            </p-tablist>

            <p-tabpanels>
                @for (tab of tabs; track tab.id) {
                    <p-tabpanel [value]="tab.id">
                        @switch (tab.id) {
                            @case ('pageview') {
                                <dot-analytics-dashboard-pageview-report />
                            }
                            @case ('conversions') {
                                <dot-analytics-dashboard-conversions-report />
                            }
                        }
                    </p-tabpanel>
                }
            </p-tabpanels>
        </p-tabs>
    </div>
</div>
