<div class="flex flex-col portlet-wrapper" data-testid="analytics-dashboard">
    <div class="header-container p-4 py-6">
        @if ($showMessage()) {
            <p-message
                severity="info"
                [closable]="true"
                (onClose)="onCloseMessage()"
                data-testid="analytics-message">
                <div class="flex items-center gap-2">
                    <i class="pi pi-info-circle"></i>
                    <span data-testid="message-content">
                        {{ 'analytics.feature.state' | dm }}
                        <b>{{ 'development' | dm }}</b>
                    </span>
                </div>
            </p-message>
        }
    
        <div class="flex justify-between items-center">
            <dot-analytics-filters
                [timeRange]="store.timeRange()"
                (changeFilters)="onTimeRangeChange($event)"
                data-testid="analytics-filters" />
            <p-button
                [label]="'analytics.dashboard.refresh.button' | dm"
                severity="primary"
                size="small"
                (onClick)="onRefresh()"
                data-testid="refresh-button" />
        </div>
    </div>
    
    <div class="content-container px-4">
    <!-- Tabs -->
    <p-tabs [value]="store.currentTab()" (valueChange)="onTabChange($event)">
        <p-tablist>
            @for (tab of $tabs(); track tab.id) {
                <p-tab [value]="tab.id">{{ tab.label | dm }}</p-tab>
            }
        </p-tablist>
        <p-tabpanels>
            @for (tab of $tabs(); track tab.id) {
                <p-tabpanel [value]="tab.id">
                    @switch (tab.id) {
                        @case ('pageview') {
                            <dot-analytics-pageview-report />
                        }
                        @case ('conversions') {
                            <dot-analytics-conversions-report />
                        }
                        @case ('engagement') {
                            <dot-analytics-engagement-report />
                        }
                    }
                </p-tabpanel>
            }
        </p-tabpanels>
    </p-tabs>
    </div>
</div>
