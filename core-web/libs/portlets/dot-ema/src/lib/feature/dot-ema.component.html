<ng-container *ngIf="editorState$ | async as es">
    <dot-edit-ema-toolbar>
        <ng-container left>
            <p-button label="Preview" icon="pi pi-desktop" styleClass="p-button-text p-button-sm" />
            <p-button label="Bookmark" icon="pi pi-star" styleClass="p-button-text p-button-sm" />
            <p-button
                [cdkCopyToClipboard]="es.iframeURL"
                [label]="'editpage.header.copy' | dm"
                (cdkCopyToClipboardCopied)="triggerCopyToast()"
                icon="pi pi-copy"
                styleClass="p-button-text p-button-sm"
                data-testId="ema-copy-url" />
            <a
                class="p-button-sm p-button-text"
                [href]="es.apiURL"
                [title]="es.apiURL"
                pButton
                target="_blank"
                data-testId="ema-api-link"
                icon="pi pi-link"
                label="API">
            </a>
        </ng-container>
        <ng-container right>
            <dot-edit-ema-language-selector
                [language]="es.editor.viewAs.language"
                (selected)="onLanguageSelected($event)"
                data-testId="language-selector" />
            <dot-edit-ema-persona-selector
                #personaSelector
                [pageID]="es.editor.page.identifier"
                [value]="es.editor.viewAs.persona"
                (selected)="onPersonaSelected($event)"
                data-testId="persona-selector" />
            <p-button class="p-button-sm" label="Save" />
        </ng-container>
    </dot-edit-ema-toolbar>
    <div class="iframe-wrapper">
        <iframe
            #iframe
            [src]="es.iframeURL | safeUrl"
            [title]="host"
            data-testId="iframe"
            style="border: none"
            width="100%"
            height="100%"></iframe>
    </div>
</ng-container>
<ng-container *ngIf="dialogState$ | async as ds">
    <p-dialog
        #dialog
        [visible]="ds.dialogVisible"
        [style]="{ height: '90vh', width: '90vw' }"
        [header]="ds.dialogHeader"
        [draggable]="false"
        [resizable]="false"
        [maximizable]="true"
        [modal]="true"
        (visibleChange)="resetDialogIframeData()"
        data-testId="dialog">
        <iframe
            #dialogIframe
            [style]="{ border: 'none', display: ds.dialogIframeLoading ? 'none' : 'block' }"
            [src]="ds.dialogIframeURL | safeUrl"
            (load)="onIframeLoad($event)"
            title="dialog"
            data-testId="dialog-iframe"
            width="100%"
            height="100%"></iframe>
        <dot-spinner *ngIf="ds.dialogIframeLoading" data-testId="spinner"></dot-spinner>
    </p-dialog>

    <p-confirmDialog
        [style]="{
            width: '400px'
        }"
        [rejectIcon]="null"
        [acceptIcon]="null"
        rejectButtonStyleClass="p-button-outlined"
        data-testId="confirm-dialog"></p-confirmDialog>
</ng-container>
<p-toast position="top-center" data-testId="ema-toast"></p-toast>
