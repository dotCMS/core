<form
    (ngSubmit)="handleSubmit()"
    [ngClass]="{ 'min-h-80': languageId?.value, 'min-h-122': !languageId?.value }"
    [formGroup]="form"
    class="flex flex-col gap-6">
    @if (languageId?.value) {
        <!--Edit language-->

        <div class="field flex flex-col gap-2">
            <label for="langEdit">{{ 'locale.display.name' | dm }}</label>
            <input
                [maxlength]="50"
                pInputText
                id="langEdit"
                aria-describedby="langEdit-help"
                [maxlength]="50"
                data-testId="langEdit"
                formControlName="language"
                type="text" />
        </div>

        <div class="field flex flex-col gap-2">
            <label for="isoCodeEdit">{{ 'locale.id' | dm }}</label>

            <p-iconField iconPosition="right" class="flex items-center justify-center">
                <input
                    id="isoCodeEdit"
                    #localeIDInput
                    data-testId="isoCodeEdit"
                    formControlName="isoCode"
                    pInputText
                    class="w-full"
                    type="text" />
                @if (localeIDInput.value) {
                    <p-inputIcon class="flex items-center bottom-2">
                        <dot-copy-button [copy]="localeIDInput.value" />
                    </p-inputIcon>
                }
            </p-iconField>
        </div>

        <div class="field flex flex-col gap-2">
            <label for="id">{{ 'locale.language.id' | dm }}</label>
            <p-iconField iconPosition="right" class="flex items-center justify-center">
                <input
                    id="id"
                    #languageIDInput
                    data-testId="id"
                    formControlName="id"
                    pInputText
                    class="w-full"
                    type="text" />
                @if (languageIDInput.value) {
                    <p-inputIcon class="flex items-center bottom-2">
                        <dot-copy-button [copy]="languageIDInput.value" />
                    </p-inputIcon>
                }
            </p-iconField>
        </div>
    } @else {
        <!--Add new language-->
        <div class="field flex flex-col gap-2">
            <label for="localeType">{{ 'locales.type' | dm }}</label>

            <p-select
                (onChange)="handleTypeChange()"
                [options]="localeType"
                id="localeType"
                formControlName="localeType"
                data-testId="localeType"
                appendTo="body"></p-select>
        </div>

        @if (form.get('localeType')?.value === 1) {
            <!--Standard Locale-->
            <div class="field flex flex-col gap-2">
                <label for="languageDropdown">{{ 'locales.language' | dm }}</label>
                <p-select
                    [filter]="true"
                    [options]="data.languages"
                    [placeholder]="'locales.language.input.placeholder' | dm"
                    id="languageDropdown"
                    filterBy="name,code"
                    data-testId="languageDropdown"
                    appendTo="body"
                    formControlName="languageDropdown">
                    <ng-template let-language pTemplate="item">
                        {{ language.name }} - {{ language.code }}
                    </ng-template>
                    <ng-template let-language pTemplate="selectedItem">
                        {{ language.name }} - {{ language.code }}
                    </ng-template>
                </p-select>
                <small class="text-gray-500">{{ 'locales.language.hint' | dm }}</small>
            </div>
            <div class="field flex flex-col gap-2">
                <label for="countryDropdown">{{ 'locales.country' | dm }}</label>
                <p-select
                    [filter]="true"
                    [options]="data.countries"
                    [placeholder]="'locales.language.input.placeholder' | dm"
                    id="countryDropdown"
                    data-testId="countryDropdown"
                    filterBy="name,code"
                    appendTo="body"
                    formControlName="countryDropdown">
                    <ng-template let-country pTemplate="item">
                        {{ country.name }} - {{ country.code }}
                    </ng-template>
                    <ng-template let-country pTemplate="selectedItem">
                        {{ country.name }} - {{ country.code }}
                    </ng-template>
                </p-select>
                <small class="text-gray-500">{{ 'locales.country.hint' | dm }}</small>
            </div>
            <div class="field flex flex-col gap-2">
                <label for="isoCode">{{ 'locale.id' | dm }}</label>
                <p-inputgroup>
                    <input
                        [placeholder]="'locale.id.placeholder' | dm"
                        id="isoCode"
                        #isoCodeInput
                        data-testId="isoCode"
                        formControlName="isoCode"
                        pInputText
                        type="text" />
                    @if (isoCodeInput.value) {
                        <p-inputgroup-addon class="bg-transparent border-l-0">
                            <dot-copy-button [copy]="isoCodeInput.value" />
                        </p-inputgroup-addon>
                    }
                </p-inputgroup>
                <small class="text-gray-500">{{ 'locale.id.standard.hint' | dm }}</small>
            </div>
        } @else {
            <!--Custom Locale-->
            <div class="field flex flex-col gap-2">
                <label for="language">{{ 'locale.display.name' | dm }}</label>
                <input
                    [maxlength]="50"
                    id="language"
                    data-testId="language"
                    formControlName="language"
                    pInputText
                    type="text" />
                <small class="text-gray-500">{{ 'locale.display.name.hint' | dm }}</small>
            </div>
            <!-- <div class="field">
                <label class="p-label-input-required" for="language">
                    {{ 'locale.display.name' | dm }}
                </label>
                <input
                    [maxlength]="50"
                    id="language"
                    data-testId="language"
                    formControlName="language"
                    pInputText
                    type="text" />
                <span class="p-field-hint">{{ 'locale.display.name.hint' | dm }}</span>
            </div> -->
            <div class="field flex flex-col gap-2">
                <label for="languageCode">{{ 'locale.id' | dm }}</label>
                <p-inputgroup>
                    <input
                        [maxlength]="5"
                        id="languageCode"
                        data-testId="languageCode"
                        formControlName="languageCode"
                        pInputText
                        type="text" />
                </p-inputgroup>
                <small class="text-gray-500">{{ 'locale.id.hint' | dm }}</small>
                <!-- <label class="p-label-input-required" for="languageCode">
                    {{ 'locale.id' | dm }}
                </label>
                <input
                    [maxlength]="5"
                    id="languageCode"
                    data-testId="languageCode"
                    formControlName="languageCode"
                    pInputText
                    type="text" />
                <span class="p-field-hint">{{ 'locale.id.hint' | dm }}</span> -->
            </div>
        }
    }
    @if (showError | async) {
        <span class="my-1 text-sm text-red-500" data-testId="error-message">
            {{ 'locale.error.message' | dm }}
        </span>
    }

    <div class="flex gap-3 mt-auto justify-end">
        <button
            (click)="ref.close()"
            [label]="'Cancel' | dm"
            class="p-button-text"
            pButton
            type="button"></button>
        <button
            [label]="(languageId?.value ? 'locales.edit.locale' : 'locales.add.locale') | dm"
            [disabled]="!form.valid"
            data-testId="submit-button"
            pButton
            type="submit"></button>
    </div>
</form>
