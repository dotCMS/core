<div class="w-full col-span-3 row-start-1">
    @if ($showMessage()) {
        <p-message severity="info" data-testid="message" [pt]="{ text: { class: 'w-full' } }">
            <div class="flex items-center justify-between gap-2 w-full">
                <div class="flex items-center gap-2">
                    <i class="pi pi-info-circle"></i>
                    <span data-testid="message-content">
                        {{ 'content-drive.feature.state' | dm }}
                        <b>{{ 'development' | dm }}</b>
                    </span>
                </div>
                <div class="flex items-center gap-2">
                    <a
                        href="https://community.dotcms.com/t/check-out-an-early-version-of-our-content-drive/242?u=marcboutillette"
                        target="_blank"
                        data-testid="learn-more-link">
                        {{ 'content-drive.feature.learn-more' | dm }}
                    </a>
                    <p-button
                        [text]="true"
                        [rounded]="true"
                        size="small"
                        type="button"
                        icon="pi pi-times"
                        data-testid="close-message"
                        (click)="onCloseMessage()" />
                </div>
            </div>
        </p-message>
    }
</div>

<dot-content-drive-toolbar
    (addNewDotAsset)="onAddNewDotAsset()"
    data-testid="toolbar"
    />

<div
    class="flex flex-col justify-center items-center text-xl font-semibold overflow-hidden transition-all duration-300 ease-in-out border-r border-gray-300 col-start-1 row-start-2 row-span-2"
    [class]="$treeExpanded() ? 'w-66' : 'w-0'"
    data-testid="tree-selector">
    <dot-content-drive-sidebar
        data-testid="sidebar"
        (uploadFiles)="resolveFilesUpload($event)"
        (moveItems)="onMoveItems($event)" />
</div>

<dot-content-drive-dropzone
    data-testid="dropzone"
    (uploadFiles)="resolveFilesUpload($event)"
    class="overflow-auto col-start-2 row-start-3">
    <dot-folder-list-view
        [items]="$items()"
        [totalItems]="$totalItems()"
        [loading]="$loading()"
        [offset]="$offset()"
        (paginate)="onPaginate($event)"
        (sort)="onSort($event)"
        (selectionChange)="onSelectItems($event)"
        (rightClick)="onContextMenu($event)"
        (doubleClick)="onDoubleClick($event)"
        (dragStart)="onDragStart($event)"
        (dragEnd)="onDragEnd()"
        (drop)="onTableDrop($event)"
        (scroll)="onTableScroll()"
        #listView />
</dot-content-drive-dropzone>
<dot-folder-list-context-menu />

<p-toast position="top-center" data-testId="content-drive-toast">
    <ng-template let-message pTemplate="message">
        <span
            class="p-toast-message-icon"
            [attr.aria-hidden]="true"
            [attr.data-pc-section]="'icon'">
            <dot-severity-icon [severity]="message.severity" />
        </span>
        <div class="p-toast-message-text">
            <span class="p-toast-summary" innerHtml="{{ message.summary }}"></span>
            <span class="p-toast-detail" innerHtml="{{ message.detail }}"></span>
        </div>
    </ng-template>
</p-toast>

@if ($contextMenuData()?.showAddToBundle) {
    <dot-add-to-bundle
        (cancel)="cancelAddToBundle()"
        [assetIdentifier]="$contextMenuData().contentlet.identifier" />
}

<!-- Just placeholders for now. Let's leave it here so we can maintain the layout. But we are not going to use for this version. -->
<div
    class="flex flex-col justify-center items-center text-xl font-semibold w-0 col-start-3 row-start-2 row-span-2"></div>
<p-dialog
    [visible]="!!$dialog()"
    [header]="$dialog()?.header"
    [draggable]="false"
    [resizable]="false"
    [modal]="true"
    appendTo="body"
    data-testId="dialog"
    [pt]="{ content: { class: 'w-[43.75rem] pt-0 p-4' } }"
    (visibleChange)="onHideDialog()">
    @switch ($dialog()?.type) {
        @case (DIALOG_TYPE.FOLDER) {
            <dot-content-drive-dialog-folder
                data-testId="dialog-folder"
                [folder]="$dialog()?.payload" />
        }
        @default {
            <div>Default dialog</div>
        }
    }
</p-dialog>

<!-- Is pending to add the accept attribute. This will be come from the backend in the future. -->
<input type="file" (change)="onFileChange($event)" #fileInput hidden />
