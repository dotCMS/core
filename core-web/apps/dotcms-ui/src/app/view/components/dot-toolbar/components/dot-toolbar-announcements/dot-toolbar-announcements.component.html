<dot-toolbar-btn-overlay
    #overlayPanel
    icon="pi pi-megaphone"
    [showBadge]="$showUnreadAnnouncement()"
    (onHide)="markAnnouncementsAsRead()"
    overlayStyleClass="max-h-[80vh] overflow-auto translate-x-2">
    <div>
        <h5 class="border-b border-gray-300 pb-2 text-base font-semibold">
            {{ 'announcements' | dm }}
        </h5>
        <ul class="list-none py-4">
            @for (item of $announcements(); track item.identifier) {
                <li
                    [class.bg-violet-50]="!item.hasBeenRead"
                    class="relative mb-2 flex flex-row items-center gap-3 rounded-md p-2 hover:bg-gray-100">
                    @if (!item.hasBeenRead) {
                        <span
                            class="absolute left-10 top-3 h-2.5 w-2.5 rounded-full bg-fuchsia-600"></span>
                    }
                    <span
                        class="flex h-12 w-12 items-center justify-center rounded-full bg-gray-100 text-primary-600">
                        <i
                            [class]="typesIcons[item.type | lowercase] || typesIcons['important']"
                            class="pi text-base leading-none"></i>
                    </span>
                    <a
                        (click)="hideOverlayPanel()"
                        [href]="item.url"
                        class="w-full text-black no-underline!"
                        target="_blank"
                        rel="noopener noreferrer"
                        data-testId="announcement_link"
                        aria-labelledby="announcement-label date-label">
                        <div class="flex flex-col">
                            <span class="font-semibold">{{ item.title }}</span>
                            <span class="text-xs text-gray-800">
                                {{ item.announcementDateAsISO8601 | date }}
                            </span>
                        </div>
                    </a>
                </li>
            }
        </ul>

        <div class="flex justify-end">
            <div class="flex items-center gap-1 rounded-lg p-1 hover:bg-gray-100">
                <i class="pi pi-external-link text-primary-600"></i>
                <a
                    (click)="hideOverlayPanel()"
                    [href]="$linkToDotCms()"
                    class="text-primary-600 no-underline"
                    target="_blank"
                    data-testId="announcement_link_all"
                    rel="noopener">
                    {{ 'announcements.show.all' | dm }}
                </a>
            </div>
        </div>

        @for (item of $aboutLinks(); track item.title) {
            <h5 class="m-0 border-b border-gray-300 pb-1 text-base font-semibold">
                {{ item.title | dm }}
            </h5>
            <div class="m-4 grid grid-cols-2 gap-1">
                @for (link of item.items; track $index) {
                    <a
                        (click)="hideOverlayPanel()"
                        [href]="link.url"
                        class="rounded p-1 hover:bg-gray-100 no-underline"
                        data-testId="announcements__about-link"
                        target="_blank"
                        rel="noopener">
                        {{ link.label }}
                    </a>
                }
            </div>
        }
    </div>
</dot-toolbar-btn-overlay>
