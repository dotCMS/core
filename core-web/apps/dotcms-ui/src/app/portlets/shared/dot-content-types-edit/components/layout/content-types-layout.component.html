<dot-secondary-toolbar>
    <div class="main-toolbar-left flex items-center">
        <div class="content-type__title">
            <header>
                <dot-icon name="{{ contentType.icon }}" />
                <ng-template #inlineEditDisplayTemplate>
                    <h4 (click)="editInlineActivate($event)">{{ contentType.name }}</h4>
                </ng-template>
                <ng-template #inlineEditContentTemplate>
                    <input
                        (keyup)="inputValueHandler($event)"
                        [style.width.px]="contentTypeNameInputSize"
                        [value]="contentType.name"
                        #contentTypeNameInput
                        dotAutofocus
                        pInputText
                        type="text" />
                </ng-template>
                <dot-inline-edit
                    [inlineEditContentTemplate]="inlineEditContentTemplate"
                    [inlineEditDisplayTemplate]="inlineEditDisplayTemplate"
                    #dotEditInline />
            </header>
        </div>

        <div class="content-type__info">
            <dot-api-link href="api/v1/contenttype/id/{{ contentType.id }}" />
            <dot-copy-button
                [copy]="contentType.id"
                [tooltipText]="contentType.id"
                label="Copy ID"
                data-testId="copyIdentifier" />
            <dot-copy-button
                [copy]="contentType.variable"
                label="{{ 'contenttypes.content.variable' | dm }}: {{ contentType.variable }}"
                data-testId="copyVariableName" />
        </div>
    </div>
    <div class="main-toolbar-right">
        <button
            (click)="addContentInMenu()"
            class="p-button-outlined content-type__add-to-menu"
            id="add-to-menu-button"
            label="{{ 'contenttypes.content.add_to_menu' | dm }}"
            pButton
            type="button"></button>
        <button
            (click)="openEditDialog.next()"
            class="p-button-outlined"
            id="form-edit-button"
            icon="pi pi-pencil"
            label="{{ 'contenttypes.action.edit' | dm }}"
            pButton
            type="button"></button>
    </div>
</dot-secondary-toolbar>
<p-tabs value="0">
    <p-tablist>
        <p-tab [value]="0">
            {{ 'contenttypes.tab.fields.header' | dm }}
        </p-tab>
        @if (contentType) {
            <p-tab [value]="1">
                {{ 'contenttypes.tab.relationship.header' | dm }}
            </p-tab>
        }
        @if (contentType && showPermissionsTab | async) {
            <p-tab [value]="2">
                {{ 'contenttypes.tab.permissions.header' | dm }}
            </p-tab>
        }
        @if (contentType) {
            <p-tab [value]="contentType && (showPermissionsTab | async) ? 3 : 2">
                {{ 'contenttypes.tab.publisher.push.history.header' | dm }}
            </p-tab>
        }
    </p-tablist>
    <p-tabpanels>
        <p-tabpanel [value]="0" class="content-type__properties">
            <div class="content-type__fields-layout" id="content-type-form-layout">
                <div class="content-type__fields-main" id="content-type-form-main">
                    <ng-content></ng-content>
                </div>
                <div class="content-type__fields-sidebar">
                    <p-splitButton
                        (onClick)="fireAddRowEvent()"
                        [model]="actions"
                        icon="pi pi-plus"
                        label="{{ 'contenttypes.content.row' | dm }}"></p-splitButton>
                    <dot-content-types-fields-list
                        [baseType]="contentType.baseType"></dot-content-types-fields-list>
                </div>
            </div>
        </p-tabpanel>
        @if (contentType) {
            <p-tabpanel [value]="1" class="content-type__relationships">
                <dot-portlet-box>
                    <dot-iframe [src]="relationshipURL" />
                </dot-portlet-box>
            </p-tabpanel>
        }
        @if (contentType && showPermissionsTab | async) {
            <p-tabpanel [value]="2" class="content-type__permissions">
                <dot-portlet-box>
                    <dot-iframe [src]="permissionURL" />
                </dot-portlet-box>
            </p-tabpanel>
        }
        @if (contentType) {
            <p-tabpanel
                [value]="contentType && (showPermissionsTab | async) ? 3 : 2"
                class="content-type__push_history">
                <dot-portlet-box>
                    <dot-iframe [src]="pushHistoryURL" />
                </dot-portlet-box>
            </p-tabpanel>
        }
    </p-tabpanels>
</p-tabs>
@if (addToMenuContentType) {
    <dot-add-to-menu (cancel)="addToMenuContentType = false" [contentType]="contentType" />
}
