<div class="dot-onboarding">
    <section class="dot-onboarding__intro">
        <h1 class="dot-onboarding__title">{{ content.title }}</h1>
        <p class="dot-onboarding__description">{{ content.description }}</p>

        <!-- <div class="dot-onboarding__prerequisites" *ngIf="content.prerequisites.length">
            <h2 class="dot-onboarding__section-title">Prerequisites</h2>

            <ul class="dot-onboarding__prerequisites-list">
                <li *ngFor="let item of content.prerequisites">
                    <i class="pi pi-check-circle"></i>
                    <span>{{ item }}</span>
                </li>
            </ul>
        </div> -->
    </section>

    <section class="dot-onboarding__progress">
        <div class="dot-onboarding__progress-header">
            <h2 class="dot-onboarding__section-title">Progress</h2>
            <button
                type="button"
                pButton
                class="dot-onboarding__reset"
                icon="pi pi-refresh"
                label="Reset Progress"
                (click)="resetProgress()"
                [disabled]="!hasProgress"></button>
        </div>

        <p-progressBar [value]="progress" [showValue]="false"></p-progressBar>

        <div class="dot-onboarding__progress-meta">
            <span class="dot-onboarding__progress-percentage">
                {{ progress | number: '1.0-0' }}%
            </span>
            <span class="dot-onboarding__progress-label">
                {{ progressLabel }}
            </span>
        </div>
    </section>

    <section class="dot-onboarding__steps">
        <p-accordion [multiple]="true">
            <p-accordionTab *ngFor="let step of content.steps" [header]="step.number + '. ' + step.title">
                <div class="dot-step">
                    <div class="dot-step__header">
                        <span
                            class="dot-step__status"
                            [class.dot-step__status--done]="isStepCompleted(step.id)">
                            {{ isStepCompleted(step.id) ? 'Completed' : 'In Progress' }}
                        </span>
                        <button
                            type="button"
                            pButton
                            class="dot-step__action"
                            [icon]="isStepCompleted(step.id) ? 'pi pi-undo' : 'pi pi-check'"
                            [label]="isStepCompleted(step.id) ? 'Mark as Incomplete' : 'Mark as Complete'"
                            (click)="toggleStepCompletion(step.id)"></button>
                    </div>

                    <div class="dot-step__body">
                        <div class="dot-step__section" *ngIf="step.description">
                            <markdown [data]="step.description"></markdown>
                        </div>

                        <div class="dot-step__section" *ngIf="step.notes?.length">
                            <h4>Notes</h4>
                            <ul>
                                <li *ngFor="let note of step.notes">
                                    <markdown [data]="note"></markdown>
                                </li>
                            </ul>
                        </div>

                        <div class="dot-step__section" *ngIf="step.commands?.length">
                            <h4>Commands</h4>
                            <div class="dot-step__command" *ngFor="let command of step.commands">
                                <p class="dot-step__command-description">{{ command.description }}</p>
                                <markdown [data]="formatCommand(command)"></markdown>
                            </div>
                        </div>

                        <div class="dot-step__section" *ngIf="step.explanation">
                            <h4>Explanation</h4>
                            <markdown [data]="step.explanation"></markdown>
                        </div>

                        <div class="dot-step__section" *ngIf="step.verification?.length">
                            <h4>Verification</h4>
                            <ul>
                                <li *ngFor="let item of step.verification">
                                    <markdown [data]="item"></markdown>
                                </li>
                            </ul>
                        </div>

                        <div class="dot-step__section" *ngIf="step.troubleshooting?.length">
                            <h4>Troubleshooting</h4>
                            <div class="dot-step__troubleshooting" *ngFor="let item of step.troubleshooting">
                                <p class="dot-step__problem">{{ item.problem }}</p>
                                <ul>
                                    <li *ngFor="let solution of item.solutions">
                                        <markdown [data]="solution"></markdown>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </p-accordionTab>
        </p-accordion>
    </section>
</div>
