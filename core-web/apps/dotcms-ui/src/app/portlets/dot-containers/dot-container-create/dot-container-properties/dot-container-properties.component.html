<ng-container *ngIf="vm$ | async as vm">
    <form [formGroup]="form">
        <div class="dot-container-properties__button-container">
            <button
                class="p-button-secondary p-button-sm"
                [label]="'Cancel' | dm"
                (click)="cancel()"
                pButton
                type="button"
            ></button>
            <button
                class="p-button-primary p-button-sm"
                [disabled]="!form.valid || form.pristine"
                [label]="'Save' | dm"
                (click)="save()"
                pButton
                type="submit"
            ></button>
        </div>
        <div class="dot-container-properties__title-container">
            <p-inplace #editText [active]="!form?.value?.identifier">
                <ng-template pTemplate="content">
                    <span class="p-input-icon-right">
                        <i class="pi pi-times" (click)="editText.deactivate()"></i>
                        <input
                            class="dot-container-properties__title-input"
                            [required]="true"
                            type="text"
                            pInputText
                            formControlName="title"
                        />
                    </span>
                </ng-template>
                <ng-template pTemplate="display">
                    <span
                        class="dot-container-properties__title-text"
                        *ngIf="!form?.value?.title"
                        >{{ 'message.containers.create.click_to_edit' | dm }}</span
                    >
                    <span class="dot-container-properties__title-text" *ngIf="form?.value?.title">{{
                        form?.value?.title
                    }}</span>
                    <i class="pi pi-pencil"></i>
                </ng-template>
            </p-inplace>
        </div>
        <div class="field">
            <label class="block p-label-input-required" for="description">{{
                'message.containers.create.description' | dm
            }}</label>
            <input
                class="dot-container-properties__description-input"
                id="description"
                [required]="true"
                type="text"
                formControlName="friendlyName"
                pInputText
            />
        </div>
        <div class="field">
            <label class="block p-label-input-required" for="max-contents">{{
                'message.containers.create.max_contents' | dm
            }}</label>
            <input
                class="dot-container-properties__max-contents-input"
                id="max-contents"
                [required]="true"
                type="text"
                formControlName="maxContentlets"
                pInputText
            />
            <button
                class="p-button-secondary dot-container-properties__button-clear"
                *ngIf="vm.isContentTypeVisible"
                [label]="'message.containers.create.clear' | dm"
                (click)="clearContent()"
                pButton
                type="button"
            ></button>
            <button
                *ngIf="!vm.isContentTypeVisible"
                [label]="'message.containers.create.content_type_code' | dm"
                [disabled]="!vm.isContentTypeButtonEnabled"
                (click)="showContentTypeAndCode()"
                pButton
                type="button"
            ></button>
        </div>

        <div class="dot-container-properties__code-container-outer">
            <div
                class="dot-container-properties__code-loop-container"
                *ngIf="vm.isContentTypeVisible"
            >
                <dot-loop-editor
                    [isEditorVisible]="vm.showPrePostLoopInput"
                    [control]="$any(form).get('preLoop')"
                    (buttonClick)="showLoopInput()"
                ></dot-loop-editor>
                <dot-content-code-editor
                    [containerStructures]="vm.contentTypes"
                    (updateContainerStructure)="updateContainerStructure($event)"
                ></dot-content-code-editor>
                <dot-loop-editor
                    [isEditorVisible]="vm.showPrePostLoopInput"
                    [control]="$any(form).get('postLoop')"
                    (buttonClick)="showLoopInput()"
                ></dot-loop-editor>
            </div>
            <div class="field" *ngIf="!vm.isContentTypeVisible">
                <label class="block p-label-input-required" for="code">Code</label>
                <dot-textarea-content
                    id="code"
                    [show]="['code']"
                    formControlName="code"
                    language="html"
                ></dot-textarea-content>
            </div>
        </div>
    </form>
</ng-container>
