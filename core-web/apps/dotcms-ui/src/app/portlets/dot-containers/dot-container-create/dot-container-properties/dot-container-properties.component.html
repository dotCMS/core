@if (vm$ | async; as vm) {
    <form class="form" [formGroup]="form">
        <div class="field w-80">
            <label for="title">
                {{ 'message.containers.create.title' | dm }}
            </label>
            <div class="flex items-center gap-2 relative">
                <input
                    class="flex-1"
                    [required]="true"
                    id="title"
                    data-testId="title"
                    dotAutofocus
                    type="text"
                    pInputText
                    formControlName="title" />
                @if (form?.value?.identifier) {
                    <div class="absolute right-0 -mr-16">
                        <dot-api-link [href]="vm.apiLink"></dot-api-link>
                    </div>
                }
            </div>
        </div>
        <div class="field w-80">
            <label for="description">
                {{ 'message.containers.create.description' | dm }}
            </label>
            <input
                id="description"
                data-testId="description"
                type="text"
                formControlName="friendlyName"
                pInputText />
        </div>
        <div class="field w-80">
            <label dotFieldRequired for="max-contents">
                {{ 'message.containers.create.max_contents' | dm }}
            </label>
            <div class="flex items-center gap-2">
                <input
                    class="flex-1"
                    [required]="true"
                    id="max-contents"
                    data-testId="max-contents"
                    type="number"
                    min="0"
                    formControlName="maxContentlets"
                    pInputText />
                @if (vm.isContentTypeVisible) {
                    <button
                        (click)="clearContentConfirmationModal()"
                        [label]="'message.containers.create.clear' | dm"
                        data-testId="clearContent"
                        pButton
                        type="button"></button>
                }
            </div>
        </div>
        @if (vm.isContentTypeVisible) {
            <div class="border border-gray-200 rounded-md" [@contentTypeAnimation]>
                <dot-loop-editor
                    (buttonClick)="showLoopInput()"
                    [isEditorVisible]="vm.showPrePostLoopInput"
                    label="pre_loop"
                    formControlName="preLoop"></dot-loop-editor>
                @if (vm.contentTypes.length > 0) {
                    <dot-container-code
                        [contentTypes]="vm.contentTypes"
                        [fg]="form"></dot-container-code>
                }
                <dot-loop-editor
                    (buttonClick)="showLoopInput()"
                    [isEditorVisible]="vm.showPrePostLoopInput"
                    formControlName="postLoop"
                    label="post_loop"></dot-loop-editor>
            </div>
        }
        @if (!vm.isContentTypeVisible) {
            <div class="field">
                <label dotFieldRequired for="code">Code</label>
                <dot-textarea-content
                    [show]="['code']"
                    id="code"
                    data-testId="code"
                    formControlName="code"
                    language="html"></dot-textarea-content>
            </div>
        }

        <div class="flex justify-end gap-2">
            <button
                (click)="cancel()"
                [label]="'Cancel' | dm"
                outlined
                pButton
                type="button"></button>
            <button
                (click)="save()"
                [disabled]="vm.invalidForm"
                [label]="'Save' | dm"
                primary
                data-testId="saveBtn"
                pButton
                type="submit"></button>
        </div>
    </form>
}
