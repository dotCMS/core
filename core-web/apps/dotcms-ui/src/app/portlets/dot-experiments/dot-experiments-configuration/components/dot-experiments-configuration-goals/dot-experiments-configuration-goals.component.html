<ng-container *ngIf="vm$ | async as vm">
    <p-card>
        <ng-template pTemplate="title">
            <div class="flex justify-content-between">
                <h2 class="flex align-items-center gap-1 uppercase">
                    <span data-testId="goals-card-name">{{
                        'experiments.configure.goals.name' | dm
                    }}</span>
                    <dot-icon
                        [ngClass]="{ isDone: vm.goals }"
                        data-testId="goal-title-step-done"
                        name="check_circle"
                        size="16"
                    ></dot-icon>
                </h2>
            </div>

            <h3 class="flex description" data-testId="goals-empty-msg">
                {{ 'experiments.configure.goals.no.seleted.goal.message' | dm }}
            </h3>
        </ng-template>

        <ng-container *ngIf="vm.goals">
            <div class="grid">
                <div class="col-12">
                    <dot-experiments-experiment-goal-configuration-detail [goal]="vm.goals.primary">
                        <button
                            class="p-button-rounded p-button-text p-button-plain"
                            *ngIf="vm.isExperimentADraft"
                            (click)="deleteGoal($event, 'primary', vm.experimentId)"
                            data-testId="goal-delete-button"
                            icon="pi pi-trash delete"
                            pButton
                            pRipple
                            type="button"
                        ></button>
                    </dot-experiments-experiment-goal-configuration-detail>
                </div>
            </div>
        </ng-container>
        <ng-template pTemplate="footer">
            <div
                [pTooltip]="'experiment.configure.edit.only.draft.status' | dm"
                [tooltipDisabled]="vm.isExperimentADraft || !!vm.goals"
                data-testId="tooltip-on-disabled"
                tooltipPosition="bottom"
            >
                <button
                    class="p-button-sm p-button-link"
                    [disabled]="!!vm.goals || !vm.isExperimentADraft"
                    (click)="openSelectGoalSidebar()"
                    data-testId="goals-add-button"
                    label="{{ 'experiments.configure.goals.add' | dm }}"
                    pButton
                    pRipple
                    type="submit"
                ></button>
            </div>
        </ng-template>
    </p-card>
</ng-container>

<ng-container dotDynamic></ng-container>
<p-confirmPopup></p-confirmPopup>
